/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { Router } from '@angular/router';
import * as utils from './ng-wizard.utils';
import { NoChildRoutes, NoWizardRoute, NoWsInterface } from './ng-wizard-error/ng-wizard.error';
import { BehaviorSubject } from 'rxjs';
import { map } from 'rxjs/operators';
var NgWizardService = /** @class */ (function () {
    function NgWizardService(router) {
        this.router = router;
        this.stepData = [];
        this.stepDataChanges = new BehaviorSubject([]);
    }
    /**
     * Initializes the wizard by parsing the wizard's child routes found in Angular's router config
     * into a list of NgWizardStepData.
     * @param wizardComponentName The name of the wizard component
     */
    /**
     * Initializes the wizard by parsing the wizard's child routes found in Angular's router config
     * into a list of NgWizardStepData.
     * @param {?} wizardComponentName The name of the wizard component
     * @return {?}
     */
    NgWizardService.prototype.loadWizardRoutes = /**
     * Initializes the wizard by parsing the wizard's child routes found in Angular's router config
     * into a list of NgWizardStepData.
     * @param {?} wizardComponentName The name of the wizard component
     * @return {?}
     */
    function (wizardComponentName) {
        this.wizardRoute = this.getWizardRoute(wizardComponentName);
        if (!this.wizardRoute) {
            throw new NoWizardRoute(wizardComponentName);
        }
        this.wizardOptions = utils.mergeWizardOptions(this.wizardRoute.data);
        this.loadChildRoutes(this.wizardRoute);
    };
    /**
     * Checks and stores the currently displayed component.
     * @param componentRef A reference to the currently displayed component
     */
    /**
     * Checks and stores the currently displayed component.
     * @param {?} componentRef A reference to the currently displayed component
     * @return {?}
     */
    NgWizardService.prototype.registerActiveComponent = /**
     * Checks and stores the currently displayed component.
     * @param {?} componentRef A reference to the currently displayed component
     * @return {?}
     */
    function (componentRef) {
        if (!utils.componentImplementsNgWizardStepInterface(componentRef)) {
            throw new NoWsInterface(componentRef.constructor.name);
        }
        // Cast to unknown before casting to NgWizardStep to let typescript know we checked and approve
        // this conversion.
        this.currentComponent = (/** @type {?} */ (((/** @type {?} */ (componentRef)))));
        this.currentStepData = utils.getStepDataForUrl(this.stepData, this.router.url);
        this.currentStepData.componentRef = componentRef;
        this.resetCurrentStep();
        this.currentStepData.isCurrent = true;
        this.onStepDataChange();
    };
    /**
     * Calls the current component's wsOnPrevious() or wsOnNext()) methods and navigates to the given
     * step if the component does not abort or its state is invalid (for next navigation).
     *
     * @param stepData The NgWizardStepData of the the step to navigate to
     */
    /**
     * Calls the current component's wsOnPrevious() or wsOnNext()) methods and navigates to the given
     * step if the component does not abort or its state is invalid (for next navigation).
     *
     * @param {?} stepData The NgWizardStepData of the the step to navigate to
     * @return {?}
     */
    NgWizardService.prototype.navigateToStep = /**
     * Calls the current component's wsOnPrevious() or wsOnNext()) methods and navigates to the given
     * step if the component does not abort or its state is invalid (for next navigation).
     *
     * @param {?} stepData The NgWizardStepData of the the step to navigate to
     * @return {?}
     */
    function (stepData) {
        /** @type {?} */
        var goAhead;
        if (this.currentStepData.order > stepData.order) {
            goAhead = this.currentComponent.wsOnPrevious();
        }
        else {
            goAhead = this.currentComponent.wsIsValid() && this.currentComponent.wsOnNext();
        }
        if (goAhead === false) {
            return;
        }
        /** @type {?} */
        var stepPath = stepData.path;
        // If the wizard is added to a specific path in the application we have to join that path and
        // the step's path as the path to navigate to.
        // The Angular Router's relativeTo option does not seem to work when using the hash location
        // strategy.
        if (this.wizardRoute.path) {
            stepPath = [this.wizardRoute.path, stepData.path].join('/');
        }
        if (stepData.options.cleanQueryParameters) {
            return this.router.navigate([stepPath], { queryParams: {} });
        }
        else {
            return this.router.navigate([stepPath], { queryParamsHandling: 'merge' });
        }
        return this.router.navigate([stepPath], { queryParamsHandling: 'merge' });
    };
    /**
     * Utility method to navigate to the next step.
     */
    /**
     * Utility method to navigate to the next step.
     * @return {?}
     */
    NgWizardService.prototype.navigateToNextStep = /**
     * Utility method to navigate to the next step.
     * @return {?}
     */
    function () {
        /** @type {?} */
        var nextStepData = utils.getStepDataForPath(this.stepData, this.currentStepData.nextStep);
        return this.navigateToStep(nextStepData);
    };
    /**
     * Utility method to navigate to the previous step.
     */
    /**
     * Utility method to navigate to the previous step.
     * @return {?}
     */
    NgWizardService.prototype.navigateToPreviousStep = /**
     * Utility method to navigate to the previous step.
     * @return {?}
     */
    function () {
        /** @type {?} */
        var previousStepData = utils.getStepDataForPath(this.stepData, this.currentStepData.previousStep);
        return this.navigateToStep(previousStepData);
    };
    /**
     * Utility method to navigate to a specific route path (external to the wizard)
     */
    /**
     * Utility method to navigate to a specific route path (external to the wizard)
     * @param {?} path
     * @return {?}
     */
    NgWizardService.prototype.navigateToPath = /**
     * Utility method to navigate to a specific route path (external to the wizard)
     * @param {?} path
     * @return {?}
     */
    function (path) {
        return this.router.navigate([path], { queryParamsHandling: 'merge' });
    };
    /**
     * Returns the step data changes as an observable.
     */
    /**
     * Returns the step data changes as an observable.
     * @return {?}
     */
    NgWizardService.prototype.getStepDataChangesAsObservable = /**
     * Returns the step data changes as an observable.
     * @return {?}
     */
    function () {
        return this.stepDataChanges.asObservable();
    };
    /**
     * Returns the current step data as an observable.
     */
    // TODO: Write a unit test for this method
    /**
     * Returns the current step data as an observable.
     * @return {?}
     */
    // TODO: Write a unit test for this method
    NgWizardService.prototype.getCurrentStepDataAsObservable = /**
     * Returns the current step data as an observable.
     * @return {?}
     */
    // TODO: Write a unit test for this method
    function () {
        return this.getStepDataChangesAsObservable().pipe(map((/**
         * @param {?} stepDatas
         * @return {?}
         */
        function (stepDatas) { return stepDatas.find((/**
         * @param {?} stepData
         * @return {?}
         */
        function (stepData) { return stepData.isCurrent; })); })));
    };
    /**
     * Returns the Angular Route for the wizard component found in Angular's router config.
     * @param wizardComponentName The name of the wizard component
     */
    /**
     * Returns the Angular Route for the wizard component found in Angular's router config.
     * @private
     * @param {?} wizardComponentName The name of the wizard component
     * @return {?}
     */
    NgWizardService.prototype.getWizardRoute = /**
     * Returns the Angular Route for the wizard component found in Angular's router config.
     * @private
     * @param {?} wizardComponentName The name of the wizard component
     * @return {?}
     */
    function (wizardComponentName) {
        return this.router.config.find((/**
         * @param {?} route
         * @return {?}
         */
        function (route) { return route.component && route.component.name === wizardComponentName; }));
    };
    /**
     * Parses the child routes of the wizard component route and stores them as a list of
     * NgWizardStepData.
     * @param wizardRoute The Angular Route for the wizard component
     */
    /**
     * Parses the child routes of the wizard component route and stores them as a list of
     * NgWizardStepData.
     * @private
     * @param {?} wizardRoute The Angular Route for the wizard component
     * @return {?}
     */
    NgWizardService.prototype.loadChildRoutes = /**
     * Parses the child routes of the wizard component route and stores them as a list of
     * NgWizardStepData.
     * @private
     * @param {?} wizardRoute The Angular Route for the wizard component
     * @return {?}
     */
    function (wizardRoute) {
        if (!wizardRoute.children) {
            throw new NoChildRoutes(wizardRoute.component.name, wizardRoute.path);
        }
        /** @type {?} */
        var childRoutes = wizardRoute.children.filter((/**
         * @param {?} route
         * @return {?}
         */
        function (route) { return route.component; }));
        this.stepData = [];
        for (var i = 0; i < childRoutes.length; i++) {
            this.registerStep(i, childRoutes[i], childRoutes[i - 1], childRoutes[i + 1]);
        }
    };
    /**
     * Stores a child route as an NgWizardStepData.
     * @param index The index in the list of child routes
     * @param stepRoute The child route
     * @param previousStep The previous child route (undefined if first child route)
     * @param nextStep The next child route (undefined if last child route)
     */
    /**
     * Stores a child route as an NgWizardStepData.
     * @private
     * @param {?} index The index in the list of child routes
     * @param {?} stepRoute The child route
     * @param {?} previousStep The previous child route (undefined if first child route)
     * @param {?} nextStep The next child route (undefined if last child route)
     * @return {?}
     */
    NgWizardService.prototype.registerStep = /**
     * Stores a child route as an NgWizardStepData.
     * @private
     * @param {?} index The index in the list of child routes
     * @param {?} stepRoute The child route
     * @param {?} previousStep The previous child route (undefined if first child route)
     * @param {?} nextStep The next child route (undefined if last child route)
     * @return {?}
     */
    function (index, stepRoute, previousStep, nextStep) {
        this.stepData.push({
            order: index + 1,
            componentName: stepRoute.component.name,
            path: stepRoute.path,
            previousStep: previousStep ? previousStep.path : undefined,
            nextStep: nextStep ? nextStep.path : undefined,
            isCurrent: false,
            options: utils.getWizardStepOptions(stepRoute),
        });
        this.onStepDataChange();
    };
    /**
     * Emits a step data change event to the subscribers when the step data changes.
     */
    /**
     * Emits a step data change event to the subscribers when the step data changes.
     * @private
     * @return {?}
     */
    NgWizardService.prototype.onStepDataChange = /**
     * Emits a step data change event to the subscribers when the step data changes.
     * @private
     * @return {?}
     */
    function () {
        this.stepDataChanges.next(this.stepData);
    };
    /**
     * Sets the isCurrent attribute of all step data to false.
     */
    /**
     * Sets the isCurrent attribute of all step data to false.
     * @private
     * @return {?}
     */
    NgWizardService.prototype.resetCurrentStep = /**
     * Sets the isCurrent attribute of all step data to false.
     * @private
     * @return {?}
     */
    function () {
        this.stepData.map((/**
         * @param {?} stepData
         * @return {?}
         */
        function (stepData) {
            stepData.isCurrent = false;
            return stepData;
        }));
    };
    NgWizardService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    NgWizardService.ctorParameters = function () { return [
        { type: Router }
    ]; };
    return NgWizardService;
}());
export { NgWizardService };
if (false) {
    /** @type {?} */
    NgWizardService.prototype.wizardOptions;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.wizardRoute;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.stepData;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.currentStepData;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.currentComponent;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.stepDataChanges;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.router;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctd2l6YXJkLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AY21kYXAvbmctd2l6YXJkLyIsInNvdXJjZXMiOlsibGliL25nLXdpemFyZC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQWdCLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN6RCxPQUFPLEVBQVMsTUFBTSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDaEQsT0FBTyxLQUFLLEtBQUssTUFBTSxtQkFBbUIsQ0FBQztBQUMzQyxPQUFPLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBRSxhQUFhLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUdoRyxPQUFPLEVBQUUsZUFBZSxFQUFjLE1BQU0sTUFBTSxDQUFDO0FBQ25ELE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUdyQztJQVdFLHlCQUFvQixNQUFjO1FBQWQsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQU4xQixhQUFRLEdBQXVCLEVBQUUsQ0FBQztRQUlsQyxvQkFBZSxHQUFHLElBQUksZUFBZSxDQUFxQixFQUFFLENBQUMsQ0FBQztJQUVqQyxDQUFDO0lBRXRDOzs7O09BSUc7Ozs7Ozs7SUFDSSwwQ0FBZ0I7Ozs7OztJQUF2QixVQUF3QixtQkFBMkI7UUFDakQsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLG1CQUFtQixDQUFDLENBQUM7UUFDNUQsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDckIsTUFBTSxJQUFJLGFBQWEsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1NBQzlDO1FBQ0QsSUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyRSxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUN6QyxDQUFDO0lB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Q0ssMENBQWdCOzs7OztJQUF4QjtRQUNFLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUMzQyxDQUFDO0lBRUQ7O09BRUc7Ozs7OztJQUNLLDBDQUFnQjs7Ozs7SUFBeEI7UUFDRSxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUc7Ozs7UUFBQyxVQUFDLFFBQVE7WUFDekIsUUFBUSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7WUFDM0IsT0FBTyxRQUFRLENBQUM7UUFDbEIsQ0FBQyxFQUFDLENBQUM7SUFDTCxDQUFDOztnQkF0TEYsVUFBVTs7OztnQkFUSyxNQUFNOztJQWdNdEIsc0JBQUM7Q0FBQSxBQXZMRCxJQXVMQztTQXRMWSxlQUFlOzs7SUFDMUIsd0NBQXNDOzs7OztJQUV0QyxzQ0FBMkI7Ozs7O0lBQzNCLG1DQUEwQzs7Ozs7SUFDMUMsMENBQTBDOzs7OztJQUMxQywyQ0FBdUM7Ozs7O0lBRXZDLDBDQUFzRTs7Ozs7SUFFMUQsaUNBQXNCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50UmVmLCBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFJvdXRlLCBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgKiBhcyB1dGlscyBmcm9tICcuL25nLXdpemFyZC51dGlscyc7XHJcbmltcG9ydCB7IE5vQ2hpbGRSb3V0ZXMsIE5vV2l6YXJkUm91dGUsIE5vV3NJbnRlcmZhY2UgfSBmcm9tICcuL25nLXdpemFyZC1lcnJvci9uZy13aXphcmQuZXJyb3InO1xyXG5pbXBvcnQgeyBOZ1dpemFyZFN0ZXBEYXRhIH0gZnJvbSAnLi9uZy13aXphcmQtc3RlcC9uZy13aXphcmQtc3RlcC1kYXRhLmludGVyZmFjZSc7XHJcbmltcG9ydCB7IE5nV2l6YXJkU3RlcCB9IGZyb20gJy4vbmctd2l6YXJkLXN0ZXAvbmctd2l6YXJkLXN0ZXAnO1xyXG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBOZ1dpemFyZE9wdGlvbnMgfSBmcm9tICcuL25nLXdpemFyZC1vcHRpb25zL25nLXdpemFyZC1vcHRpb25zLmludGVyZmFjZSc7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBOZ1dpemFyZFNlcnZpY2Uge1xyXG4gIHB1YmxpYyB3aXphcmRPcHRpb25zOiBOZ1dpemFyZE9wdGlvbnM7XHJcblxyXG4gIHByaXZhdGUgd2l6YXJkUm91dGU6IFJvdXRlO1xyXG4gIHByaXZhdGUgc3RlcERhdGE6IE5nV2l6YXJkU3RlcERhdGFbXSA9IFtdO1xyXG4gIHByaXZhdGUgY3VycmVudFN0ZXBEYXRhOiBOZ1dpemFyZFN0ZXBEYXRhO1xyXG4gIHByaXZhdGUgY3VycmVudENvbXBvbmVudDogTmdXaXphcmRTdGVwO1xyXG5cclxuICBwcml2YXRlIHN0ZXBEYXRhQ2hhbmdlcyA9IG5ldyBCZWhhdmlvclN1YmplY3Q8TmdXaXphcmRTdGVwRGF0YVtdPihbXSk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcm91dGVyOiBSb3V0ZXIpIHt9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemVzIHRoZSB3aXphcmQgYnkgcGFyc2luZyB0aGUgd2l6YXJkJ3MgY2hpbGQgcm91dGVzIGZvdW5kIGluIEFuZ3VsYXIncyByb3V0ZXIgY29uZmlnXHJcbiAgICogaW50byBhIGxpc3Qgb2YgTmdXaXphcmRTdGVwRGF0YS5cclxuICAgKiBAcGFyYW0gd2l6YXJkQ29tcG9uZW50TmFtZSBUaGUgbmFtZSBvZiB0aGUgd2l6YXJkIGNvbXBvbmVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2FkV2l6YXJkUm91dGVzKHdpemFyZENvbXBvbmVudE5hbWU6IHN0cmluZykge1xyXG4gICAgdGhpcy53aXphcmRSb3V0ZSA9IHRoaXMuZ2V0V2l6YXJkUm91dGUod2l6YXJkQ29tcG9uZW50TmFtZSk7XHJcbiAgICBpZiAoIXRoaXMud2l6YXJkUm91dGUpIHtcclxuICAgICAgdGhyb3cgbmV3IE5vV2l6YXJkUm91dGUod2l6YXJkQ29tcG9uZW50TmFtZSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLndpemFyZE9wdGlvbnMgPSB1dGlscy5tZXJnZVdpemFyZE9wdGlvbnModGhpcy53aXphcmRSb3V0ZS5kYXRhKTtcclxuICAgIHRoaXMubG9hZENoaWxkUm91dGVzKHRoaXMud2l6YXJkUm91dGUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2tzIGFuZCBzdG9yZXMgdGhlIGN1cnJlbnRseSBkaXNwbGF5ZWQgY29tcG9uZW50LlxyXG4gICAqIEBwYXJhbSBjb21wb25lbnRSZWYgQSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnRseSBkaXNwbGF5ZWQgY29tcG9uZW50XHJcbiAgICovXHJcbiAgcHVibGljIHJlZ2lzdGVyQWN0aXZlQ29tcG9uZW50KGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPGFueT4pIHtcclxuICAgIGlmICghdXRpbHMuY29tcG9uZW50SW1wbGVtZW50c05nV2l6YXJkU3RlcEludGVyZmFjZShjb21wb25lbnRSZWYpKSB7XHJcbiAgICAgIHRocm93IG5ldyBOb1dzSW50ZXJmYWNlKGNvbXBvbmVudFJlZi5jb25zdHJ1Y3Rvci5uYW1lKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYXN0IHRvIHVua25vd24gYmVmb3JlIGNhc3RpbmcgdG8gTmdXaXphcmRTdGVwIHRvIGxldCB0eXBlc2NyaXB0IGtub3cgd2UgY2hlY2tlZCBhbmQgYXBwcm92ZVxyXG4gICAgLy8gdGhpcyBjb252ZXJzaW9uLlxyXG4gICAgdGhpcy5jdXJyZW50Q29tcG9uZW50ID0gKGNvbXBvbmVudFJlZiBhcyB1bmtub3duKSBhcyBOZ1dpemFyZFN0ZXA7XHJcbiAgICB0aGlzLmN1cnJlbnRTdGVwRGF0YSA9IHV0aWxzLmdldFN0ZXBEYXRhRm9yVXJsKHRoaXMuc3RlcERhdGEsIHRoaXMucm91dGVyLnVybCk7XHJcbiAgICB0aGlzLmN1cnJlbnRTdGVwRGF0YS5jb21wb25lbnRSZWYgPSBjb21wb25lbnRSZWY7XHJcbiAgICB0aGlzLnJlc2V0Q3VycmVudFN0ZXAoKTtcclxuICAgIHRoaXMuY3VycmVudFN0ZXBEYXRhLmlzQ3VycmVudCA9IHRydWU7XHJcbiAgICB0aGlzLm9uU3RlcERhdGFDaGFuZ2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGxzIHRoZSBjdXJyZW50IGNvbXBvbmVudCdzIHdzT25QcmV2aW91cygpIG9yIHdzT25OZXh0KCkpIG1ldGhvZHMgYW5kIG5hdmlnYXRlcyB0byB0aGUgZ2l2ZW5cclxuICAgKiBzdGVwIGlmIHRoZSBjb21wb25lbnQgZG9lcyBub3QgYWJvcnQgb3IgaXRzIHN0YXRlIGlzIGludmFsaWQgKGZvciBuZXh0IG5hdmlnYXRpb24pLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHN0ZXBEYXRhIFRoZSBOZ1dpemFyZFN0ZXBEYXRhIG9mIHRoZSB0aGUgc3RlcCB0byBuYXZpZ2F0ZSB0b1xyXG4gICAqL1xyXG4gIHB1YmxpYyBuYXZpZ2F0ZVRvU3RlcChzdGVwRGF0YTogTmdXaXphcmRTdGVwRGF0YSkge1xyXG4gICAgbGV0IGdvQWhlYWQ7XHJcbiAgICBpZiAodGhpcy5jdXJyZW50U3RlcERhdGEub3JkZXIgPiBzdGVwRGF0YS5vcmRlcikge1xyXG4gICAgICBnb0FoZWFkID0gdGhpcy5jdXJyZW50Q29tcG9uZW50LndzT25QcmV2aW91cygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZ29BaGVhZCA9IHRoaXMuY3VycmVudENvbXBvbmVudC53c0lzVmFsaWQoKSAmJiB0aGlzLmN1cnJlbnRDb21wb25lbnQud3NPbk5leHQoKTtcclxuICAgIH1cclxuICAgIGlmIChnb0FoZWFkID09PSBmYWxzZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHN0ZXBQYXRoID0gc3RlcERhdGEucGF0aDtcclxuICAgIC8vIElmIHRoZSB3aXphcmQgaXMgYWRkZWQgdG8gYSBzcGVjaWZpYyBwYXRoIGluIHRoZSBhcHBsaWNhdGlvbiB3ZSBoYXZlIHRvIGpvaW4gdGhhdCBwYXRoIGFuZFxyXG4gICAgLy8gdGhlIHN0ZXAncyBwYXRoIGFzIHRoZSBwYXRoIHRvIG5hdmlnYXRlIHRvLlxyXG4gICAgLy8gVGhlIEFuZ3VsYXIgUm91dGVyJ3MgcmVsYXRpdmVUbyBvcHRpb24gZG9lcyBub3Qgc2VlbSB0byB3b3JrIHdoZW4gdXNpbmcgdGhlIGhhc2ggbG9jYXRpb25cclxuICAgIC8vIHN0cmF0ZWd5LlxyXG4gICAgaWYgKHRoaXMud2l6YXJkUm91dGUucGF0aCkge1xyXG4gICAgICBzdGVwUGF0aCA9IFt0aGlzLndpemFyZFJvdXRlLnBhdGgsIHN0ZXBEYXRhLnBhdGhdLmpvaW4oJy8nKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc3RlcERhdGEub3B0aW9ucy5jbGVhblF1ZXJ5UGFyYW1ldGVycykge1xyXG4gICAgICByZXR1cm4gdGhpcy5yb3V0ZXIubmF2aWdhdGUoW3N0ZXBQYXRoXSwgeyBxdWVyeVBhcmFtczoge30gfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gdGhpcy5yb3V0ZXIubmF2aWdhdGUoW3N0ZXBQYXRoXSwgeyBxdWVyeVBhcmFtc0hhbmRsaW5nOiAnbWVyZ2UnIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMucm91dGVyLm5hdmlnYXRlKFtzdGVwUGF0aF0sIHsgcXVlcnlQYXJhbXNIYW5kbGluZzogJ21lcmdlJyB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFV0aWxpdHkgbWV0aG9kIHRvIG5hdmlnYXRlIHRvIHRoZSBuZXh0IHN0ZXAuXHJcbiAgICovXHJcbiAgcHVibGljIG5hdmlnYXRlVG9OZXh0U3RlcCgpIHtcclxuICAgIGNvbnN0IG5leHRTdGVwRGF0YSA9IHV0aWxzLmdldFN0ZXBEYXRhRm9yUGF0aCh0aGlzLnN0ZXBEYXRhLCB0aGlzLmN1cnJlbnRTdGVwRGF0YS5uZXh0U3RlcCk7XHJcbiAgICByZXR1cm4gdGhpcy5uYXZpZ2F0ZVRvU3RlcChuZXh0U3RlcERhdGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXRpbGl0eSBtZXRob2QgdG8gbmF2aWdhdGUgdG8gdGhlIHByZXZpb3VzIHN0ZXAuXHJcbiAgICovXHJcbiAgcHVibGljIG5hdmlnYXRlVG9QcmV2aW91c1N0ZXAoKSB7XHJcbiAgICBjb25zdCBwcmV2aW91c1N0ZXBEYXRhID0gdXRpbHMuZ2V0U3RlcERhdGFGb3JQYXRoKHRoaXMuc3RlcERhdGEsIHRoaXMuY3VycmVudFN0ZXBEYXRhLnByZXZpb3VzU3RlcCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMubmF2aWdhdGVUb1N0ZXAocHJldmlvdXNTdGVwRGF0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVdGlsaXR5IG1ldGhvZCB0byBuYXZpZ2F0ZSB0byBhIHNwZWNpZmljIHJvdXRlIHBhdGggKGV4dGVybmFsIHRvIHRoZSB3aXphcmQpXHJcbiAgICovXHJcbiAgcHVibGljIG5hdmlnYXRlVG9QYXRoKHBhdGg6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIHRoaXMucm91dGVyLm5hdmlnYXRlKFtwYXRoXSwgeyBxdWVyeVBhcmFtc0hhbmRsaW5nOiAnbWVyZ2UnIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgc3RlcCBkYXRhIGNoYW5nZXMgYXMgYW4gb2JzZXJ2YWJsZS5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0U3RlcERhdGFDaGFuZ2VzQXNPYnNlcnZhYmxlKCk6IE9ic2VydmFibGU8TmdXaXphcmRTdGVwRGF0YVtdPiB7XHJcbiAgICByZXR1cm4gdGhpcy5zdGVwRGF0YUNoYW5nZXMuYXNPYnNlcnZhYmxlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHN0ZXAgZGF0YSBhcyBhbiBvYnNlcnZhYmxlLlxyXG4gICAqL1xyXG4gIC8vIFRPRE86IFdyaXRlIGEgdW5pdCB0ZXN0IGZvciB0aGlzIG1ldGhvZFxyXG4gIHB1YmxpYyBnZXRDdXJyZW50U3RlcERhdGFBc09ic2VydmFibGUoKTogT2JzZXJ2YWJsZTxOZ1dpemFyZFN0ZXBEYXRhPiB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRTdGVwRGF0YUNoYW5nZXNBc09ic2VydmFibGUoKS5waXBlKFxyXG4gICAgICBtYXAoKHN0ZXBEYXRhcykgPT4gc3RlcERhdGFzLmZpbmQoKHN0ZXBEYXRhKSA9PiBzdGVwRGF0YS5pc0N1cnJlbnQpKSxcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBBbmd1bGFyIFJvdXRlIGZvciB0aGUgd2l6YXJkIGNvbXBvbmVudCBmb3VuZCBpbiBBbmd1bGFyJ3Mgcm91dGVyIGNvbmZpZy5cclxuICAgKiBAcGFyYW0gd2l6YXJkQ29tcG9uZW50TmFtZSBUaGUgbmFtZSBvZiB0aGUgd2l6YXJkIGNvbXBvbmVudFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0V2l6YXJkUm91dGUod2l6YXJkQ29tcG9uZW50TmFtZTogc3RyaW5nKTogUm91dGUge1xyXG4gICAgcmV0dXJuIHRoaXMucm91dGVyLmNvbmZpZy5maW5kKChyb3V0ZSkgPT4gcm91dGUuY29tcG9uZW50ICYmIHJvdXRlLmNvbXBvbmVudC5uYW1lID09PSB3aXphcmRDb21wb25lbnROYW1lKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhcnNlcyB0aGUgY2hpbGQgcm91dGVzIG9mIHRoZSB3aXphcmQgY29tcG9uZW50IHJvdXRlIGFuZCBzdG9yZXMgdGhlbSBhcyBhIGxpc3Qgb2ZcclxuICAgKiBOZ1dpemFyZFN0ZXBEYXRhLlxyXG4gICAqIEBwYXJhbSB3aXphcmRSb3V0ZSBUaGUgQW5ndWxhciBSb3V0ZSBmb3IgdGhlIHdpemFyZCBjb21wb25lbnRcclxuICAgKi9cclxuICBwcml2YXRlIGxvYWRDaGlsZFJvdXRlcyh3aXphcmRSb3V0ZTogUm91dGUpIHtcclxuICAgIGlmICghd2l6YXJkUm91dGUuY2hpbGRyZW4pIHtcclxuICAgICAgdGhyb3cgbmV3IE5vQ2hpbGRSb3V0ZXMod2l6YXJkUm91dGUuY29tcG9uZW50Lm5hbWUsIHdpemFyZFJvdXRlLnBhdGgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNoaWxkUm91dGVzID0gd2l6YXJkUm91dGUuY2hpbGRyZW4uZmlsdGVyKChyb3V0ZSkgPT4gcm91dGUuY29tcG9uZW50KTtcclxuXHJcbiAgICB0aGlzLnN0ZXBEYXRhID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkUm91dGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHRoaXMucmVnaXN0ZXJTdGVwKGksIGNoaWxkUm91dGVzW2ldLCBjaGlsZFJvdXRlc1tpIC0gMV0sIGNoaWxkUm91dGVzW2kgKyAxXSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdG9yZXMgYSBjaGlsZCByb3V0ZSBhcyBhbiBOZ1dpemFyZFN0ZXBEYXRhLlxyXG4gICAqIEBwYXJhbSBpbmRleCBUaGUgaW5kZXggaW4gdGhlIGxpc3Qgb2YgY2hpbGQgcm91dGVzXHJcbiAgICogQHBhcmFtIHN0ZXBSb3V0ZSBUaGUgY2hpbGQgcm91dGVcclxuICAgKiBAcGFyYW0gcHJldmlvdXNTdGVwIFRoZSBwcmV2aW91cyBjaGlsZCByb3V0ZSAodW5kZWZpbmVkIGlmIGZpcnN0IGNoaWxkIHJvdXRlKVxyXG4gICAqIEBwYXJhbSBuZXh0U3RlcCBUaGUgbmV4dCBjaGlsZCByb3V0ZSAodW5kZWZpbmVkIGlmIGxhc3QgY2hpbGQgcm91dGUpXHJcbiAgICovXHJcbiAgcHJpdmF0ZSByZWdpc3RlclN0ZXAoaW5kZXg6IG51bWJlciwgc3RlcFJvdXRlOiBSb3V0ZSwgcHJldmlvdXNTdGVwOiBSb3V0ZSwgbmV4dFN0ZXA6IFJvdXRlKSB7XHJcbiAgICB0aGlzLnN0ZXBEYXRhLnB1c2goe1xyXG4gICAgICBvcmRlcjogaW5kZXggKyAxLFxyXG4gICAgICBjb21wb25lbnROYW1lOiBzdGVwUm91dGUuY29tcG9uZW50Lm5hbWUsXHJcbiAgICAgIHBhdGg6IHN0ZXBSb3V0ZS5wYXRoLFxyXG4gICAgICBwcmV2aW91c1N0ZXA6IHByZXZpb3VzU3RlcCA/IHByZXZpb3VzU3RlcC5wYXRoIDogdW5kZWZpbmVkLFxyXG4gICAgICBuZXh0U3RlcDogbmV4dFN0ZXAgPyBuZXh0U3RlcC5wYXRoIDogdW5kZWZpbmVkLFxyXG4gICAgICBpc0N1cnJlbnQ6IGZhbHNlLFxyXG4gICAgICBvcHRpb25zOiB1dGlscy5nZXRXaXphcmRTdGVwT3B0aW9ucyhzdGVwUm91dGUpLFxyXG4gICAgfSk7XHJcbiAgICB0aGlzLm9uU3RlcERhdGFDaGFuZ2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVtaXRzIGEgc3RlcCBkYXRhIGNoYW5nZSBldmVudCB0byB0aGUgc3Vic2NyaWJlcnMgd2hlbiB0aGUgc3RlcCBkYXRhIGNoYW5nZXMuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBvblN0ZXBEYXRhQ2hhbmdlKCkge1xyXG4gICAgdGhpcy5zdGVwRGF0YUNoYW5nZXMubmV4dCh0aGlzLnN0ZXBEYXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldHMgdGhlIGlzQ3VycmVudCBhdHRyaWJ1dGUgb2YgYWxsIHN0ZXAgZGF0YSB0byBmYWxzZS5cclxuICAgKi9cclxuICBwcml2YXRlIHJlc2V0Q3VycmVudFN0ZXAoKSB7XHJcbiAgICB0aGlzLnN0ZXBEYXRhLm1hcCgoc3RlcERhdGEpID0+IHtcclxuICAgICAgc3RlcERhdGEuaXNDdXJyZW50ID0gZmFsc2U7XHJcbiAgICAgIHJldHVybiBzdGVwRGF0YTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXX0=