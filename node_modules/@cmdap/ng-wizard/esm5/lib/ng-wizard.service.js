/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { Router } from '@angular/router';
import * as utils from './ng-wizard.utils';
import { NoChildRoutes, NoWizardRoute, NoWsInterface } from './ng-wizard-error/ng-wizard.error';
import { BehaviorSubject } from 'rxjs';
import { map } from 'rxjs/operators';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/router';
var NgWizardService = /** @class */ (function () {
    function NgWizardService(router) {
        this.router = router;
        this.stepData = [];
        this.stepDataChanges = new BehaviorSubject([]);
    }
    /**
     * Initializes the wizard by parsing the wizard's child routes found in Angular's router config
     * into a list of NgWizardStepData.
     * @param wizardComponentName The name of the wizard component
     */
    /**
     * Initializes the wizard by parsing the wizard's child routes found in Angular's router config
     * into a list of NgWizardStepData.
     * @param {?} wizardComponentName The name of the wizard component
     * @return {?}
     */
    NgWizardService.prototype.loadWizardRoutes = /**
     * Initializes the wizard by parsing the wizard's child routes found in Angular's router config
     * into a list of NgWizardStepData.
     * @param {?} wizardComponentName The name of the wizard component
     * @return {?}
     */
    function (wizardComponentName) {
        this.wizardRoute = this.getWizardRoute(wizardComponentName);
        if (!this.wizardRoute) {
            throw new NoWizardRoute(wizardComponentName);
        }
        this.wizardOptions = utils.mergeWizardOptions(this.wizardRoute.data);
        this.loadChildRoutes(this.wizardRoute);
    };
    /**
     * Checks and stores the currently displayed component.
     * @param componentRef A reference to the currently displayed component
     */
    /**
     * Checks and stores the currently displayed component.
     * @param {?} componentRef A reference to the currently displayed component
     * @return {?}
     */
    NgWizardService.prototype.registerActiveComponent = /**
     * Checks and stores the currently displayed component.
     * @param {?} componentRef A reference to the currently displayed component
     * @return {?}
     */
    function (componentRef) {
        if (!utils.componentImplementsNgWizardStepInterface(componentRef)) {
            throw new NoWsInterface(componentRef.constructor.name);
        }
        // Cast to unknown before casting to NgWizardStep to let typescript know we checked and approve
        // this conversion.
        this.currentComponent = (/** @type {?} */ (((/** @type {?} */ (componentRef)))));
        this.currentStepData = utils.getStepDataForUrl(this.stepData, this.router.url);
        this.currentStepData.componentRef = componentRef;
        this.resetCurrentStep();
        this.currentStepData.isCurrent = true;
        this.onStepDataChange();
    };
    /**
     * Calls the current component's wsOnPrevious() or wsOnNext()) methods and navigates to the given
     * step if the component does not abort or its state is invalid (for next navigation).
     *
     * @param stepData The NgWizardStepData of the the step to navigate to
     */
    /**
     * Calls the current component's wsOnPrevious() or wsOnNext()) methods and navigates to the given
     * step if the component does not abort or its state is invalid (for next navigation).
     *
     * @param {?} stepData The NgWizardStepData of the the step to navigate to
     * @return {?}
     */
    NgWizardService.prototype.navigateToStep = /**
     * Calls the current component's wsOnPrevious() or wsOnNext()) methods and navigates to the given
     * step if the component does not abort or its state is invalid (for next navigation).
     *
     * @param {?} stepData The NgWizardStepData of the the step to navigate to
     * @return {?}
     */
    function (stepData) {
        /** @type {?} */
        var goAhead;
        if (this.currentStepData.order > stepData.order) {
            goAhead = this.currentComponent.wsOnPrevious();
        }
        else {
            goAhead = this.currentComponent.wsIsValid() && this.currentComponent.wsOnNext();
        }
        if (goAhead === false) {
            return;
        }
        /** @type {?} */
        var stepPath = stepData.path;
        // If the wizard is added to a specific path in the application we have to join that path and
        // the step's path as the path to navigate to.
        // The Angular Router's relativeTo option does not seem to work when using the hash location
        // strategy.
        if (this.wizardRoute.path) {
            stepPath = [this.wizardRoute.path, stepData.path].join('/');
        }
        if (stepData.options.cleanQueryParameters) {
            return this.router.navigate([stepPath], { queryParams: {} });
        }
        else {
            return this.router.navigate([stepPath], { queryParamsHandling: 'merge' });
        }
        return this.router.navigate([stepPath], { queryParamsHandling: 'merge' });
    };
    /**
     * Utility method to navigate to the next step.
     */
    /**
     * Utility method to navigate to the next step.
     * @return {?}
     */
    NgWizardService.prototype.navigateToNextStep = /**
     * Utility method to navigate to the next step.
     * @return {?}
     */
    function () {
        /** @type {?} */
        var nextStepData = utils.getStepDataForPath(this.stepData, this.currentStepData.nextStep);
        return this.navigateToStep(nextStepData);
    };
    /**
     * Utility method to navigate to the previous step.
     */
    /**
     * Utility method to navigate to the previous step.
     * @return {?}
     */
    NgWizardService.prototype.navigateToPreviousStep = /**
     * Utility method to navigate to the previous step.
     * @return {?}
     */
    function () {
        /** @type {?} */
        var previousStepData = utils.getStepDataForPath(this.stepData, this.currentStepData.previousStep);
        return this.navigateToStep(previousStepData);
    };
    /**
     * Utility method to navigate to a specific route path (external to the wizard)
     */
    /**
     * Utility method to navigate to a specific route path (external to the wizard)
     * @param {?} path
     * @return {?}
     */
    NgWizardService.prototype.navigateToPath = /**
     * Utility method to navigate to a specific route path (external to the wizard)
     * @param {?} path
     * @return {?}
     */
    function (path) {
        return this.router.navigate([path], { queryParamsHandling: 'merge' });
    };
    /**
     * Returns the step data changes as an observable.
     */
    /**
     * Returns the step data changes as an observable.
     * @return {?}
     */
    NgWizardService.prototype.getStepDataChangesAsObservable = /**
     * Returns the step data changes as an observable.
     * @return {?}
     */
    function () {
        return this.stepDataChanges.asObservable();
    };
    /**
     * Returns the current step data as an observable.
     */
    // TODO: Write a unit test for this method
    /**
     * Returns the current step data as an observable.
     * @return {?}
     */
    // TODO: Write a unit test for this method
    NgWizardService.prototype.getCurrentStepDataAsObservable = /**
     * Returns the current step data as an observable.
     * @return {?}
     */
    // TODO: Write a unit test for this method
    function () {
        return this.getStepDataChangesAsObservable().pipe(map((/**
         * @param {?} stepDatas
         * @return {?}
         */
        function (stepDatas) { return stepDatas.find((/**
         * @param {?} stepData
         * @return {?}
         */
        function (stepData) { return stepData.isCurrent; })); })));
    };
    /**
     * Returns the Angular Route for the wizard component found in Angular's router config.
     * @param wizardComponentName The name of the wizard component
     */
    /**
     * Returns the Angular Route for the wizard component found in Angular's router config.
     * @private
     * @param {?} wizardComponentName The name of the wizard component
     * @return {?}
     */
    NgWizardService.prototype.getWizardRoute = /**
     * Returns the Angular Route for the wizard component found in Angular's router config.
     * @private
     * @param {?} wizardComponentName The name of the wizard component
     * @return {?}
     */
    function (wizardComponentName) {
        return this.router.config.find((/**
         * @param {?} route
         * @return {?}
         */
        function (route) { return route.component && route.component.name === wizardComponentName; }));
    };
    /**
     * Parses the child routes of the wizard component route and stores them as a list of
     * NgWizardStepData.
     * @param wizardRoute The Angular Route for the wizard component
     */
    /**
     * Parses the child routes of the wizard component route and stores them as a list of
     * NgWizardStepData.
     * @private
     * @param {?} wizardRoute The Angular Route for the wizard component
     * @return {?}
     */
    NgWizardService.prototype.loadChildRoutes = /**
     * Parses the child routes of the wizard component route and stores them as a list of
     * NgWizardStepData.
     * @private
     * @param {?} wizardRoute The Angular Route for the wizard component
     * @return {?}
     */
    function (wizardRoute) {
        if (!wizardRoute.children) {
            throw new NoChildRoutes(wizardRoute.component.name, wizardRoute.path);
        }
        /** @type {?} */
        var childRoutes = wizardRoute.children.filter((/**
         * @param {?} route
         * @return {?}
         */
        function (route) { return route.component; }));
        this.stepData = [];
        for (var i = 0; i < childRoutes.length; i++) {
            this.registerStep(i, childRoutes[i], childRoutes[i - 1], childRoutes[i + 1]);
        }
    };
    /**
     * Stores a child route as an NgWizardStepData.
     * @param index The index in the list of child routes
     * @param stepRoute The child route
     * @param previousStep The previous child route (undefined if first child route)
     * @param nextStep The next child route (undefined if last child route)
     */
    /**
     * Stores a child route as an NgWizardStepData.
     * @private
     * @param {?} index The index in the list of child routes
     * @param {?} stepRoute The child route
     * @param {?} previousStep The previous child route (undefined if first child route)
     * @param {?} nextStep The next child route (undefined if last child route)
     * @return {?}
     */
    NgWizardService.prototype.registerStep = /**
     * Stores a child route as an NgWizardStepData.
     * @private
     * @param {?} index The index in the list of child routes
     * @param {?} stepRoute The child route
     * @param {?} previousStep The previous child route (undefined if first child route)
     * @param {?} nextStep The next child route (undefined if last child route)
     * @return {?}
     */
    function (index, stepRoute, previousStep, nextStep) {
        this.stepData.push({
            order: index + 1,
            componentName: stepRoute.component.name,
            path: stepRoute.path,
            previousStep: previousStep ? previousStep.path : undefined,
            nextStep: nextStep ? nextStep.path : undefined,
            isCurrent: false,
            options: utils.getWizardStepOptions(stepRoute),
        });
        this.onStepDataChange();
    };
    /**
     * Emits a step data change event to the subscribers when the step data changes.
     */
    /**
     * Emits a step data change event to the subscribers when the step data changes.
     * @private
     * @return {?}
     */
    NgWizardService.prototype.onStepDataChange = /**
     * Emits a step data change event to the subscribers when the step data changes.
     * @private
     * @return {?}
     */
    function () {
        this.stepDataChanges.next(this.stepData);
    };
    /**
     * Sets the isCurrent attribute of all step data to false.
     */
    /**
     * Sets the isCurrent attribute of all step data to false.
     * @private
     * @return {?}
     */
    NgWizardService.prototype.resetCurrentStep = /**
     * Sets the isCurrent attribute of all step data to false.
     * @private
     * @return {?}
     */
    function () {
        this.stepData.map((/**
         * @param {?} stepData
         * @return {?}
         */
        function (stepData) {
            stepData.isCurrent = false;
            return stepData;
        }));
    };
    /** @nocollapse */
    NgWizardService.ctorParameters = function () { return [
        { type: Router }
    ]; };
NgWizardService.ɵfac = function NgWizardService_Factory(t) { return new (t || NgWizardService)(ɵngcc0.ɵɵinject(ɵngcc1.Router)); };
NgWizardService.ɵprov = ɵngcc0.ɵɵdefineInjectable({ token: NgWizardService, factory: function (t) { return NgWizardService.ɵfac(t); } });
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(NgWizardService, [{
        type: Injectable
    }], function () { return [{ type: ɵngcc1.Router }]; }, null); })();
    return NgWizardService;
}());
export { NgWizardService };
if (false) {
    /** @type {?} */
    NgWizardService.prototype.wizardOptions;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.wizardRoute;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.stepData;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.currentStepData;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.currentComponent;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.stepDataChanges;
    /**
     * @type {?}
     * @private
     */
    NgWizardService.prototype.router;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctd2l6YXJkLnNlcnZpY2UuanMiLCJzb3VyY2VzIjpbIm5nOi9AY21kYXAvbmctd2l6YXJkL2xpYi9uZy13aXphcmQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFnQixVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDekQsT0FBTyxFQUFTLE1BQU0sRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ2hELE9BQU8sS0FBSyxLQUFLLE1BQU0sbUJBQW1CLENBQUM7QUFDM0MsT0FBTyxFQUFFLGFBQWEsRUFBRSxhQUFhLEVBQUUsYUFBYSxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFHaEcsT0FBTyxFQUFFLGVBQWUsRUFBYyxNQUFNLE1BQU0sQ0FBQztBQUNuRCxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7OztBQUdyQztBQUVNLElBU0oseUJBQW9CLE1BQWM7QUFBSSxRQUFsQixXQUFNLEdBQU4sTUFBTSxDQUFRO0FBQUMsUUFOM0IsYUFBUSxHQUF1QixFQUFFLENBQUM7QUFDNUMsUUFHVSxvQkFBZSxHQUFHLElBQUksZUFBZSxDQUFxQixFQUFFLENBQUMsQ0FBQztBQUN4RSxJQUN1QyxDQUFDO0FBQ3hDLElBQ0U7QUFDRjtBQUNFO0FBQ0U7QUFFSixPQURLO0FBQ0w7QUFBUTtBQUMyQztBQUN6QjtBQUdoQjtBQUFtQjtBQUFRLElBTDVCLDBDQUFnQjtBQUFPO0FBRXRCO0FBQ1c7QUFFYTtBQUFtQjtBQUFRLElBTDNELFVBQXdCLG1CQUEyQjtBQUNyRCxRQUFJLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0FBQ2hFLFFBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUU7QUFDM0IsWUFBTSxNQUFNLElBQUksYUFBYSxDQUFDLG1CQUFtQixDQUFDLENBQUM7QUFDbkQsU0FBSztBQUNMLFFBQUksSUFBSSxDQUFDLGFBQWEsR0FBRyxL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QUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUdBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUtBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFFQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFFQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFFQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUVBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBRUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFHQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBSUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBRUEsQUFNQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBRUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFFQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUF0TEEsQUFBQSxBQVRBLEFBQUEsQUFnTUEsQUFBQSxBQUFBLEFBdkxBLEFBdUxBLEFBdExBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFFQSxBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50UmVmLCBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFJvdXRlLCBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgKiBhcyB1dGlscyBmcm9tICcuL25nLXdpemFyZC51dGlscyc7XHJcbmltcG9ydCB7IE5vQ2hpbGRSb3V0ZXMsIE5vV2l6YXJkUm91dGUsIE5vV3NJbnRlcmZhY2UgfSBmcm9tICcuL25nLXdpemFyZC1lcnJvci9uZy13aXphcmQuZXJyb3InO1xyXG5pbXBvcnQgeyBOZ1dpemFyZFN0ZXBEYXRhIH0gZnJvbSAnLi9uZy13aXphcmQtc3RlcC9uZy13aXphcmQtc3RlcC1kYXRhLmludGVyZmFjZSc7XHJcbmltcG9ydCB7IE5nV2l6YXJkU3RlcCB9IGZyb20gJy4vbmctd2l6YXJkLXN0ZXAvbmctd2l6YXJkLXN0ZXAnO1xyXG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5pbXBvcnQgeyBOZ1dpemFyZE9wdGlvbnMgfSBmcm9tICcuL25nLXdpemFyZC1vcHRpb25zL25nLXdpemFyZC1vcHRpb25zLmludGVyZmFjZSc7XHJcblxyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBOZ1dpemFyZFNlcnZpY2Uge1xyXG4gIHB1YmxpYyB3aXphcmRPcHRpb25zOiBOZ1dpemFyZE9wdGlvbnM7XHJcblxyXG4gIHByaXZhdGUgd2l6YXJkUm91dGU6IFJvdXRlO1xyXG4gIHByaXZhdGUgc3RlcERhdGE6IE5nV2l6YXJkU3RlcERhdGFbXSA9IFtdO1xyXG4gIHByaXZhdGUgY3VycmVudFN0ZXBEYXRhOiBOZ1dpemFyZFN0ZXBEYXRhO1xyXG4gIHByaXZhdGUgY3VycmVudENvbXBvbmVudDogTmdXaXphcmRTdGVwO1xyXG5cclxuICBwcml2YXRlIHN0ZXBEYXRhQ2hhbmdlcyA9IG5ldyBCZWhhdmlvclN1YmplY3Q8TmdXaXphcmRTdGVwRGF0YVtdPihbXSk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcm91dGVyOiBSb3V0ZXIpIHt9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemVzIHRoZSB3aXphcmQgYnkgcGFyc2luZyB0aGUgd2l6YXJkJ3MgY2hpbGQgcm91dGVzIGZvdW5kIGluIEFuZ3VsYXIncyByb3V0ZXIgY29uZmlnXHJcbiAgICogaW50byBhIGxpc3Qgb2YgTmdXaXphcmRTdGVwRGF0YS5cclxuICAgKiBAcGFyYW0gd2l6YXJkQ29tcG9uZW50TmFtZSBUaGUgbmFtZSBvZiB0aGUgd2l6YXJkIGNvbXBvbmVudFxyXG4gICAqL1xyXG4gIHB1YmxpYyBsb2FkV2l6YXJkUm91dGVzKHdpemFyZENvbXBvbmVudE5hbWU6IHN0cmluZykge1xyXG4gICAgdGhpcy53aXphcmRSb3V0ZSA9IHRoaXMuZ2V0V2l6YXJkUm91dGUod2l6YXJkQ29tcG9uZW50TmFtZSk7XHJcbiAgICBpZiAoIXRoaXMud2l6YXJkUm91dGUpIHtcclxuICAgICAgdGhyb3cgbmV3IE5vV2l6YXJkUm91dGUod2l6YXJkQ29tcG9uZW50TmFtZSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLndpemFyZE9wdGlvbnMgPSB1dGlscy5tZXJnZVdpemFyZE9wdGlvbnModGhpcy53aXphcmRSb3V0ZS5kYXRhKTtcclxuICAgIHRoaXMubG9hZENoaWxkUm91dGVzKHRoaXMud2l6YXJkUm91dGUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2tzIGFuZCBzdG9yZXMgdGhlIGN1cnJlbnRseSBkaXNwbGF5ZWQgY29tcG9uZW50LlxyXG4gICAqIEBwYXJhbSBjb21wb25lbnRSZWYgQSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnRseSBkaXNwbGF5ZWQgY29tcG9uZW50XHJcbiAgICovXHJcbiAgcHVibGljIHJlZ2lzdGVyQWN0aXZlQ29tcG9uZW50KGNvbXBvbmVudFJlZjogQ29tcG9uZW50UmVmPGFueT4pIHtcclxuICAgIGlmICghdXRpbHMuY29tcG9uZW50SW1wbGVtZW50c05nV2l6YXJkU3RlcEludGVyZmFjZShjb21wb25lbnRSZWYpKSB7XHJcbiAgICAgIHRocm93IG5ldyBOb1dzSW50ZXJmYWNlKGNvbXBvbmVudFJlZi5jb25zdHJ1Y3Rvci5uYW1lKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYXN0IHRvIHVua25vd24gYmVmb3JlIGNhc3RpbmcgdG8gTmdXaXphcmRTdGVwIHRvIGxldCB0eXBlc2NyaXB0IGtub3cgd2UgY2hlY2tlZCBhbmQgYXBwcm92ZVxyXG4gICAgLy8gdGhpcyBjb252ZXJzaW9uLlxyXG4gICAgdGhpcy5jdXJyZW50Q29tcG9uZW50ID0gKGNvbXBvbmVudFJlZiBhcyB1bmtub3duKSBhcyBOZ1dpemFyZFN0ZXA7XHJcbiAgICB0aGlzLmN1cnJlbnRTdGVwRGF0YSA9IHV0aWxzLmdldFN0ZXBEYXRhRm9yVXJsKHRoaXMuc3RlcERhdGEsIHRoaXMucm91dGVyLnVybCk7XHJcbiAgICB0aGlzLmN1cnJlbnRTdGVwRGF0YS5jb21wb25lbnRSZWYgPSBjb21wb25lbnRSZWY7XHJcbiAgICB0aGlzLnJlc2V0Q3VycmVudFN0ZXAoKTtcclxuICAgIHRoaXMuY3VycmVudFN0ZXBEYXRhLmlzQ3VycmVudCA9IHRydWU7XHJcbiAgICB0aGlzLm9uU3RlcERhdGFDaGFuZ2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENhbGxzIHRoZSBjdXJyZW50IGNvbXBvbmVudCdzIHdzT25QcmV2aW91cygpIG9yIHdzT25OZXh0KCkpIG1ldGhvZHMgYW5kIG5hdmlnYXRlcyB0byB0aGUgZ2l2ZW5cclxuICAgKiBzdGVwIGlmIHRoZSBjb21wb25lbnQgZG9lcyBub3QgYWJvcnQgb3IgaXRzIHN0YXRlIGlzIGludmFsaWQgKGZvciBuZXh0IG5hdmlnYXRpb24pLlxyXG4gICAqXHJcbiAgICogQHBhcmFtIHN0ZXBEYXRhIFRoZSBOZ1dpemFyZFN0ZXBEYXRhIG9mIHRoZSB0aGUgc3RlcCB0byBuYXZpZ2F0ZSB0b1xyXG4gICAqL1xyXG4gIHB1YmxpYyBuYXZpZ2F0ZVRvU3RlcChzdGVwRGF0YTogTmdXaXphcmRTdGVwRGF0YSkge1xyXG4gICAgbGV0IGdvQWhlYWQ7XHJcbiAgICBpZiAodGhpcy5jdXJyZW50U3RlcERhdGEub3JkZXIgPiBzdGVwRGF0YS5vcmRlcikge1xyXG4gICAgICBnb0FoZWFkID0gdGhpcy5jdXJyZW50Q29tcG9uZW50LndzT25QcmV2aW91cygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZ29BaGVhZCA9IHRoaXMuY3VycmVudENvbXBvbmVudC53c0lzVmFsaWQoKSAmJiB0aGlzLmN1cnJlbnRDb21wb25lbnQud3NPbk5leHQoKTtcclxuICAgIH1cclxuICAgIGlmIChnb0FoZWFkID09PSBmYWxzZSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHN0ZXBQYXRoID0gc3RlcERhdGEucGF0aDtcclxuICAgIC8vIElmIHRoZSB3aXphcmQgaXMgYWRkZWQgdG8gYSBzcGVjaWZpYyBwYXRoIGluIHRoZSBhcHBsaWNhdGlvbiB3ZSBoYXZlIHRvIGpvaW4gdGhhdCBwYXRoIGFuZFxyXG4gICAgLy8gdGhlIHN0ZXAncyBwYXRoIGFzIHRoZSBwYXRoIHRvIG5hdmlnYXRlIHRvLlxyXG4gICAgLy8gVGhlIEFuZ3VsYXIgUm91dGVyJ3MgcmVsYXRpdmVUbyBvcHRpb24gZG9lcyBub3Qgc2VlbSB0byB3b3JrIHdoZW4gdXNpbmcgdGhlIGhhc2ggbG9jYXRpb25cclxuICAgIC8vIHN0cmF0ZWd5LlxyXG4gICAgaWYgKHRoaXMud2l6YXJkUm91dGUucGF0aCkge1xyXG4gICAgICBzdGVwUGF0aCA9IFt0aGlzLndpemFyZFJvdXRlLnBhdGgsIHN0ZXBEYXRhLnBhdGhdLmpvaW4oJy8nKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoc3RlcERhdGEub3B0aW9ucy5jbGVhblF1ZXJ5UGFyYW1ldGVycykge1xyXG4gICAgICByZXR1cm4gdGhpcy5yb3V0ZXIubmF2aWdhdGUoW3N0ZXBQYXRoXSwgeyBxdWVyeVBhcmFtczoge30gfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gdGhpcy5yb3V0ZXIubmF2aWdhdGUoW3N0ZXBQYXRoXSwgeyBxdWVyeVBhcmFtc0hhbmRsaW5nOiAnbWVyZ2UnIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMucm91dGVyLm5hdmlnYXRlKFtzdGVwUGF0aF0sIHsgcXVlcnlQYXJhbXNIYW5kbGluZzogJ21lcmdlJyB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFV0aWxpdHkgbWV0aG9kIHRvIG5hdmlnYXRlIHRvIHRoZSBuZXh0IHN0ZXAuXHJcbiAgICovXHJcbiAgcHVibGljIG5hdmlnYXRlVG9OZXh0U3RlcCgpIHtcclxuICAgIGNvbnN0IG5leHRTdGVwRGF0YSA9IHV0aWxzLmdldFN0ZXBEYXRhRm9yUGF0aCh0aGlzLnN0ZXBEYXRhLCB0aGlzLmN1cnJlbnRTdGVwRGF0YS5uZXh0U3RlcCk7XHJcbiAgICByZXR1cm4gdGhpcy5uYXZpZ2F0ZVRvU3RlcChuZXh0U3RlcERhdGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXRpbGl0eSBtZXRob2QgdG8gbmF2aWdhdGUgdG8gdGhlIHByZXZpb3VzIHN0ZXAuXHJcbiAgICovXHJcbiAgcHVibGljIG5hdmlnYXRlVG9QcmV2aW91c1N0ZXAoKSB7XHJcbiAgICBjb25zdCBwcmV2aW91c1N0ZXBEYXRhID0gdXRpbHMuZ2V0U3RlcERhdGFGb3JQYXRoKHRoaXMuc3RlcERhdGEsIHRoaXMuY3VycmVudFN0ZXBEYXRhLnByZXZpb3VzU3RlcCk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMubmF2aWdhdGVUb1N0ZXAocHJldmlvdXNTdGVwRGF0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVdGlsaXR5IG1ldGhvZCB0byBuYXZpZ2F0ZSB0byBhIHNwZWNpZmljIHJvdXRlIHBhdGggKGV4dGVybmFsIHRvIHRoZSB3aXphcmQpXHJcbiAgICovXHJcbiAgcHVibGljIG5hdmlnYXRlVG9QYXRoKHBhdGg6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIHRoaXMucm91dGVyLm5hdmlnYXRlKFtwYXRoXSwgeyBxdWVyeVBhcmFtc0hhbmRsaW5nOiAnbWVyZ2UnIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0aGUgc3RlcCBkYXRhIGNoYW5nZXMgYXMgYW4gb2JzZXJ2YWJsZS5cclxuICAgKi9cclxuICBwdWJsaWMgZ2V0U3RlcERhdGFDaGFuZ2VzQXNPYnNlcnZhYmxlKCk6IE9ic2VydmFibGU8TmdXaXphcmRTdGVwRGF0YVtdPiB7XHJcbiAgICByZXR1cm4gdGhpcy5zdGVwRGF0YUNoYW5nZXMuYXNPYnNlcnZhYmxlKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHN0ZXAgZGF0YSBhcyBhbiBvYnNlcnZhYmxlLlxyXG4gICAqL1xyXG4gIC8vIFRPRE86IFdyaXRlIGEgdW5pdCB0ZXN0IGZvciB0aGlzIG1ldGhvZFxyXG4gIHB1YmxpYyBnZXRDdXJyZW50U3RlcERhdGFBc09ic2VydmFibGUoKTogT2JzZXJ2YWJsZTxOZ1dpemFyZFN0ZXBEYXRhPiB7XHJcbiAgICByZXR1cm4gdGhpcy5nZXRTdGVwRGF0YUNoYW5nZXNBc09ic2VydmFibGUoKS5waXBlKFxyXG4gICAgICBtYXAoKHN0ZXBEYXRhcykgPT4gc3RlcERhdGFzLmZpbmQoKHN0ZXBEYXRhKSA9PiBzdGVwRGF0YS5pc0N1cnJlbnQpKSxcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm5zIHRoZSBBbmd1bGFyIFJvdXRlIGZvciB0aGUgd2l6YXJkIGNvbXBvbmVudCBmb3VuZCBpbiBBbmd1bGFyJ3Mgcm91dGVyIGNvbmZpZy5cclxuICAgKiBAcGFyYW0gd2l6YXJkQ29tcG9uZW50TmFtZSBUaGUgbmFtZSBvZiB0aGUgd2l6YXJkIGNvbXBvbmVudFxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0V2l6YXJkUm91dGUod2l6YXJkQ29tcG9uZW50TmFtZTogc3RyaW5nKTogUm91dGUge1xyXG4gICAgcmV0dXJuIHRoaXMucm91dGVyLmNvbmZpZy5maW5kKChyb3V0ZSkgPT4gcm91dGUuY29tcG9uZW50ICYmIHJvdXRlLmNvbXBvbmVudC5uYW1lID09PSB3aXphcmRDb21wb25lbnROYW1lKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhcnNlcyB0aGUgY2hpbGQgcm91dGVzIG9mIHRoZSB3aXphcmQgY29tcG9uZW50IHJvdXRlIGFuZCBzdG9yZXMgdGhlbSBhcyBhIGxpc3Qgb2ZcclxuICAgKiBOZ1dpemFyZFN0ZXBEYXRhLlxyXG4gICAqIEBwYXJhbSB3aXphcmRSb3V0ZSBUaGUgQW5ndWxhciBSb3V0ZSBmb3IgdGhlIHdpemFyZCBjb21wb25lbnRcclxuICAgKi9cclxuICBwcml2YXRlIGxvYWRDaGlsZFJvdXRlcyh3aXphcmRSb3V0ZTogUm91dGUpIHtcclxuICAgIGlmICghd2l6YXJkUm91dGUuY2hpbGRyZW4pIHtcclxuICAgICAgdGhyb3cgbmV3IE5vQ2hpbGRSb3V0ZXMod2l6YXJkUm91dGUuY29tcG9uZW50Lm5hbWUsIHdpemFyZFJvdXRlLnBhdGgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNoaWxkUm91dGVzID0gd2l6YXJkUm91dGUuY2hpbGRyZW4uZmlsdGVyKChyb3V0ZSkgPT4gcm91dGUuY29tcG9uZW50KTtcclxuXHJcbiAgICB0aGlzLnN0ZXBEYXRhID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkUm91dGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIHRoaXMucmVnaXN0ZXJTdGVwKGksIGNoaWxkUm91dGVzW2ldLCBjaGlsZFJvdXRlc1tpIC0gMV0sIGNoaWxkUm91dGVzW2kgKyAxXSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTdG9yZXMgYSBjaGlsZCByb3V0ZSBhcyBhbiBOZ1dpemFyZFN0ZXBEYXRhLlxyXG4gICAqIEBwYXJhbSBpbmRleCBUaGUgaW5kZXggaW4gdGhlIGxpc3Qgb2YgY2hpbGQgcm91dGVzXHJcbiAgICogQHBhcmFtIHN0ZXBSb3V0ZSBUaGUgY2hpbGQgcm91dGVcclxuICAgKiBAcGFyYW0gcHJldmlvdXNTdGVwIFRoZSBwcmV2aW91cyBjaGlsZCByb3V0ZSAodW5kZWZpbmVkIGlmIGZpcnN0IGNoaWxkIHJvdXRlKVxyXG4gICAqIEBwYXJhbSBuZXh0U3RlcCBUaGUgbmV4dCBjaGlsZCByb3V0ZSAodW5kZWZpbmVkIGlmIGxhc3QgY2hpbGQgcm91dGUpXHJcbiAgICovXHJcbiAgcHJpdmF0ZSByZWdpc3RlclN0ZXAoaW5kZXg6IG51bWJlciwgc3RlcFJvdXRlOiBSb3V0ZSwgcHJldmlvdXNTdGVwOiBSb3V0ZSwgbmV4dFN0ZXA6IFJvdXRlKSB7XHJcbiAgICB0aGlzLnN0ZXBEYXRhLnB1c2goe1xyXG4gICAgICBvcmRlcjogaW5kZXggKyAxLFxyXG4gICAgICBjb21wb25lbnROYW1lOiBzdGVwUm91dGUuY29tcG9uZW50Lm5hbWUsXHJcbiAgICAgIHBhdGg6IHN0ZXBSb3V0ZS5wYXRoLFxyXG4gICAgICBwcmV2aW91c1N0ZXA6IHByZXZpb3VzU3RlcCA/IHByZXZpb3VzU3RlcC5wYXRoIDogdW5kZWZpbmVkLFxyXG4gICAgICBuZXh0U3RlcDogbmV4dFN0ZXAgPyBuZXh0U3RlcC5wYXRoIDogdW5kZWZpbmVkLFxyXG4gICAgICBpc0N1cnJlbnQ6IGZhbHNlLFxyXG4gICAgICBvcHRpb25zOiB1dGlscy5nZXRXaXphcmRTdGVwT3B0aW9ucyhzdGVwUm91dGUpLFxyXG4gICAgfSk7XHJcbiAgICB0aGlzLm9uU3RlcERhdGFDaGFuZ2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVtaXRzIGEgc3RlcCBkYXRhIGNoYW5nZSBldmVudCB0byB0aGUgc3Vic2NyaWJlcnMgd2hlbiB0aGUgc3RlcCBkYXRhIGNoYW5nZXMuXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBvblN0ZXBEYXRhQ2hhbmdlKCkge1xyXG4gICAgdGhpcy5zdGVwRGF0YUNoYW5nZXMubmV4dCh0aGlzLnN0ZXBEYXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldHMgdGhlIGlzQ3VycmVudCBhdHRyaWJ1dGUgb2YgYWxsIHN0ZXAgZGF0YSB0byBmYWxzZS5cclxuICAgKi9cclxuICBwcml2YXRlIHJlc2V0Q3VycmVudFN0ZXAoKSB7XHJcbiAgICB0aGlzLnN0ZXBEYXRhLm1hcCgoc3RlcERhdGEpID0+IHtcclxuICAgICAgc3RlcERhdGEuaXNDdXJyZW50ID0gZmFsc2U7XHJcbiAgICAgIHJldHVybiBzdGVwRGF0YTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXX0=