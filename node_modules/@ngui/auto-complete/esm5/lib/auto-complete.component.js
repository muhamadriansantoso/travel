import { __decorate } from "tslib";
import { Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild, ViewEncapsulation } from '@angular/core';
import { NguiAutoComplete } from './auto-complete.service';
var NguiAutoCompleteComponent = /** @class */ (function () {
    /**
     * constructor
     */
    function NguiAutoCompleteComponent(elementRef, autoComplete) {
        var _this = this;
        this.autoComplete = autoComplete;
        /**
         * public input properties
         */
        this.autocomplete = false;
        this.minChars = 0;
        this.acceptUserInput = true;
        this.loadingText = 'Loading';
        this.loadingTemplate = null;
        this.showInputTag = true;
        this.showDropdownOnInit = false;
        this.tabToSelect = true;
        this.matchFormatted = false;
        this.autoSelectFirstItem = false;
        this.selectOnBlur = false;
        this.reFocusAfterSelect = true;
        this.headerItemTemplate = null;
        this.ignoreAccents = true;
        this.valueSelected = new EventEmitter();
        this.customSelected = new EventEmitter();
        this.textEntered = new EventEmitter();
        this.dropdownVisible = false;
        this.isLoading = false;
        this.filteredList = [];
        this.minCharsEntered = false;
        this.itemIndex = null;
        this.timer = 0;
        this.delay = (function () {
            var timer = null;
            return function (callback, ms) {
                clearTimeout(timer);
                timer = setTimeout(callback, ms);
            };
        })();
        this.selectOnEnter = false;
        this.reloadListInDelay = function (evt) {
            var delayMs = _this.isSrcArr() ? 10 : 500;
            var keyword = evt.target.value;
            // executing after user stopped typing
            _this.delay(function () { return _this.reloadList(keyword); }, delayMs);
        };
        this.inputElKeyHandler = function (evt) {
            var totalNumItem = _this.filteredList.length;
            if (!_this.selectOnEnter && _this.autoSelectFirstItem && (0 !== totalNumItem)) {
                _this.selectOnEnter = true;
            }
            switch (evt.keyCode) {
                case 27: // ESC, hide auto complete
                    _this.selectOnEnter = false;
                    _this.selectOne(undefined);
                    break;
                case 38: // UP, select the previous li el
                    if (0 === totalNumItem) {
                        return;
                    }
                    _this.selectOnEnter = true;
                    _this.itemIndex = (totalNumItem + _this.itemIndex - 1) % totalNumItem;
                    _this.scrollToView(_this.itemIndex);
                    break;
                case 40: // DOWN, select the next li el or the first one
                    if (0 === totalNumItem) {
                        return;
                    }
                    _this.selectOnEnter = true;
                    _this.dropdownVisible = true;
                    var sum = _this.itemIndex;
                    sum = (_this.itemIndex === null) ? 0 : sum + 1;
                    _this.itemIndex = (totalNumItem + sum) % totalNumItem;
                    _this.scrollToView(_this.itemIndex);
                    break;
                case 13: // ENTER, choose it!!
                    if (_this.selectOnEnter) {
                        _this.selectOne(_this.filteredList[_this.itemIndex]);
                    }
                    evt.preventDefault();
                    break;
                case 9: // TAB, choose if tab-to-select is enabled
                    if (_this.tabToSelect) {
                        _this.selectOne(_this.filteredList[_this.itemIndex]);
                    }
                    break;
            }
        };
        this.el = elementRef.nativeElement;
    }
    /**
     * user enters into input el, shows list to select, then select one
     */
    NguiAutoCompleteComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.autoComplete.source = this.source;
        this.autoComplete.pathToData = this.pathToData;
        this.autoComplete.listFormatter = this.listFormatter;
        if (this.autoSelectFirstItem) {
            this.itemIndex = 0;
        }
        setTimeout(function () {
            if (_this.autoCompleteInput && _this.reFocusAfterSelect) {
                _this.autoCompleteInput.nativeElement.focus();
            }
            if (_this.showDropdownOnInit) {
                _this.showDropdownList({ target: { value: '' } });
            }
        });
    };
    NguiAutoCompleteComponent.prototype.isSrcArr = function () {
        return Array.isArray(this.source);
    };
    NguiAutoCompleteComponent.prototype.showDropdownList = function (event) {
        this.dropdownVisible = true;
        this.reloadList(event.target.value);
    };
    NguiAutoCompleteComponent.prototype.hideDropdownList = function () {
        this.selectOnEnter = false;
        this.dropdownVisible = false;
    };
    NguiAutoCompleteComponent.prototype.findItemFromSelectValue = function (selectText) {
        var matchingItems = this.filteredList.filter(function (item) { return ('' + item) === selectText; });
        return matchingItems.length ? matchingItems[0] : null;
    };
    NguiAutoCompleteComponent.prototype.reloadList = function (keyword) {
        var _this = this;
        this.filteredList = [];
        if (keyword.length < (this.minChars || 0)) {
            this.minCharsEntered = false;
            return;
        }
        else {
            this.minCharsEntered = true;
        }
        if (this.isSrcArr()) { // local source
            this.isLoading = false;
            this.filteredList = this.autoComplete.filter(this.source, keyword, this.matchFormatted, this.ignoreAccents);
            if (this.maxNumList) {
                this.filteredList = this.filteredList.slice(0, this.maxNumList);
            }
        }
        else { // remote source
            this.isLoading = true;
            if (typeof this.source === 'function') {
                // custom function that returns observable
                this.source(keyword).subscribe(function (resp) {
                    if (_this.pathToData) {
                        var paths = _this.pathToData.split('.');
                        paths.forEach(function (prop) { return resp = resp[prop]; });
                    }
                    _this.filteredList = resp;
                    if (_this.maxNumList) {
                        _this.filteredList = _this.filteredList.slice(0, _this.maxNumList);
                    }
                }, function (error) { return null; }, function () { return _this.isLoading = false; } // complete
                );
            }
            else {
                // remote source
                this.autoComplete.getRemoteData(keyword).subscribe(function (resp) {
                    _this.filteredList = resp ? resp : [];
                    if (_this.maxNumList) {
                        _this.filteredList = _this.filteredList.slice(0, _this.maxNumList);
                    }
                }, function (error) { return null; }, function () { return _this.isLoading = false; } // complete
                );
            }
        }
    };
    NguiAutoCompleteComponent.prototype.selectOne = function (data) {
        if (!!data || data === '') {
            this.valueSelected.emit(data);
        }
        else {
            this.customSelected.emit(this.keyword);
        }
    };
    NguiAutoCompleteComponent.prototype.enterText = function (data) {
        this.textEntered.emit(data);
    };
    NguiAutoCompleteComponent.prototype.blurHandler = function (evt) {
        if (this.selectOnBlur) {
            this.selectOne(this.filteredList[this.itemIndex]);
        }
        this.hideDropdownList();
    };
    NguiAutoCompleteComponent.prototype.scrollToView = function (index) {
        var container = this.autoCompleteContainer.nativeElement;
        var ul = container.querySelector('ul');
        var li = ul.querySelector('li'); // just sample the first li to get height
        var liHeight = li.offsetHeight;
        var scrollTop = ul.scrollTop;
        var viewport = scrollTop + ul.offsetHeight;
        var scrollOffset = liHeight * index;
        if (scrollOffset < scrollTop || (scrollOffset + liHeight) > viewport) {
            ul.scrollTop = scrollOffset;
        }
    };
    NguiAutoCompleteComponent.prototype.trackByIndex = function (index, item) {
        return index;
    };
    Object.defineProperty(NguiAutoCompleteComponent.prototype, "emptyList", {
        get: function () {
            return !(this.isLoading ||
                (this.minCharsEntered && !this.isLoading && !this.filteredList.length) ||
                (this.filteredList.length));
        },
        enumerable: true,
        configurable: true
    });
    NguiAutoCompleteComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: NguiAutoComplete }
    ]; };
    __decorate([
        Input('autocomplete')
    ], NguiAutoCompleteComponent.prototype, "autocomplete", void 0);
    __decorate([
        Input('list-formatter')
    ], NguiAutoCompleteComponent.prototype, "listFormatter", void 0);
    __decorate([
        Input('source')
    ], NguiAutoCompleteComponent.prototype, "source", void 0);
    __decorate([
        Input('path-to-data')
    ], NguiAutoCompleteComponent.prototype, "pathToData", void 0);
    __decorate([
        Input('min-chars')
    ], NguiAutoCompleteComponent.prototype, "minChars", void 0);
    __decorate([
        Input('placeholder')
    ], NguiAutoCompleteComponent.prototype, "placeholder", void 0);
    __decorate([
        Input('blank-option-text')
    ], NguiAutoCompleteComponent.prototype, "blankOptionText", void 0);
    __decorate([
        Input('no-match-found-text')
    ], NguiAutoCompleteComponent.prototype, "noMatchFoundText", void 0);
    __decorate([
        Input('accept-user-input')
    ], NguiAutoCompleteComponent.prototype, "acceptUserInput", void 0);
    __decorate([
        Input('loading-text')
    ], NguiAutoCompleteComponent.prototype, "loadingText", void 0);
    __decorate([
        Input('loading-template')
    ], NguiAutoCompleteComponent.prototype, "loadingTemplate", void 0);
    __decorate([
        Input('max-num-list')
    ], NguiAutoCompleteComponent.prototype, "maxNumList", void 0);
    __decorate([
        Input('show-input-tag')
    ], NguiAutoCompleteComponent.prototype, "showInputTag", void 0);
    __decorate([
        Input('show-dropdown-on-init')
    ], NguiAutoCompleteComponent.prototype, "showDropdownOnInit", void 0);
    __decorate([
        Input('tab-to-select')
    ], NguiAutoCompleteComponent.prototype, "tabToSelect", void 0);
    __decorate([
        Input('match-formatted')
    ], NguiAutoCompleteComponent.prototype, "matchFormatted", void 0);
    __decorate([
        Input('auto-select-first-item')
    ], NguiAutoCompleteComponent.prototype, "autoSelectFirstItem", void 0);
    __decorate([
        Input('select-on-blur')
    ], NguiAutoCompleteComponent.prototype, "selectOnBlur", void 0);
    __decorate([
        Input('re-focus-after-select')
    ], NguiAutoCompleteComponent.prototype, "reFocusAfterSelect", void 0);
    __decorate([
        Input('header-item-template')
    ], NguiAutoCompleteComponent.prototype, "headerItemTemplate", void 0);
    __decorate([
        Input('ignore-accents')
    ], NguiAutoCompleteComponent.prototype, "ignoreAccents", void 0);
    __decorate([
        Output()
    ], NguiAutoCompleteComponent.prototype, "valueSelected", void 0);
    __decorate([
        Output()
    ], NguiAutoCompleteComponent.prototype, "customSelected", void 0);
    __decorate([
        Output()
    ], NguiAutoCompleteComponent.prototype, "textEntered", void 0);
    __decorate([
        ViewChild('autoCompleteInput')
    ], NguiAutoCompleteComponent.prototype, "autoCompleteInput", void 0);
    __decorate([
        ViewChild('autoCompleteContainer')
    ], NguiAutoCompleteComponent.prototype, "autoCompleteContainer", void 0);
    NguiAutoCompleteComponent = __decorate([
        Component({
            selector: 'ngui-auto-complete',
            template: "\n<div #autoCompleteContainer class=\"ngui-auto-complete\">\n" +
            "                        <!-- keyword input -->\n" +
            "                        <input *ngIf=\"showInputTag\"\n" +
            "                               #autoCompleteInput class=\"keyword\"\n" +
            "                               [attr.autocomplete]=\"autocomplete ? 'null' : 'off'\"\n" +
            "                               placeholder=\"{{placeholder}}\"\n" +
            "                               (focus)=\"showDropdownList($event)\"\n" +
            "                               (blur)=\"blurHandler($event)\"\n" +
            "                               (keydown)=\"inputElKeyHandler($event)\"\n" +
            "                               (input)=\"reloadListInDelay($event)\"\n" +
            "                               [(ngModel)]=\"keyword\"/>\n" +
            "\n" +
            "                        <!-- dropdown that user can select -->\n" +
            "                        <div class=\"resultWrapper\">\n" +
            "                          <div class=\"autoCompleteSubTitle\">Airport List</div>\n" +
            "                          <div *ngIf=\"dropdownVisible\" [class.empty]=\"emptyList\">\n" +
            "                            <div *ngIf=\"isLoading && loadingTemplate\" class=\"loading\"\n" +
            "                                [innerHTML]=\"loadingTemplate\">\n" +
            "                            </div>\n" +
            "                            <div *ngIf=\"isLoading && !loadingTemplate\" class=\"loading\">{{loadingText}}</div>\n" +
            "                            <div *ngIf=\"minCharsEntered && !isLoading && !filteredList.length\"\n" +
            "                                (mousedown)=\"selectOne('')\"\n" +
            "                                class=\"no-match-found\">{{noMatchFoundText || 'No Result Found'}}\n" +
            "                            </div>\n" +
            "                            <div *ngIf=\"headerItemTemplate && filteredList.length\" class=\"header-item\"\n" +
            "                                [innerHTML]=\"headerItemTemplate\">\n" +
            "                            </div>\n" +
            "                            <div *ngIf=\"blankOptionText && filteredList.length\"\n" +
            "                                (mousedown)=\"selectOne('')\"\n" +
            "                                class=\"blank-item\">{{blankOptionText}}\n" +
            "                            </div>\n" +
            "                            <div class=\"autoCompleteWrapper\"\n" +
            "                                *ngFor=\"let item of filteredList; let i=index; trackBy: trackByIndex\"\n" +
            "                                (mousedown)=\"selectOne(item)\"\n" +
            "                                [ngClass]=\"{selected: i === itemIndex}\"\n" +
            "                                [innerHtml]=\"autoComplete.getFormattedListItem(item)\">\n" +
            "                            </div>\n" +
            "                          </div>\n" +
            "                        </div>\n" +
            "                      </div>",
            encapsulation: ViewEncapsulation.None,
            styles: ["\n    @keyframes slideDown {\n      0% {\n        transform: translateY(-10px);\n      }\n      100% {\n        transform: translateY(0px);\n      }\n    }\n\n    .ngui-auto-complete {\n      background-color: transparent;\n    }\n\n    .ngui-auto-complete > input {\n      outline: none;\n      border: 0;\n      padding: 2px;\n      box-sizing: border-box;\n      background-clip: content-box;\n    }\n\n    .ngui-auto-complete > ul {\n      background-color: #fff;\n      margin: 0;\n      width: 100%;\n      overflow-y: auto;\n      list-style-type: none;\n      padding: 0;\n      border: 1px solid #ccc;\n      box-sizing: border-box;\n      animation: slideDown 0.1s;\n    }\n\n    .ngui-auto-complete > ul.empty {\n      display: none;\n    }\n\n    .ngui-auto-complete > ul li {\n      padding: 2px 5px;\n      border-bottom: 1px solid #eee;\n    }\n\n    .ngui-auto-complete > ul li.selected {\n      background-color: #ccc;\n    }\n\n    .ngui-auto-complete > ul li:last-child {\n      border-bottom: none;\n    }\n\n    .ngui-auto-complete > ul li:not(.header-item):hover {\n      background-color: #ccc;\n    }"]
        })
    ], NguiAutoCompleteComponent);
    return NguiAutoCompleteComponent;
}());
export { NguiAutoCompleteComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0by1jb21wbGV0ZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Abmd1aS9hdXRvLWNvbXBsZXRlLyIsInNvdXJjZXMiOlsibGliL2F1dG8tY29tcGxldGUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pILE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBbUczRDtJQXNERTs7T0FFRztJQUNILG1DQUFZLFVBQXNCLEVBQVMsWUFBOEI7UUFBekUsaUJBRUM7UUFGMEMsaUJBQVksR0FBWixZQUFZLENBQWtCO1FBdkR6RTs7V0FFRztRQUMyQixpQkFBWSxHQUFHLEtBQUssQ0FBQztRQUl4QixhQUFRLEdBQUcsQ0FBQyxDQUFDO1FBSUwsb0JBQWUsR0FBRyxJQUFJLENBQUM7UUFDNUIsZ0JBQVcsR0FBRyxTQUFTLENBQUM7UUFDcEIsb0JBQWUsR0FBRyxJQUFJLENBQUM7UUFFekIsaUJBQVksR0FBRyxJQUFJLENBQUM7UUFDYix1QkFBa0IsR0FBRyxLQUFLLENBQUM7UUFDbkMsZ0JBQVcsR0FBRyxJQUFJLENBQUM7UUFDakIsbUJBQWMsR0FBRyxLQUFLLENBQUM7UUFDaEIsd0JBQW1CLEdBQUcsS0FBSyxDQUFDO1FBQ3BDLGlCQUFZLEdBQUcsS0FBSyxDQUFDO1FBQ2QsdUJBQWtCLEdBQUcsSUFBSSxDQUFDO1FBQzNCLHVCQUFrQixHQUFHLElBQUksQ0FBQztRQUNoQyxrQkFBYSxHQUFHLElBQUksQ0FBQztRQUVwQyxrQkFBYSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDbkMsbUJBQWMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ3BDLGdCQUFXLEdBQUcsSUFBSSxZQUFZLEVBQUUs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QztRQUFULE1BQU0sRUFBRTtxRUFBNEM7SUFDM0M7UUFBVCxNQUFNLEVBQUU7a0VBQXlDO0lBRWxCO1FBQS9CLFNBQVMsQ0FBQyxtQkFBbUIsQ0FBQzt3RUFBc0M7SUFDakM7UUFBbkMsU0FBUyxDQUFDLHVCQUF1QixDQUFDOzRFQUEwQztJQWhDbEUseUJBQXlCO1FBakdyQyxTQUFTLENBQUM7WUFDVCxRQUFRLEVBQUUsb0JBQW9CO1lBQzlCLFFBQVEsRUFBRSw2ckRBcUNUO1lBd0RELGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJO3FCQXZENUIsc21DQXFETDtTQUdMLENBQUM7T0FDVyx5QkFBeUIsQ0FnUXJDO0lBQUQsZ0NBQUM7Q0FBQSxBQWhRRCxJQWdRQztTQWhRWSx5QkFBeUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0LCBWaWV3Q2hpbGQsIFZpZXdFbmNhcHN1bGF0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IE5ndWlBdXRvQ29tcGxldGUgfSBmcm9tICcuL2F1dG8tY29tcGxldGUuc2VydmljZSc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ25ndWktYXV0by1jb21wbGV0ZScsXHJcbiAgdGVtcGxhdGU6IGBcclxuICAgIDxkaXYgI2F1dG9Db21wbGV0ZUNvbnRhaW5lciBjbGFzcz1cIm5ndWktYXV0by1jb21wbGV0ZVwiPlxyXG4gICAgICA8IS0tIGtleXdvcmQgaW5wdXQgLS0+XHJcbiAgICAgIDxpbnB1dCAqbmdJZj1cInNob3dJbnB1dFRhZ1wiXHJcbiAgICAgICAgICAgICAjYXV0b0NvbXBsZXRlSW5wdXQgY2xhc3M9XCJrZXl3b3JkXCJcclxuICAgICAgICAgICAgIFthdHRyLmF1dG9jb21wbGV0ZV09XCJhdXRvY29tcGxldGUgPyAnbnVsbCcgOiAnb2ZmJ1wiXHJcbiAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cInt7cGxhY2Vob2xkZXJ9fVwiXHJcbiAgICAgICAgICAgICAoZm9jdXMpPVwic2hvd0Ryb3Bkb3duTGlzdCgkZXZlbnQpXCJcclxuICAgICAgICAgICAgIChibHVyKT1cImJsdXJIYW5kbGVyKCRldmVudClcIlxyXG4gICAgICAgICAgICAgKGtleWRvd24pPVwiaW5wdXRFbEtleUhhbmRsZXIoJGV2ZW50KVwiXHJcbiAgICAgICAgICAgICAoaW5wdXQpPVwicmVsb2FkTGlzdEluRGVsYXkoJGV2ZW50KVwiXHJcbiAgICAgICAgICAgICBbKG5nTW9kZWwpXT1cImtleXdvcmRcIi8+XHJcblxyXG4gICAgICA8IS0tIGRyb3Bkb3duIHRoYXQgdXNlciBjYW4gc2VsZWN0IC0tPlxyXG4gICAgICA8dWwgKm5nSWY9XCJkcm9wZG93blZpc2libGVcIiBbY2xhc3MuZW1wdHldPVwiZW1wdHlMaXN0XCI+XHJcbiAgICAgICAgPGxpICpuZ0lmPVwiaXNMb2FkaW5nICYmIGxvYWRpbmdUZW1wbGF0ZVwiIGNsYXNzPVwibG9hZGluZ1wiXHJcbiAgICAgICAgICAgIFtpbm5lckhUTUxdPVwibG9hZGluZ1RlbXBsYXRlXCI+PC9saT5cclxuICAgICAgICA8bGkgKm5nSWY9XCJpc0xvYWRpbmcgJiYgIWxvYWRpbmdUZW1wbGF0ZVwiIGNsYXNzPVwibG9hZGluZ1wiPnt7bG9hZGluZ1RleHR9fTwvbGk+XHJcbiAgICAgICAgPGxpICpuZ0lmPVwibWluQ2hhcnNFbnRlcmVkICYmICFpc0xvYWRpbmcgJiYgIWZpbHRlcmVkTGlzdC5sZW5ndGhcIlxyXG4gICAgICAgICAgICAobW91c2Vkb3duKT1cInNlbGVjdE9uZSgnJylcIlxyXG4gICAgICAgICAgICBjbGFzcz1cIm5vLW1hdGNoLWZvdW5kXCI+e3tub01hdGNoRm91bmRUZXh0IHx8ICdObyBSZXN1bHQgRm91bmQnfX1cclxuICAgICAgICA8L2xpPlxyXG4gICAgICAgIDxsaSAqbmdJZj1cImhlYWRlckl0ZW1UZW1wbGF0ZSAmJiBmaWx0ZXJlZExpc3QubGVuZ3RoXCIgY2xhc3M9XCJoZWFkZXItaXRlbVwiXHJcbiAgICAgICAgICAgIFtpbm5lckhUTUxdPVwiaGVhZGVySXRlbVRlbXBsYXRlXCI+PC9saT5cclxuICAgICAgICA8bGkgKm5nSWY9XCJibGFua09wdGlvblRleHQgJiYgZmlsdGVyZWRMaXN0Lmxlbmd0aFwiXHJcbiAgICAgICAgICAgIChtb3VzZWRvd24pPVwic2VsZWN0T25lKCcnKVwiXHJcbiAgICAgICAgICAgIGNsYXNzPVwiYmxhbmstaXRlbVwiPnt7YmxhbmtPcHRpb25UZXh0fX1cclxuICAgICAgICA8L2xpPlxyXG4gICAgICAgIDxsaSBjbGFzcz1cIml0ZW1cIlxyXG4gICAgICAgICAgICAqbmdGb3I9XCJsZXQgaXRlbSBvZiBmaWx0ZXJlZExpc3Q7IGxldCBpPWluZGV4OyB0cmFja0J5OiB0cmFja0J5SW5kZXhcIlxyXG4gICAgICAgICAgICAobW91c2Vkb3duKT1cInNlbGVjdE9uZShpdGVtKVwiXHJcbiAgICAgICAgICAgIFtuZ0NsYXNzXT1cIntzZWxlY3RlZDogaSA9PT0gaXRlbUluZGV4fVwiXHJcbiAgICAgICAgICAgIFtpbm5lckh0bWxdPVwiYXV0b0NvbXBsZXRlLmdldEZvcm1hdHRlZExpc3RJdGVtKGl0ZW0pXCI+XHJcbiAgICAgICAgPC9saT5cclxuICAgICAgPC91bD5cclxuXHJcbiAgICA8L2Rpdj5cclxuICBgLFxyXG4gIHN0eWxlczogW2BcclxuICAgIEBrZXlmcmFtZXMgc2xpZGVEb3duIHtcclxuICAgICAgMCUge1xyXG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtMTBweCk7XHJcbiAgICAgIH1cclxuICAgICAgMTAwJSB7XHJcbiAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDBweCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAubmd1aS1hdXRvLWNvbXBsZXRlIHtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgLm5ndWktYXV0by1jb21wbGV0ZSA+IGlucHV0IHtcclxuICAgICAgb3V0bGluZTogbm9uZTtcclxuICAgICAgYm9yZGVyOiAwO1xyXG4gICAgICBwYWRkaW5nOiAycHg7XHJcbiAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XHJcbiAgICAgIGJhY2tncm91bmQtY2xpcDogY29udGVudC1ib3g7XHJcbiAgICB9XHJcblxyXG4gICAgLm5ndWktYXV0by1jb21wbGV0ZSA+IHVsIHtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcclxuICAgICAgbWFyZ2luOiAwO1xyXG4gICAgICB3aWR0aDogMTAwJTtcclxuICAgICAgb3ZlcmZsb3cteTogYXV0bztcclxuICAgICAgbGlzdC1zdHlsZS10eXBlOiBub25lO1xyXG4gICAgICBwYWRkaW5nOiAwO1xyXG4gICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xyXG4gICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xyXG4gICAgICBhbmltYXRpb246IHNsaWRlRG93biAwLjFzO1xyXG4gICAgfVxyXG5cclxuICAgIC5uZ3VpLWF1dG8tY29tcGxldGUgPiB1bC5lbXB0eSB7XHJcbiAgICAgIGRpc3BsYXk6IG5vbmU7XHJcbiAgICB9XHJcblxyXG4gICAgLm5ndWktYXV0by1jb21wbGV0ZSA+IHVsIGxpIHtcclxuICAgICAgcGFkZGluZzogMnB4IDVweDtcclxuICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlZWU7XHJcbiAgICB9XHJcblxyXG4gICAgLm5ndWktYXV0by1jb21wbGV0ZSA+IHVsIGxpLnNlbGVjdGVkIHtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2NjYztcclxuICAgIH1cclxuXHJcbiAgICAubmd1aS1hdXRvLWNvbXBsZXRlID4gdWwgbGk6bGFzdC1jaGlsZCB7XHJcbiAgICAgIGJvcmRlci1ib3R0b206IG5vbmU7XHJcbiAgICB9XHJcblxyXG4gICAgLm5ndWktYXV0by1jb21wbGV0ZSA+IHVsIGxpOm5vdCguaGVhZGVyLWl0ZW0pOmhvdmVyIHtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2NjYztcclxuICAgIH1gXHJcbiAgXSxcclxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBOZ3VpQXV0b0NvbXBsZXRlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgLyoqXHJcbiAgICogcHVibGljIGlucHV0IHByb3BlcnRpZXNcclxuICAgKi9cclxuICBASW5wdXQoJ2F1dG9jb21wbGV0ZScpIHB1YmxpYyBhdXRvY29tcGxldGUgPSBmYWxzZTtcclxuICBASW5wdXQoJ2xpc3QtZm9ybWF0dGVyJykgcHVibGljIGxpc3RGb3JtYXR0ZXI6IChhcmc6IGFueSkgPT4gc3RyaW5nO1xyXG4gIEBJbnB1dCgnc291cmNlJykgcHVibGljIHNvdXJjZTogYW55O1xyXG4gIEBJbnB1dCgncGF0aC10by1kYXRhJykgcHVibGljIHBhdGhUb0RhdGE6IHN0cmluZztcclxuICBASW5wdXQoJ21pbi1jaGFycycpIHB1YmxpYyBtaW5DaGFycyA9IDA7XHJcbiAgQElucHV0KCdwbGFjZWhvbGRlcicpIHB1YmxpYyBwbGFjZWhvbGRlcjogc3RyaW5nO1xyXG4gIEBJbnB1dCgnYmxhbmstb3B0aW9uLXRleHQnKSBwdWJsaWMgYmxhbmtPcHRpb25UZXh0OiBzdHJpbmc7XHJcbiAgQElucHV0KCduby1tYXRjaC1mb3VuZC10ZXh0JykgcHVibGljIG5vTWF0Y2hGb3VuZFRleHQ6IHN0cmluZztcclxuICBASW5wdXQoJ2FjY2VwdC11c2VyLWlucHV0JykgcHVibGljIGFjY2VwdFVzZXJJbnB1dCA9IHRydWU7XHJcbiAgQElucHV0KCdsb2FkaW5nLXRleHQnKSBwdWJsaWMgbG9hZGluZ1RleHQgPSAnTG9hZGluZyc7XHJcbiAgQElucHV0KCdsb2FkaW5nLXRlbXBsYXRlJykgcHVibGljIGxvYWRpbmdUZW1wbGF0ZSA9IG51bGw7XHJcbiAgQElucHV0KCdtYXgtbnVtLWxpc3QnKSBwdWJsaWMgbWF4TnVtTGlzdDogbnVtYmVyO1xyXG4gIEBJbnB1dCgnc2hvdy1pbnB1dC10YWcnKSBwdWJsaWMgc2hvd0lucHV0VGFnID0gdHJ1ZTtcclxuICBASW5wdXQoJ3Nob3ctZHJvcGRvd24tb24taW5pdCcpIHB1YmxpYyBzaG93RHJvcGRvd25PbkluaXQgPSBmYWxzZTtcclxuICBASW5wdXQoJ3RhYi10by1zZWxlY3QnKSBwdWJsaWMgdGFiVG9TZWxlY3QgPSB0cnVlO1xyXG4gIEBJbnB1dCgnbWF0Y2gtZm9ybWF0dGVkJykgcHVibGljIG1hdGNoRm9ybWF0dGVkID0gZmFsc2U7XHJcbiAgQElucHV0KCdhdXRvLXNlbGVjdC1maXJzdC1pdGVtJykgcHVibGljIGF1dG9TZWxlY3RGaXJzdEl0ZW0gPSBmYWxzZTtcclxuICBASW5wdXQoJ3NlbGVjdC1vbi1ibHVyJykgcHVibGljIHNlbGVjdE9uQmx1ciA9IGZhbHNlO1xyXG4gIEBJbnB1dCgncmUtZm9jdXMtYWZ0ZXItc2VsZWN0JykgcHVibGljIHJlRm9jdXNBZnRlclNlbGVjdCA9IHRydWU7XHJcbiAgQElucHV0KCdoZWFkZXItaXRlbS10ZW1wbGF0ZScpIHB1YmxpYyBoZWFkZXJJdGVtVGVtcGxhdGUgPSBudWxsO1xyXG4gIEBJbnB1dCgnaWdub3JlLWFjY2VudHMnKSBwdWJsaWMgaWdub3JlQWNjZW50cyA9IHRydWU7XHJcblxyXG4gIEBPdXRwdXQoKSBwdWJsaWMgdmFsdWVTZWxlY3RlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgcHVibGljIGN1c3RvbVNlbGVjdGVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIEBPdXRwdXQoKSBwdWJsaWMgdGV4dEVudGVyZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcblxyXG4gIEBWaWV3Q2hpbGQoJ2F1dG9Db21wbGV0ZUlucHV0JykgcHVibGljIGF1dG9Db21wbGV0ZUlucHV0OiBFbGVtZW50UmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ2F1dG9Db21wbGV0ZUNvbnRhaW5lcicpIHB1YmxpYyBhdXRvQ29tcGxldGVDb250YWluZXI6IEVsZW1lbnRSZWY7XHJcblxyXG4gIHB1YmxpYyBkcm9wZG93blZpc2libGUgPSBmYWxzZTtcclxuICBwdWJsaWMgaXNMb2FkaW5nID0gZmFsc2U7XHJcblxyXG4gIHB1YmxpYyBmaWx0ZXJlZExpc3Q6IGFueVtdID0gW107XHJcbiAgcHVibGljIG1pbkNoYXJzRW50ZXJlZCA9IGZhbHNlO1xyXG4gIHB1YmxpYyBpdGVtSW5kZXg6IG51bWJlciA9IG51bGw7XHJcbiAgcHVibGljIGtleXdvcmQ6IHN0cmluZztcclxuXHJcbiAgcHJpdmF0ZSBlbDogSFRNTEVsZW1lbnQ7ICAgICAgICAgICAvLyB0aGlzIGNvbXBvbmVudCAgZWxlbWVudCBgPG5ndWktYXV0by1jb21wbGV0ZT5gXHJcbiAgcHJpdmF0ZSB0aW1lciA9IDA7XHJcblxyXG4gIHByaXZhdGUgZGVsYXkgPSAoKCkgPT4ge1xyXG4gICAgbGV0IHRpbWVyID0gbnVsbDtcclxuICAgIHJldHVybiAoY2FsbGJhY2s6IGFueSwgbXM6IG51bWJlcikgPT4ge1xyXG4gICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xyXG4gICAgICB0aW1lciA9IHNldFRpbWVvdXQoY2FsbGJhY2ssIG1zKTtcclxuICAgIH07XHJcbiAgfSkoKTtcclxuICBwcml2YXRlIHNlbGVjdE9uRW50ZXIgPSBmYWxzZTtcclxuXHJcbiAgLyoqXHJcbiAgICogY29uc3RydWN0b3JcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvcihlbGVtZW50UmVmOiBFbGVtZW50UmVmLCBwdWJsaWMgYXV0b0NvbXBsZXRlOiBOZ3VpQXV0b0NvbXBsZXRlKSB7XHJcbiAgICB0aGlzLmVsID0gZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogdXNlciBlbnRlcnMgaW50byBpbnB1dCBlbCwgc2hvd3MgbGlzdCB0byBzZWxlY3QsIHRoZW4gc2VsZWN0IG9uZVxyXG4gICAqL1xyXG4gIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgdGhpcy5hdXRvQ29tcGxldGUuc291cmNlID0gdGhpcy5zb3VyY2U7XHJcbiAgICB0aGlzLmF1dG9Db21wbGV0ZS5wYXRoVG9EYXRhID0gdGhpcy5wYXRoVG9EYXRhO1xyXG4gICAgdGhpcy5hdXRvQ29tcGxldGUubGlzdEZvcm1hdHRlciA9IHRoaXMubGlzdEZvcm1hdHRlcjtcclxuICAgIGlmICh0aGlzLmF1dG9TZWxlY3RGaXJzdEl0ZW0pIHtcclxuICAgICAgdGhpcy5pdGVtSW5kZXggPSAwO1xyXG4gICAgfVxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLmF1dG9Db21wbGV0ZUlucHV0ICYmIHRoaXMucmVGb2N1c0FmdGVyU2VsZWN0KSB7XHJcbiAgICAgICAgdGhpcy5hdXRvQ29tcGxldGVJbnB1dC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuc2hvd0Ryb3Bkb3duT25Jbml0KSB7XHJcbiAgICAgICAgdGhpcy5zaG93RHJvcGRvd25MaXN0KHt0YXJnZXQ6IHt2YWx1ZTogJyd9fSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGlzU3JjQXJyKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkodGhpcy5zb3VyY2UpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlbG9hZExpc3RJbkRlbGF5ID0gKGV2dDogYW55KTogdm9pZCA9PiB7XHJcbiAgICBjb25zdCBkZWxheU1zID0gdGhpcy5pc1NyY0FycigpID8gMTAgOiA1MDA7XHJcbiAgICBjb25zdCBrZXl3b3JkID0gZXZ0LnRhcmdldC52YWx1ZTtcclxuXHJcbiAgICAvLyBleGVjdXRpbmcgYWZ0ZXIgdXNlciBzdG9wcGVkIHR5cGluZ1xyXG4gICAgdGhpcy5kZWxheSgoKSA9PiB0aGlzLnJlbG9hZExpc3Qoa2V5d29yZCksIGRlbGF5TXMpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNob3dEcm9wZG93bkxpc3QoZXZlbnQ6IGFueSk6IHZvaWQge1xyXG4gICAgdGhpcy5kcm9wZG93blZpc2libGUgPSB0cnVlO1xyXG4gICAgdGhpcy5yZWxvYWRMaXN0KGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaGlkZURyb3Bkb3duTGlzdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuc2VsZWN0T25FbnRlciA9IGZhbHNlO1xyXG4gICAgdGhpcy5kcm9wZG93blZpc2libGUgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBmaW5kSXRlbUZyb21TZWxlY3RWYWx1ZShzZWxlY3RUZXh0OiBzdHJpbmcpOiBhbnkge1xyXG4gICAgY29uc3QgbWF0Y2hpbmdJdGVtcyA9IHRoaXMuZmlsdGVyZWRMaXN0LmZpbHRlcigoaXRlbSkgPT4gKCcnICsgaXRlbSkgPT09IHNlbGVjdFRleHQpO1xyXG4gICAgcmV0dXJuIG1hdGNoaW5nSXRlbXMubGVuZ3RoID8gbWF0Y2hpbmdJdGVtc1swXSA6IG51bGw7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgcmVsb2FkTGlzdChrZXl3b3JkOiBzdHJpbmcpOiB2b2lkIHtcclxuXHJcbiAgICB0aGlzLmZpbHRlcmVkTGlzdCA9IFtdO1xyXG4gICAgaWYgKGtleXdvcmQubGVuZ3RoIDwgKHRoaXMubWluQ2hhcnMgfHwgMCkpIHtcclxuICAgICAgdGhpcy5taW5DaGFyc0VudGVyZWQgPSBmYWxzZTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5taW5DaGFyc0VudGVyZWQgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLmlzU3JjQXJyKCkpIHsgICAgLy8gbG9jYWwgc291cmNlXHJcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuZmlsdGVyZWRMaXN0ID0gdGhpcy5hdXRvQ29tcGxldGUuZmlsdGVyKHRoaXMuc291cmNlLCBrZXl3b3JkLCB0aGlzLm1hdGNoRm9ybWF0dGVkLCB0aGlzLmlnbm9yZUFjY2VudHMpO1xyXG4gICAgICBpZiAodGhpcy5tYXhOdW1MaXN0KSB7XHJcbiAgICAgICAgdGhpcy5maWx0ZXJlZExpc3QgPSB0aGlzLmZpbHRlcmVkTGlzdC5zbGljZSgwLCB0aGlzLm1heE51bUxpc3QpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSBlbHNlIHsgICAgICAgICAgICAgICAgIC8vIHJlbW90ZSBzb3VyY2VcclxuICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xyXG5cclxuICAgICAgaWYgKHR5cGVvZiB0aGlzLnNvdXJjZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIC8vIGN1c3RvbSBmdW5jdGlvbiB0aGF0IHJldHVybnMgb2JzZXJ2YWJsZVxyXG4gICAgICAgIHRoaXMuc291cmNlKGtleXdvcmQpLnN1YnNjcmliZShcclxuICAgICAgICAgIChyZXNwKSA9PiB7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5wYXRoVG9EYXRhKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcGF0aHMgPSB0aGlzLnBhdGhUb0RhdGEuc3BsaXQoJy4nKTtcclxuICAgICAgICAgICAgICBwYXRocy5mb3JFYWNoKChwcm9wKSA9PiByZXNwID0gcmVzcFtwcm9wXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyZWRMaXN0ID0gcmVzcDtcclxuICAgICAgICAgICAgaWYgKHRoaXMubWF4TnVtTGlzdCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuZmlsdGVyZWRMaXN0ID0gdGhpcy5maWx0ZXJlZExpc3Quc2xpY2UoMCwgdGhpcy5tYXhOdW1MaXN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIChlcnJvcikgPT4gbnVsbCxcclxuICAgICAgICAgICgpID0+IHRoaXMuaXNMb2FkaW5nID0gZmFsc2UgLy8gY29tcGxldGVcclxuICAgICAgICApO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIHJlbW90ZSBzb3VyY2VcclxuXHJcbiAgICAgICAgdGhpcy5hdXRvQ29tcGxldGUuZ2V0UmVtb3RlRGF0YShrZXl3b3JkKS5zdWJzY3JpYmUoKHJlc3ApID0+IHtcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJlZExpc3QgPSByZXNwID8gcmVzcCA6IFtdO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5tYXhOdW1MaXN0KSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5maWx0ZXJlZExpc3QgPSB0aGlzLmZpbHRlcmVkTGlzdC5zbGljZSgwLCB0aGlzLm1heE51bUxpc3QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgKGVycm9yKSA9PiBudWxsLFxyXG4gICAgICAgICAgKCkgPT4gdGhpcy5pc0xvYWRpbmcgPSBmYWxzZSAvLyBjb21wbGV0ZVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZWxlY3RPbmUoZGF0YTogYW55KSB7XHJcbiAgICBpZiAoISFkYXRhIHx8IGRhdGEgPT09ICcnKSB7XHJcbiAgICAgIHRoaXMudmFsdWVTZWxlY3RlZC5lbWl0KGRhdGEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5jdXN0b21TZWxlY3RlZC5lbWl0KHRoaXMua2V5d29yZCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZW50ZXJUZXh0KGRhdGE6IGFueSkge1xyXG4gICAgdGhpcy50ZXh0RW50ZXJlZC5lbWl0KGRhdGEpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGJsdXJIYW5kbGVyKGV2dDogYW55KSB7XHJcbiAgICBpZiAodGhpcy5zZWxlY3RPbkJsdXIpIHtcclxuICAgICAgdGhpcy5zZWxlY3RPbmUodGhpcy5maWx0ZXJlZExpc3RbdGhpcy5pdGVtSW5kZXhdKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmhpZGVEcm9wZG93bkxpc3QoKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBpbnB1dEVsS2V5SGFuZGxlciA9IChldnQ6IGFueSkgPT4ge1xyXG4gICAgY29uc3QgdG90YWxOdW1JdGVtID0gdGhpcy5maWx0ZXJlZExpc3QubGVuZ3RoO1xyXG5cclxuICAgIGlmICghdGhpcy5zZWxlY3RPbkVudGVyICYmIHRoaXMuYXV0b1NlbGVjdEZpcnN0SXRlbSAmJiAoMCAhPT0gdG90YWxOdW1JdGVtKSkge1xyXG4gICAgICB0aGlzLnNlbGVjdE9uRW50ZXIgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHN3aXRjaCAoZXZ0LmtleUNvZGUpIHtcclxuICAgICAgY2FzZSAyNzogLy8gRVNDLCBoaWRlIGF1dG8gY29tcGxldGVcclxuICAgICAgICB0aGlzLnNlbGVjdE9uRW50ZXIgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNlbGVjdE9uZSh1bmRlZmluZWQpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAzODogLy8gVVAsIHNlbGVjdCB0aGUgcHJldmlvdXMgbGkgZWxcclxuICAgICAgICBpZiAoMCA9PT0gdG90YWxOdW1JdGVtKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VsZWN0T25FbnRlciA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5pdGVtSW5kZXggPSAodG90YWxOdW1JdGVtICsgdGhpcy5pdGVtSW5kZXggLSAxKSAlIHRvdGFsTnVtSXRlbTtcclxuICAgICAgICB0aGlzLnNjcm9sbFRvVmlldyh0aGlzLml0ZW1JbmRleCk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIDQwOiAvLyBET1dOLCBzZWxlY3QgdGhlIG5leHQgbGkgZWwgb3IgdGhlIGZpcnN0IG9uZVxyXG4gICAgICAgIGlmICgwID09PSB0b3RhbE51bUl0ZW0pIHtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZWxlY3RPbkVudGVyID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmRyb3Bkb3duVmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgbGV0IHN1bSA9IHRoaXMuaXRlbUluZGV4O1xyXG4gICAgICAgIHN1bSA9ICh0aGlzLml0ZW1JbmRleCA9PT0gbnVsbCkgPyAwIDogc3VtICsgMTtcclxuICAgICAgICB0aGlzLml0ZW1JbmRleCA9ICh0b3RhbE51bUl0ZW0gKyBzdW0pICUgdG90YWxOdW1JdGVtO1xyXG4gICAgICAgIHRoaXMuc2Nyb2xsVG9WaWV3KHRoaXMuaXRlbUluZGV4KTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgMTM6IC8vIEVOVEVSLCBjaG9vc2UgaXQhIVxyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdE9uRW50ZXIpIHtcclxuICAgICAgICAgIHRoaXMuc2VsZWN0T25lKHRoaXMuZmlsdGVyZWRMaXN0W3RoaXMuaXRlbUluZGV4XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSA5OiAvLyBUQUIsIGNob29zZSBpZiB0YWItdG8tc2VsZWN0IGlzIGVuYWJsZWRcclxuICAgICAgICBpZiAodGhpcy50YWJUb1NlbGVjdCkge1xyXG4gICAgICAgICAgdGhpcy5zZWxlY3RPbmUodGhpcy5maWx0ZXJlZExpc3RbdGhpcy5pdGVtSW5kZXhdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2Nyb2xsVG9WaWV3KGluZGV4KSB7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmF1dG9Db21wbGV0ZUNvbnRhaW5lci5uYXRpdmVFbGVtZW50O1xyXG4gICAgY29uc3QgdWwgPSBjb250YWluZXIucXVlcnlTZWxlY3RvcigndWwnKTtcclxuICAgIGNvbnN0IGxpID0gdWwucXVlcnlTZWxlY3RvcignbGknKTsgIC8vIGp1c3Qgc2FtcGxlIHRoZSBmaXJzdCBsaSB0byBnZXQgaGVpZ2h0XHJcbiAgICBjb25zdCBsaUhlaWdodCA9IGxpLm9mZnNldEhlaWdodDtcclxuICAgIGNvbnN0IHNjcm9sbFRvcCA9IHVsLnNjcm9sbFRvcDtcclxuICAgIGNvbnN0IHZpZXdwb3J0ID0gc2Nyb2xsVG9wICsgdWwub2Zmc2V0SGVpZ2h0O1xyXG4gICAgY29uc3Qgc2Nyb2xsT2Zmc2V0ID0gbGlIZWlnaHQgKiBpbmRleDtcclxuICAgIGlmIChzY3JvbGxPZmZzZXQgPCBzY3JvbGxUb3AgfHwgKHNjcm9sbE9mZnNldCArIGxpSGVpZ2h0KSA+IHZpZXdwb3J0KSB7XHJcbiAgICAgIHVsLnNjcm9sbFRvcCA9IHNjcm9sbE9mZnNldDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyB0cmFja0J5SW5kZXgoaW5kZXgsIGl0ZW0pIHtcclxuICAgIHJldHVybiBpbmRleDtcclxuICB9XHJcblxyXG4gIGdldCBlbXB0eUxpc3QoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gIShcclxuICAgICAgdGhpcy5pc0xvYWRpbmcgfHxcclxuICAgICAgKHRoaXMubWluQ2hhcnNFbnRlcmVkICYmICF0aGlzLmlzTG9hZGluZyAmJiAhdGhpcy5maWx0ZXJlZExpc3QubGVuZ3RoKSB8fFxyXG4gICAgICAodGhpcy5maWx0ZXJlZExpc3QubGVuZ3RoKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG59XHJcbiJdfQ==
