import { __decorate } from "tslib";
import { Component, ElementRef, EventEmitter, Input, OnInit, Output, ViewChild, ViewEncapsulation } from '@angular/core';
import { NguiAutoComplete } from './auto-complete.service';
let NguiAutoCompleteComponent = class NguiAutoCompleteComponent {
    /**
     * constructor
     */
    constructor(elementRef, autoComplete) {
        this.autoComplete = autoComplete;
        /**
         * public input properties
         */
        this.autocomplete = false;
        this.minChars = 0;
        this.acceptUserInput = true;
        this.loadingText = 'Loading';
        this.loadingTemplate = null;
        this.showInputTag = true;
        this.showDropdownOnInit = false;
        this.tabToSelect = true;
        this.matchFormatted = false;
        this.autoSelectFirstItem = false;
        this.selectOnBlur = false;
        this.reFocusAfterSelect = true;
        this.headerItemTemplate = null;
        this.ignoreAccents = true;
        this.valueSelected = new EventEmitter();
        this.customSelected = new EventEmitter();
        this.textEntered = new EventEmitter();
        this.dropdownVisible = false;
        this.isLoading = false;
        this.filteredList = [];
        this.minCharsEntered = false;
        this.itemIndex = null;
        this.timer = 0;
        this.delay = (() => {
            let timer = null;
            return (callback, ms) => {
                clearTimeout(timer);
                timer = setTimeout(callback, ms);
            };
        })();
        this.selectOnEnter = false;
        this.reloadListInDelay = (evt) => {
            const delayMs = this.isSrcArr() ? 10 : 500;
            const keyword = evt.target.value;
            // executing after user stopped typing
            this.delay(() => this.reloadList(keyword), delayMs);
        };
        this.inputElKeyHandler = (evt) => {
            const totalNumItem = this.filteredList.length;
            if (!this.selectOnEnter && this.autoSelectFirstItem && (0 !== totalNumItem)) {
                this.selectOnEnter = true;
            }
            switch (evt.keyCode) {
                case 27: // ESC, hide auto complete
                    this.selectOnEnter = false;
                    this.selectOne(undefined);
                    break;
                case 38: // UP, select the previous li el
                    if (0 === totalNumItem) {
                        return;
                    }
                    this.selectOnEnter = true;
                    this.itemIndex = (totalNumItem + this.itemIndex - 1) % totalNumItem;
                    this.scrollToView(this.itemIndex);
                    break;
                case 40: // DOWN, select the next li el or the first one
                    if (0 === totalNumItem) {
                        return;
                    }
                    this.selectOnEnter = true;
                    this.dropdownVisible = true;
                    let sum = this.itemIndex;
                    sum = (this.itemIndex === null) ? 0 : sum + 1;
                    this.itemIndex = (totalNumItem + sum) % totalNumItem;
                    this.scrollToView(this.itemIndex);
                    break;
                case 13: // ENTER, choose it!!
                    if (this.selectOnEnter) {
                        this.selectOne(this.filteredList[this.itemIndex]);
                    }
                    evt.preventDefault();
                    break;
                case 9: // TAB, choose if tab-to-select is enabled
                    if (this.tabToSelect) {
                        this.selectOne(this.filteredList[this.itemIndex]);
                    }
                    break;
            }
        };
        this.el = elementRef.nativeElement;
    }
    /**
     * user enters into input el, shows list to select, then select one
     */
    ngOnInit() {
        this.autoComplete.source = this.source;
        this.autoComplete.pathToData = this.pathToData;
        this.autoComplete.listFormatter = this.listFormatter;
        if (this.autoSelectFirstItem) {
            this.itemIndex = 0;
        }
        setTimeout(() => {
            if (this.autoCompleteInput && this.reFocusAfterSelect) {
                this.autoCompleteInput.nativeElement.focus();
            }
            if (this.showDropdownOnInit) {
                this.showDropdownList({ target: { value: '' } });
            }
        });
    }
    isSrcArr() {
        return Array.isArray(this.source);
    }
    showDropdownList(event) {
        this.dropdownVisible = true;
        this.reloadList(event.target.value);
    }
    hideDropdownList() {
        this.selectOnEnter = false;
        this.dropdownVisible = false;
    }
    findItemFromSelectValue(selectText) {
        const matchingItems = this.filteredList.filter((item) => ('' + item) === selectText);
        return matchingItems.length ? matchingItems[0] : null;
    }
    reloadList(keyword) {
        this.filteredList = [];
        if (keyword.length < (this.minChars || 0)) {
            this.minCharsEntered = false;
            return;
        }
        else {
            this.minCharsEntered = true;
        }
        if (this.isSrcArr()) { // local source
            this.isLoading = false;
            this.filteredList = this.autoComplete.filter(this.source, keyword, this.matchFormatted, this.ignoreAccents);
            if (this.maxNumList) {
                this.filteredList = this.filteredList.slice(0, this.maxNumList);
            }
        }
        else { // remote source
            this.isLoading = true;
            if (typeof this.source === 'function') {
                // custom function that returns observable
                this.source(keyword).subscribe((resp) => {
                    if (this.pathToData) {
                        const paths = this.pathToData.split('.');
                        paths.forEach((prop) => resp = resp[prop]);
                    }
                    this.filteredList = resp;
                    if (this.maxNumList) {
                        this.filteredList = this.filteredList.slice(0, this.maxNumList);
                    }
                }, (error) => null, () => this.isLoading = false // complete
                );
            }
            else {
                // remote source
                this.autoComplete.getRemoteData(keyword).subscribe((resp) => {
                    this.filteredList = resp ? resp : [];
                    if (this.maxNumList) {
                        this.filteredList = this.filteredList.slice(0, this.maxNumList);
                    }
                }, (error) => null, () => this.isLoading = false // complete
                );
            }
        }
    }
    selectOne(data) {
        if (!!data || data === '') {
            this.valueSelected.emit(data);
        }
        else {
            this.customSelected.emit(this.keyword);
        }
    }
    enterText(data) {
        this.textEntered.emit(data);
    }
    blurHandler(evt) {
        if (this.selectOnBlur) {
            this.selectOne(this.filteredList[this.itemIndex]);
        }
        this.hideDropdownList();
    }
    scrollToView(index) {
        const container = this.autoCompleteContainer.nativeElement;
        const ul = container.querySelector('ul');
        const li = ul.querySelector('li'); // just sample the first li to get height
        const liHeight = li.offsetHeight;
        const scrollTop = ul.scrollTop;
        const viewport = scrollTop + ul.offsetHeight;
        const scrollOffset = liHeight * index;
        if (scrollOffset < scrollTop || (scrollOffset + liHeight) > viewport) {
            ul.scrollTop = scrollOffset;
        }
    }
    trackByIndex(index, item) {
        return index;
    }
    get emptyList() {
        return !(this.isLoading ||
            (this.minCharsEntered && !this.isLoading && !this.filteredList.length) ||
            (this.filteredList.length));
    }
};
NguiAutoCompleteComponent.ctorParameters = () => [
    { type: ElementRef },
    { type: NguiAutoComplete }
];
__decorate([
    Input('autocomplete')
], NguiAutoCompleteComponent.prototype, "autocomplete", void 0);
__decorate([
    Input('list-formatter')
], NguiAutoCompleteComponent.prototype, "listFormatter", void 0);
__decorate([
    Input('source')
], NguiAutoCompleteComponent.prototype, "source", void 0);
__decorate([
    Input('path-to-data')
], NguiAutoCompleteComponent.prototype, "pathToData", void 0);
__decorate([
    Input('min-chars')
], NguiAutoCompleteComponent.prototype, "minChars", void 0);
__decorate([
    Input('placeholder')
], NguiAutoCompleteComponent.prototype, "placeholder", void 0);
__decorate([
    Input('blank-option-text')
], NguiAutoCompleteComponent.prototype, "blankOptionText", void 0);
__decorate([
    Input('no-match-found-text')
], NguiAutoCompleteComponent.prototype, "noMatchFoundText", void 0);
__decorate([
    Input('accept-user-input')
], NguiAutoCompleteComponent.prototype, "acceptUserInput", void 0);
__decorate([
    Input('loading-text')
], NguiAutoCompleteComponent.prototype, "loadingText", void 0);
__decorate([
    Input('loading-template')
], NguiAutoCompleteComponent.prototype, "loadingTemplate", void 0);
__decorate([
    Input('max-num-list')
], NguiAutoCompleteComponent.prototype, "maxNumList", void 0);
__decorate([
    Input('show-input-tag')
], NguiAutoCompleteComponent.prototype, "showInputTag", void 0);
__decorate([
    Input('show-dropdown-on-init')
], NguiAutoCompleteComponent.prototype, "showDropdownOnInit", void 0);
__decorate([
    Input('tab-to-select')
], NguiAutoCompleteComponent.prototype, "tabToSelect", void 0);
__decorate([
    Input('match-formatted')
], NguiAutoCompleteComponent.prototype, "matchFormatted", void 0);
__decorate([
    Input('auto-select-first-item')
], NguiAutoCompleteComponent.prototype, "autoSelectFirstItem", void 0);
__decorate([
    Input('select-on-blur')
], NguiAutoCompleteComponent.prototype, "selectOnBlur", void 0);
__decorate([
    Input('re-focus-after-select')
], NguiAutoCompleteComponent.prototype, "reFocusAfterSelect", void 0);
__decorate([
    Input('header-item-template')
], NguiAutoCompleteComponent.prototype, "headerItemTemplate", void 0);
__decorate([
    Input('ignore-accents')
], NguiAutoCompleteComponent.prototype, "ignoreAccents", void 0);
__decorate([
    Output()
], NguiAutoCompleteComponent.prototype, "valueSelected", void 0);
__decorate([
    Output()
], NguiAutoCompleteComponent.prototype, "customSelected", void 0);
__decorate([
    Output()
], NguiAutoCompleteComponent.prototype, "textEntered", void 0);
__decorate([
    ViewChild('autoCompleteInput')
], NguiAutoCompleteComponent.prototype, "autoCompleteInput", void 0);
__decorate([
    ViewChild('autoCompleteContainer')
], NguiAutoCompleteComponent.prototype, "autoCompleteContainer", void 0);
NguiAutoCompleteComponent = __decorate([
    Component({
        selector: 'ngui-auto-complete',
        template: "\n<div #autoCompleteContainer class=\"ngui-auto-complete\">\n" +
        "                        <!-- keyword input -->\n" +
        "                        <input *ngIf=\"showInputTag\"\n" +
        "                               #autoCompleteInput class=\"keyword\"\n" +
        "                               [attr.autocomplete]=\"autocomplete ? 'null' : 'off'\"\n" +
        "                               placeholder=\"{{placeholder}}\"\n" +
        "                               (focus)=\"showDropdownList($event)\"\n" +
        "                               (blur)=\"blurHandler($event)\"\n" +
        "                               (keydown)=\"inputElKeyHandler($event)\"\n" +
        "                               (input)=\"reloadListInDelay($event)\"\n" +
        "                               [(ngModel)]=\"keyword\"/>\n" +
        "\n" +
        "                        <!-- dropdown that user can select -->\n" +
        "                        <div class=\"resultWrapper\">\n" +
        "                          <div class=\"autoCompleteSubTitle\">Airport List</div>\n" +
        "                          <div *ngIf=\"dropdownVisible\" [class.empty]=\"emptyList\">\n" +
        "                            <div *ngIf=\"isLoading && loadingTemplate\" class=\"loading\"\n" +
        "                                [innerHTML]=\"loadingTemplate\">\n" +
        "                            </div>\n" +
        "                            <div *ngIf=\"isLoading && !loadingTemplate\" class=\"loading\">{{loadingText}}</div>\n" +
        "                            <div *ngIf=\"minCharsEntered && !isLoading && !filteredList.length\"\n" +
        "                                (mousedown)=\"selectOne('')\"\n" +
        "                                class=\"no-match-found\">{{noMatchFoundText || 'No Result Found'}}\n" +
        "                            </div>\n" +
        "                            <div *ngIf=\"headerItemTemplate && filteredList.length\" class=\"header-item\"\n" +
        "                                [innerHTML]=\"headerItemTemplate\">\n" +
        "                            </div>\n" +
        "                            <div *ngIf=\"blankOptionText && filteredList.length\"\n" +
        "                                (mousedown)=\"selectOne('')\"\n" +
        "                                class=\"blank-item\">{{blankOptionText}}\n" +
        "                            </div>\n" +
        "                            <div class=\"autoCompleteWrapper\"\n" +
        "                                *ngFor=\"let item of filteredList; let i=index; trackBy: trackByIndex\"\n" +
        "                                (mousedown)=\"selectOne(item)\"\n" +
        "                                [ngClass]=\"{selected: i === itemIndex}\"\n" +
        "                                [innerHtml]=\"autoComplete.getFormattedListItem(item)\">\n" +
        "                            </div>\n" +
        "                          </div>\n" +
        "                        </div>\n" +
        "                      </div>",
        encapsulation: ViewEncapsulation.None,
        styles: [`
    @keyframes slideDown {
      0% {
        transform: translateY(-10px);
      }
      100% {
        transform: translateY(0px);
      }
    }

    .ngui-auto-complete {
      background-color: transparent;
    }

    .ngui-auto-complete > input {
      outline: none;
      border: 0;
      padding: 2px;
      box-sizing: border-box;
      background-clip: content-box;
    }

    .ngui-auto-complete > ul {
      background-color: #fff;
      margin: 0;
      width: 100%;
      overflow-y: auto;
      list-style-type: none;
      padding: 0;
      border: 1px solid #ccc;
      box-sizing: border-box;
      animation: slideDown 0.1s;
    }

    .ngui-auto-complete > ul.empty {
      display: none;
    }

    .ngui-auto-complete > ul li {
      padding: 2px 5px;
      border-bottom: 1px solid #eee;
    }

    .ngui-auto-complete > ul li.selected {
      background-color: #ccc;
    }

    .ngui-auto-complete > ul li:last-child {
      border-bottom: none;
    }

    .ngui-auto-complete > ul li:not(.header-item):hover {
      background-color: #ccc;
    }`]
    })
], NguiAutoCompleteComponent);
export { NguiAutoCompleteComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXV0by1jb21wbGV0ZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Abmd1aS9hdXRvLWNvbXBsZXRlLyIsInNvdXJjZXMiOlsibGliL2F1dG8tY29tcGxldGUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pILE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBbUczRCxJQUFhLHlCQUF5QixHQUF0QyxNQUFhLHlCQUF5QjtJQXNEcEM7O09BRUc7SUFDSCxZQUFZLFVBQXNCLEVBQVMsWUFBOEI7UUFBOUIsaUJBQVksR0FBWixZQUFZLENBQWtCO1FBdkR6RTs7V0FFRztRQUMyQixpQkFBWSxHQUFHLEtBQUssQ0FBQztRQUl4QixhQUFRLEdBQUcsQ0FBQyxDQUFDO1FBSUwsb0JBQWUsR0FBRyxJQUFJLENBQUM7UUFDNUIsZ0JBQVcsR0FBRyxTQUFTLENBQUM7UUFDcEIsb0JBQWUsR0FBRyxJQUFJLENBQUM7UUFFekIsaUJBQVksR0FBRyxJQUFJLENBQUM7UUFDYix1QkFBa0IsR0FBRyxLQUFLLENBQUM7UUFDbkMsZ0JBQVcsR0FBRyxJQUFJLENBQUM7UUFDakIsbUJBQWMsR0FBRyxLQUFLLENBQUM7UUFDaEIsd0JBQW1CLEdBQUcsS0FBSyxDQUFDO1FBQ3BDLGlCQUFZLEdBQUcsS0FBSyxDQUFDO1FBQ2QsdUJBQWtCLEdBQUcsSUFBSSxDQUFDO1FBQzNCLHVCQUFrQixHQUFHLElBQUksQ0FBQztRQUNoQyxrQkFBYSxHQUFHLElBQUksQ0FBQztRQUVwQyxrQkFBYSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUM7UUFDbkMsbUJBQWMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBQ3BDLGdCQUFXLEdB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UyxDQUFDLG1CQUFtQixDQUFDO29FQUFzQztBQUNqQztJQUFuQyxTQUFTLENBQUMsdUJBQXVCLENBQUM7d0VBQTBDO0FBaENsRSx5QkFBeUI7SUFqR3JDLFNBQVMsQ0FBQztRQUNULFFBQVEsRUFBRSxvQkFBb0I7UUFDOUIsUUFBUSxFQUFFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBcUNUO1FBd0RELGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJO2lCQXZENUI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O01BcURMO0tBR0wsQ0FBQztHQUNXLHlCQUF5QixDQWdRckM7U0FoUVkseUJBQXlCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkluaXQsIE91dHB1dCwgVmlld0NoaWxkLCBWaWV3RW5jYXBzdWxhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBOZ3VpQXV0b0NvbXBsZXRlIH0gZnJvbSAnLi9hdXRvLWNvbXBsZXRlLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICduZ3VpLWF1dG8tY29tcGxldGUnLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgICA8ZGl2ICNhdXRvQ29tcGxldGVDb250YWluZXIgY2xhc3M9XCJuZ3VpLWF1dG8tY29tcGxldGVcIj5cclxuICAgICAgPCEtLSBrZXl3b3JkIGlucHV0IC0tPlxyXG4gICAgICA8aW5wdXQgKm5nSWY9XCJzaG93SW5wdXRUYWdcIlxyXG4gICAgICAgICAgICAgI2F1dG9Db21wbGV0ZUlucHV0IGNsYXNzPVwia2V5d29yZFwiXHJcbiAgICAgICAgICAgICBbYXR0ci5hdXRvY29tcGxldGVdPVwiYXV0b2NvbXBsZXRlID8gJ251bGwnIDogJ29mZidcIlxyXG4gICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJ7e3BsYWNlaG9sZGVyfX1cIlxyXG4gICAgICAgICAgICAgKGZvY3VzKT1cInNob3dEcm9wZG93bkxpc3QoJGV2ZW50KVwiXHJcbiAgICAgICAgICAgICAoYmx1cik9XCJibHVySGFuZGxlcigkZXZlbnQpXCJcclxuICAgICAgICAgICAgIChrZXlkb3duKT1cImlucHV0RWxLZXlIYW5kbGVyKCRldmVudClcIlxyXG4gICAgICAgICAgICAgKGlucHV0KT1cInJlbG9hZExpc3RJbkRlbGF5KCRldmVudClcIlxyXG4gICAgICAgICAgICAgWyhuZ01vZGVsKV09XCJrZXl3b3JkXCIvPlxyXG5cclxuICAgICAgPCEtLSBkcm9wZG93biB0aGF0IHVzZXIgY2FuIHNlbGVjdCAtLT5cclxuICAgICAgPHVsICpuZ0lmPVwiZHJvcGRvd25WaXNpYmxlXCIgW2NsYXNzLmVtcHR5XT1cImVtcHR5TGlzdFwiPlxyXG4gICAgICAgIDxsaSAqbmdJZj1cImlzTG9hZGluZyAmJiBsb2FkaW5nVGVtcGxhdGVcIiBjbGFzcz1cImxvYWRpbmdcIlxyXG4gICAgICAgICAgICBbaW5uZXJIVE1MXT1cImxvYWRpbmdUZW1wbGF0ZVwiPjwvbGk+XHJcbiAgICAgICAgPGxpICpuZ0lmPVwiaXNMb2FkaW5nICYmICFsb2FkaW5nVGVtcGxhdGVcIiBjbGFzcz1cImxvYWRpbmdcIj57e2xvYWRpbmdUZXh0fX08L2xpPlxyXG4gICAgICAgIDxsaSAqbmdJZj1cIm1pbkNoYXJzRW50ZXJlZCAmJiAhaXNMb2FkaW5nICYmICFmaWx0ZXJlZExpc3QubGVuZ3RoXCJcclxuICAgICAgICAgICAgKG1vdXNlZG93bik9XCJzZWxlY3RPbmUoJycpXCJcclxuICAgICAgICAgICAgY2xhc3M9XCJuby1tYXRjaC1mb3VuZFwiPnt7bm9NYXRjaEZvdW5kVGV4dCB8fCAnTm8gUmVzdWx0IEZvdW5kJ319XHJcbiAgICAgICAgPC9saT5cclxuICAgICAgICA8bGkgKm5nSWY9XCJoZWFkZXJJdGVtVGVtcGxhdGUgJiYgZmlsdGVyZWRMaXN0Lmxlbmd0aFwiIGNsYXNzPVwiaGVhZGVyLWl0ZW1cIlxyXG4gICAgICAgICAgICBbaW5uZXJIVE1MXT1cImhlYWRlckl0ZW1UZW1wbGF0ZVwiPjwvbGk+XHJcbiAgICAgICAgPGxpICpuZ0lmPVwiYmxhbmtPcHRpb25UZXh0ICYmIGZpbHRlcmVkTGlzdC5sZW5ndGhcIlxyXG4gICAgICAgICAgICAobW91c2Vkb3duKT1cInNlbGVjdE9uZSgnJylcIlxyXG4gICAgICAgICAgICBjbGFzcz1cImJsYW5rLWl0ZW1cIj57e2JsYW5rT3B0aW9uVGV4dH19XHJcbiAgICAgICAgPC9saT5cclxuICAgICAgICA8bGkgY2xhc3M9XCJpdGVtXCJcclxuICAgICAgICAgICAgKm5nRm9yPVwibGV0IGl0ZW0gb2YgZmlsdGVyZWRMaXN0OyBsZXQgaT1pbmRleDsgdHJhY2tCeTogdHJhY2tCeUluZGV4XCJcclxuICAgICAgICAgICAgKG1vdXNlZG93bik9XCJzZWxlY3RPbmUoaXRlbSlcIlxyXG4gICAgICAgICAgICBbbmdDbGFzc109XCJ7c2VsZWN0ZWQ6IGkgPT09IGl0ZW1JbmRleH1cIlxyXG4gICAgICAgICAgICBbaW5uZXJIdG1sXT1cImF1dG9Db21wbGV0ZS5nZXRGb3JtYXR0ZWRMaXN0SXRlbShpdGVtKVwiPlxyXG4gICAgICAgIDwvbGk+XHJcbiAgICAgIDwvdWw+XHJcblxyXG4gICAgPC9kaXY+XHJcbiAgYCxcclxuICBzdHlsZXM6IFtgXHJcbiAgICBAa2V5ZnJhbWVzIHNsaWRlRG93biB7XHJcbiAgICAgIDAlIHtcclxuICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTEwcHgpO1xyXG4gICAgICB9XHJcbiAgICAgIDEwMCUge1xyXG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwcHgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLm5ndWktYXV0by1jb21wbGV0ZSB7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xyXG4gICAgfVxyXG5cclxuICAgIC5uZ3VpLWF1dG8tY29tcGxldGUgPiBpbnB1dCB7XHJcbiAgICAgIG91dGxpbmU6IG5vbmU7XHJcbiAgICAgIGJvcmRlcjogMDtcclxuICAgICAgcGFkZGluZzogMnB4O1xyXG4gICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xyXG4gICAgICBiYWNrZ3JvdW5kLWNsaXA6IGNvbnRlbnQtYm94O1xyXG4gICAgfVxyXG5cclxuICAgIC5uZ3VpLWF1dG8tY29tcGxldGUgPiB1bCB7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XHJcbiAgICAgIG1hcmdpbjogMDtcclxuICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgIG92ZXJmbG93LXk6IGF1dG87XHJcbiAgICAgIGxpc3Qtc3R5bGUtdHlwZTogbm9uZTtcclxuICAgICAgcGFkZGluZzogMDtcclxuICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcclxuICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcclxuICAgICAgYW5pbWF0aW9uOiBzbGlkZURvd24gMC4xcztcclxuICAgIH1cclxuXHJcbiAgICAubmd1aS1hdXRvLWNvbXBsZXRlID4gdWwuZW1wdHkge1xyXG4gICAgICBkaXNwbGF5OiBub25lO1xyXG4gICAgfVxyXG5cclxuICAgIC5uZ3VpLWF1dG8tY29tcGxldGUgPiB1bCBsaSB7XHJcbiAgICAgIHBhZGRpbmc6IDJweCA1cHg7XHJcbiAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlO1xyXG4gICAgfVxyXG5cclxuICAgIC5uZ3VpLWF1dG8tY29tcGxldGUgPiB1bCBsaS5zZWxlY3RlZCB7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNjY2M7XHJcbiAgICB9XHJcblxyXG4gICAgLm5ndWktYXV0by1jb21wbGV0ZSA+IHVsIGxpOmxhc3QtY2hpbGQge1xyXG4gICAgICBib3JkZXItYm90dG9tOiBub25lO1xyXG4gICAgfVxyXG5cclxuICAgIC5uZ3VpLWF1dG8tY29tcGxldGUgPiB1bCBsaTpub3QoLmhlYWRlci1pdGVtKTpob3ZlciB7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNjY2M7XHJcbiAgICB9YFxyXG4gIF0sXHJcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxyXG59KVxyXG5leHBvcnQgY2xhc3MgTmd1aUF1dG9Db21wbGV0ZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gIC8qKlxyXG4gICAqIHB1YmxpYyBpbnB1dCBwcm9wZXJ0aWVzXHJcbiAgICovXHJcbiAgQElucHV0KCdhdXRvY29tcGxldGUnKSBwdWJsaWMgYXV0b2NvbXBsZXRlID0gZmFsc2U7XHJcbiAgQElucHV0KCdsaXN0LWZvcm1hdHRlcicpIHB1YmxpYyBsaXN0Rm9ybWF0dGVyOiAoYXJnOiBhbnkpID0+IHN0cmluZztcclxuICBASW5wdXQoJ3NvdXJjZScpIHB1YmxpYyBzb3VyY2U6IGFueTtcclxuICBASW5wdXQoJ3BhdGgtdG8tZGF0YScpIHB1YmxpYyBwYXRoVG9EYXRhOiBzdHJpbmc7XHJcbiAgQElucHV0KCdtaW4tY2hhcnMnKSBwdWJsaWMgbWluQ2hhcnMgPSAwO1xyXG4gIEBJbnB1dCgncGxhY2Vob2xkZXInKSBwdWJsaWMgcGxhY2Vob2xkZXI6IHN0cmluZztcclxuICBASW5wdXQoJ2JsYW5rLW9wdGlvbi10ZXh0JykgcHVibGljIGJsYW5rT3B0aW9uVGV4dDogc3RyaW5nO1xyXG4gIEBJbnB1dCgnbm8tbWF0Y2gtZm91bmQtdGV4dCcpIHB1YmxpYyBub01hdGNoRm91bmRUZXh0OiBzdHJpbmc7XHJcbiAgQElucHV0KCdhY2NlcHQtdXNlci1pbnB1dCcpIHB1YmxpYyBhY2NlcHRVc2VySW5wdXQgPSB0cnVlO1xyXG4gIEBJbnB1dCgnbG9hZGluZy10ZXh0JykgcHVibGljIGxvYWRpbmdUZXh0ID0gJ0xvYWRpbmcnO1xyXG4gIEBJbnB1dCgnbG9hZGluZy10ZW1wbGF0ZScpIHB1YmxpYyBsb2FkaW5nVGVtcGxhdGUgPSBudWxsO1xyXG4gIEBJbnB1dCgnbWF4LW51bS1saXN0JykgcHVibGljIG1heE51bUxpc3Q6IG51bWJlcjtcclxuICBASW5wdXQoJ3Nob3ctaW5wdXQtdGFnJykgcHVibGljIHNob3dJbnB1dFRhZyA9IHRydWU7XHJcbiAgQElucHV0KCdzaG93LWRyb3Bkb3duLW9uLWluaXQnKSBwdWJsaWMgc2hvd0Ryb3Bkb3duT25Jbml0ID0gZmFsc2U7XHJcbiAgQElucHV0KCd0YWItdG8tc2VsZWN0JykgcHVibGljIHRhYlRvU2VsZWN0ID0gdHJ1ZTtcclxuICBASW5wdXQoJ21hdGNoLWZvcm1hdHRlZCcpIHB1YmxpYyBtYXRjaEZvcm1hdHRlZCA9IGZhbHNlO1xyXG4gIEBJbnB1dCgnYXV0by1zZWxlY3QtZmlyc3QtaXRlbScpIHB1YmxpYyBhdXRvU2VsZWN0Rmlyc3RJdGVtID0gZmFsc2U7XHJcbiAgQElucHV0KCdzZWxlY3Qtb24tYmx1cicpIHB1YmxpYyBzZWxlY3RPbkJsdXIgPSBmYWxzZTtcclxuICBASW5wdXQoJ3JlLWZvY3VzLWFmdGVyLXNlbGVjdCcpIHB1YmxpYyByZUZvY3VzQWZ0ZXJTZWxlY3QgPSB0cnVlO1xyXG4gIEBJbnB1dCgnaGVhZGVyLWl0ZW0tdGVtcGxhdGUnKSBwdWJsaWMgaGVhZGVySXRlbVRlbXBsYXRlID0gbnVsbDtcclxuICBASW5wdXQoJ2lnbm9yZS1hY2NlbnRzJykgcHVibGljIGlnbm9yZUFjY2VudHMgPSB0cnVlO1xyXG5cclxuICBAT3V0cHV0KCkgcHVibGljIHZhbHVlU2VsZWN0ZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XHJcbiAgQE91dHB1dCgpIHB1YmxpYyBjdXN0b21TZWxlY3RlZCA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuICBAT3V0cHV0KCkgcHVibGljIHRleHRFbnRlcmVkID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICBAVmlld0NoaWxkKCdhdXRvQ29tcGxldGVJbnB1dCcpIHB1YmxpYyBhdXRvQ29tcGxldGVJbnB1dDogRWxlbWVudFJlZjtcclxuICBAVmlld0NoaWxkKCdhdXRvQ29tcGxldGVDb250YWluZXInKSBwdWJsaWMgYXV0b0NvbXBsZXRlQ29udGFpbmVyOiBFbGVtZW50UmVmO1xyXG5cclxuICBwdWJsaWMgZHJvcGRvd25WaXNpYmxlID0gZmFsc2U7XHJcbiAgcHVibGljIGlzTG9hZGluZyA9IGZhbHNlO1xyXG5cclxuICBwdWJsaWMgZmlsdGVyZWRMaXN0OiBhbnlbXSA9IFtdO1xyXG4gIHB1YmxpYyBtaW5DaGFyc0VudGVyZWQgPSBmYWxzZTtcclxuICBwdWJsaWMgaXRlbUluZGV4OiBudW1iZXIgPSBudWxsO1xyXG4gIHB1YmxpYyBrZXl3b3JkOiBzdHJpbmc7XHJcblxyXG4gIHByaXZhdGUgZWw6IEhUTUxFbGVtZW50OyAgICAgICAgICAgLy8gdGhpcyBjb21wb25lbnQgIGVsZW1lbnQgYDxuZ3VpLWF1dG8tY29tcGxldGU+YFxyXG4gIHByaXZhdGUgdGltZXIgPSAwO1xyXG5cclxuICBwcml2YXRlIGRlbGF5ID0gKCgpID0+IHtcclxuICAgIGxldCB0aW1lciA9IG51bGw7XHJcbiAgICByZXR1cm4gKGNhbGxiYWNrOiBhbnksIG1zOiBudW1iZXIpID0+IHtcclxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcclxuICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KGNhbGxiYWNrLCBtcyk7XHJcbiAgICB9O1xyXG4gIH0pKCk7XHJcbiAgcHJpdmF0ZSBzZWxlY3RPbkVudGVyID0gZmFsc2U7XHJcblxyXG4gIC8qKlxyXG4gICAqIGNvbnN0cnVjdG9yXHJcbiAgICovXHJcbiAgY29uc3RydWN0b3IoZWxlbWVudFJlZjogRWxlbWVudFJlZiwgcHVibGljIGF1dG9Db21wbGV0ZTogTmd1aUF1dG9Db21wbGV0ZSkge1xyXG4gICAgdGhpcy5lbCA9IGVsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIHVzZXIgZW50ZXJzIGludG8gaW5wdXQgZWwsIHNob3dzIGxpc3QgdG8gc2VsZWN0LCB0aGVuIHNlbGVjdCBvbmVcclxuICAgKi9cclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMuYXV0b0NvbXBsZXRlLnNvdXJjZSA9IHRoaXMuc291cmNlO1xyXG4gICAgdGhpcy5hdXRvQ29tcGxldGUucGF0aFRvRGF0YSA9IHRoaXMucGF0aFRvRGF0YTtcclxuICAgIHRoaXMuYXV0b0NvbXBsZXRlLmxpc3RGb3JtYXR0ZXIgPSB0aGlzLmxpc3RGb3JtYXR0ZXI7XHJcbiAgICBpZiAodGhpcy5hdXRvU2VsZWN0Rmlyc3RJdGVtKSB7XHJcbiAgICAgIHRoaXMuaXRlbUluZGV4ID0gMDtcclxuICAgIH1cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICBpZiAodGhpcy5hdXRvQ29tcGxldGVJbnB1dCAmJiB0aGlzLnJlRm9jdXNBZnRlclNlbGVjdCkge1xyXG4gICAgICAgIHRoaXMuYXV0b0NvbXBsZXRlSW5wdXQubmF0aXZlRWxlbWVudC5mb2N1cygpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLnNob3dEcm9wZG93bk9uSW5pdCkge1xyXG4gICAgICAgIHRoaXMuc2hvd0Ryb3Bkb3duTGlzdCh7dGFyZ2V0OiB7dmFsdWU6ICcnfX0pO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBpc1NyY0FycigpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBBcnJheS5pc0FycmF5KHRoaXMuc291cmNlKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyByZWxvYWRMaXN0SW5EZWxheSA9IChldnQ6IGFueSk6IHZvaWQgPT4ge1xyXG4gICAgY29uc3QgZGVsYXlNcyA9IHRoaXMuaXNTcmNBcnIoKSA/IDEwIDogNTAwO1xyXG4gICAgY29uc3Qga2V5d29yZCA9IGV2dC50YXJnZXQudmFsdWU7XHJcblxyXG4gICAgLy8gZXhlY3V0aW5nIGFmdGVyIHVzZXIgc3RvcHBlZCB0eXBpbmdcclxuICAgIHRoaXMuZGVsYXkoKCkgPT4gdGhpcy5yZWxvYWRMaXN0KGtleXdvcmQpLCBkZWxheU1zKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzaG93RHJvcGRvd25MaXN0KGV2ZW50OiBhbnkpOiB2b2lkIHtcclxuICAgIHRoaXMuZHJvcGRvd25WaXNpYmxlID0gdHJ1ZTtcclxuICAgIHRoaXMucmVsb2FkTGlzdChldmVudC50YXJnZXQudmFsdWUpO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGhpZGVEcm9wZG93bkxpc3QoKTogdm9pZCB7XHJcbiAgICB0aGlzLnNlbGVjdE9uRW50ZXIgPSBmYWxzZTtcclxuICAgIHRoaXMuZHJvcGRvd25WaXNpYmxlID0gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZmluZEl0ZW1Gcm9tU2VsZWN0VmFsdWUoc2VsZWN0VGV4dDogc3RyaW5nKTogYW55IHtcclxuICAgIGNvbnN0IG1hdGNoaW5nSXRlbXMgPSB0aGlzLmZpbHRlcmVkTGlzdC5maWx0ZXIoKGl0ZW0pID0+ICgnJyArIGl0ZW0pID09PSBzZWxlY3RUZXh0KTtcclxuICAgIHJldHVybiBtYXRjaGluZ0l0ZW1zLmxlbmd0aCA/IG1hdGNoaW5nSXRlbXNbMF0gOiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHJlbG9hZExpc3Qoa2V5d29yZDogc3RyaW5nKTogdm9pZCB7XHJcblxyXG4gICAgdGhpcy5maWx0ZXJlZExpc3QgPSBbXTtcclxuICAgIGlmIChrZXl3b3JkLmxlbmd0aCA8ICh0aGlzLm1pbkNoYXJzIHx8IDApKSB7XHJcbiAgICAgIHRoaXMubWluQ2hhcnNFbnRlcmVkID0gZmFsc2U7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMubWluQ2hhcnNFbnRlcmVkID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5pc1NyY0FycigpKSB7ICAgIC8vIGxvY2FsIHNvdXJjZVxyXG4gICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmZpbHRlcmVkTGlzdCA9IHRoaXMuYXV0b0NvbXBsZXRlLmZpbHRlcih0aGlzLnNvdXJjZSwga2V5d29yZCwgdGhpcy5tYXRjaEZvcm1hdHRlZCwgdGhpcy5pZ25vcmVBY2NlbnRzKTtcclxuICAgICAgaWYgKHRoaXMubWF4TnVtTGlzdCkge1xyXG4gICAgICAgIHRoaXMuZmlsdGVyZWRMaXN0ID0gdGhpcy5maWx0ZXJlZExpc3Quc2xpY2UoMCwgdGhpcy5tYXhOdW1MaXN0KTtcclxuICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSB7ICAgICAgICAgICAgICAgICAvLyByZW1vdGUgc291cmNlXHJcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcclxuXHJcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5zb3VyY2UgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAvLyBjdXN0b20gZnVuY3Rpb24gdGhhdCByZXR1cm5zIG9ic2VydmFibGVcclxuICAgICAgICB0aGlzLnNvdXJjZShrZXl3b3JkKS5zdWJzY3JpYmUoXHJcbiAgICAgICAgICAocmVzcCkgPT4ge1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMucGF0aFRvRGF0YSkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHBhdGhzID0gdGhpcy5wYXRoVG9EYXRhLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgICAgICAgcGF0aHMuZm9yRWFjaCgocHJvcCkgPT4gcmVzcCA9IHJlc3BbcHJvcF0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmZpbHRlcmVkTGlzdCA9IHJlc3A7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLm1heE51bUxpc3QpIHtcclxuICAgICAgICAgICAgICB0aGlzLmZpbHRlcmVkTGlzdCA9IHRoaXMuZmlsdGVyZWRMaXN0LnNsaWNlKDAsIHRoaXMubWF4TnVtTGlzdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICAoZXJyb3IpID0+IG51bGwsXHJcbiAgICAgICAgICAoKSA9PiB0aGlzLmlzTG9hZGluZyA9IGZhbHNlIC8vIGNvbXBsZXRlXHJcbiAgICAgICAgKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyByZW1vdGUgc291cmNlXHJcblxyXG4gICAgICAgIHRoaXMuYXV0b0NvbXBsZXRlLmdldFJlbW90ZURhdGEoa2V5d29yZCkuc3Vic2NyaWJlKChyZXNwKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyZWRMaXN0ID0gcmVzcCA/IHJlc3AgOiBbXTtcclxuICAgICAgICAgICAgaWYgKHRoaXMubWF4TnVtTGlzdCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuZmlsdGVyZWRMaXN0ID0gdGhpcy5maWx0ZXJlZExpc3Quc2xpY2UoMCwgdGhpcy5tYXhOdW1MaXN0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIChlcnJvcikgPT4gbnVsbCxcclxuICAgICAgICAgICgpID0+IHRoaXMuaXNMb2FkaW5nID0gZmFsc2UgLy8gY29tcGxldGVcclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2VsZWN0T25lKGRhdGE6IGFueSkge1xyXG4gICAgaWYgKCEhZGF0YSB8fCBkYXRhID09PSAnJykge1xyXG4gICAgICB0aGlzLnZhbHVlU2VsZWN0ZWQuZW1pdChkYXRhKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuY3VzdG9tU2VsZWN0ZWQuZW1pdCh0aGlzLmtleXdvcmQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIGVudGVyVGV4dChkYXRhOiBhbnkpIHtcclxuICAgIHRoaXMudGV4dEVudGVyZWQuZW1pdChkYXRhKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBibHVySGFuZGxlcihldnQ6IGFueSkge1xyXG4gICAgaWYgKHRoaXMuc2VsZWN0T25CbHVyKSB7XHJcbiAgICAgIHRoaXMuc2VsZWN0T25lKHRoaXMuZmlsdGVyZWRMaXN0W3RoaXMuaXRlbUluZGV4XSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5oaWRlRHJvcGRvd25MaXN0KCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgaW5wdXRFbEtleUhhbmRsZXIgPSAoZXZ0OiBhbnkpID0+IHtcclxuICAgIGNvbnN0IHRvdGFsTnVtSXRlbSA9IHRoaXMuZmlsdGVyZWRMaXN0Lmxlbmd0aDtcclxuXHJcbiAgICBpZiAoIXRoaXMuc2VsZWN0T25FbnRlciAmJiB0aGlzLmF1dG9TZWxlY3RGaXJzdEl0ZW0gJiYgKDAgIT09IHRvdGFsTnVtSXRlbSkpIHtcclxuICAgICAgdGhpcy5zZWxlY3RPbkVudGVyID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBzd2l0Y2ggKGV2dC5rZXlDb2RlKSB7XHJcbiAgICAgIGNhc2UgMjc6IC8vIEVTQywgaGlkZSBhdXRvIGNvbXBsZXRlXHJcbiAgICAgICAgdGhpcy5zZWxlY3RPbkVudGVyID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RPbmUodW5kZWZpbmVkKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgMzg6IC8vIFVQLCBzZWxlY3QgdGhlIHByZXZpb3VzIGxpIGVsXHJcbiAgICAgICAgaWYgKDAgPT09IHRvdGFsTnVtSXRlbSkge1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNlbGVjdE9uRW50ZXIgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuaXRlbUluZGV4ID0gKHRvdGFsTnVtSXRlbSArIHRoaXMuaXRlbUluZGV4IC0gMSkgJSB0b3RhbE51bUl0ZW07XHJcbiAgICAgICAgdGhpcy5zY3JvbGxUb1ZpZXcodGhpcy5pdGVtSW5kZXgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSA0MDogLy8gRE9XTiwgc2VsZWN0IHRoZSBuZXh0IGxpIGVsIG9yIHRoZSBmaXJzdCBvbmVcclxuICAgICAgICBpZiAoMCA9PT0gdG90YWxOdW1JdGVtKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2VsZWN0T25FbnRlciA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5kcm9wZG93blZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIGxldCBzdW0gPSB0aGlzLml0ZW1JbmRleDtcclxuICAgICAgICBzdW0gPSAodGhpcy5pdGVtSW5kZXggPT09IG51bGwpID8gMCA6IHN1bSArIDE7XHJcbiAgICAgICAgdGhpcy5pdGVtSW5kZXggPSAodG90YWxOdW1JdGVtICsgc3VtKSAlIHRvdGFsTnVtSXRlbTtcclxuICAgICAgICB0aGlzLnNjcm9sbFRvVmlldyh0aGlzLml0ZW1JbmRleCk7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlIDEzOiAvLyBFTlRFUiwgY2hvb3NlIGl0ISFcclxuICAgICAgICBpZiAodGhpcy5zZWxlY3RPbkVudGVyKSB7XHJcbiAgICAgICAgICB0aGlzLnNlbGVjdE9uZSh0aGlzLmZpbHRlcmVkTGlzdFt0aGlzLml0ZW1JbmRleF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgOTogLy8gVEFCLCBjaG9vc2UgaWYgdGFiLXRvLXNlbGVjdCBpcyBlbmFibGVkXHJcbiAgICAgICAgaWYgKHRoaXMudGFiVG9TZWxlY3QpIHtcclxuICAgICAgICAgIHRoaXMuc2VsZWN0T25lKHRoaXMuZmlsdGVyZWRMaXN0W3RoaXMuaXRlbUluZGV4XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHNjcm9sbFRvVmlldyhpbmRleCkge1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5hdXRvQ29tcGxldGVDb250YWluZXIubmF0aXZlRWxlbWVudDtcclxuICAgIGNvbnN0IHVsID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ3VsJyk7XHJcbiAgICBjb25zdCBsaSA9IHVsLnF1ZXJ5U2VsZWN0b3IoJ2xpJyk7ICAvLyBqdXN0IHNhbXBsZSB0aGUgZmlyc3QgbGkgdG8gZ2V0IGhlaWdodFxyXG4gICAgY29uc3QgbGlIZWlnaHQgPSBsaS5vZmZzZXRIZWlnaHQ7XHJcbiAgICBjb25zdCBzY3JvbGxUb3AgPSB1bC5zY3JvbGxUb3A7XHJcbiAgICBjb25zdCB2aWV3cG9ydCA9IHNjcm9sbFRvcCArIHVsLm9mZnNldEhlaWdodDtcclxuICAgIGNvbnN0IHNjcm9sbE9mZnNldCA9IGxpSGVpZ2h0ICogaW5kZXg7XHJcbiAgICBpZiAoc2Nyb2xsT2Zmc2V0IDwgc2Nyb2xsVG9wIHx8IChzY3JvbGxPZmZzZXQgKyBsaUhlaWdodCkgPiB2aWV3cG9ydCkge1xyXG4gICAgICB1bC5zY3JvbGxUb3AgPSBzY3JvbGxPZmZzZXQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgdHJhY2tCeUluZGV4KGluZGV4LCBpdGVtKSB7XHJcbiAgICByZXR1cm4gaW5kZXg7XHJcbiAgfVxyXG5cclxuICBnZXQgZW1wdHlMaXN0KCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICEoXHJcbiAgICAgIHRoaXMuaXNMb2FkaW5nIHx8XHJcbiAgICAgICh0aGlzLm1pbkNoYXJzRW50ZXJlZCAmJiAhdGhpcy5pc0xvYWRpbmcgJiYgIXRoaXMuZmlsdGVyZWRMaXN0Lmxlbmd0aCkgfHxcclxuICAgICAgKHRoaXMuZmlsdGVyZWRMaXN0Lmxlbmd0aClcclxuICAgICk7XHJcbiAgfVxyXG5cclxufVxyXG4iXX0=
