!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("sax"),require("url"),require("buffer"),require("crypto-js/sha1"),require("crypto-js/enc-base64"),require("assert"),require("lodash"),require("uuid/v4"),require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("ngx-soap",["exports","sax","url","buffer","crypto-js/sha1","crypto-js/enc-base64","assert","lodash","uuid/v4","rxjs","rxjs/operators","@angular/core","@angular/common/http"],t):t(e["ngx-soap"]={},e.sax,e.url,e.buffer,e.sha1,e.Base64,e.assert,e._,e.uuid4,e.rxjs,e.rxjs.operators,e.ng.core,e.ng.common.http)}(this,function(e,i,c,o,r,a,$,O,T,C,N,t,s){"use strict";function u(e,r,a,p){return new(a=a||Promise)(function(t,s){function n(e){try{o(p.next(e))}catch(t){s(t)}}function i(e){try{o(p["throw"](e))}catch(t){s(t)}}function o(e){e.done?t(e.value):function s(t){return t instanceof a?t:new a(function(e){e(t)})}(e.value).then(n,i)}o((p=p.apply(e,r||[])).next())})}function l(n,i){var o,r,a,e,p={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function s(e){if(o)throw new TypeError("Generator is already executing.");for(;p;)try{if(o=1,r&&(a=2&e[0]?r["return"]:e[0]?r["throw"]||((a=r["return"])&&a.call(r),0):r.next)&&!(a=a.call(r,e[1])).done)return a;switch(r=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return p.label++,{value:e[1],done:!1};case 5:p.label++,r=e[1],e=[0];continue;case 7:e=p.ops.pop(),p.trys.pop();continue;default:if(!(a=0<(a=p.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){p=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){p.label=e[1];break}if(6===e[0]&&p.label<a[1]){p.label=a[1],a=e;break}if(a&&p.label<a[2]){p.label=a[2],p.ops.push(e);break}a[2]&&p.ops.pop(),p.trys.pop();continue}e=i.call(n,p)}catch(t){e=[6,t],r=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}r=r&&r.hasOwnProperty("default")?r["default"]:r,a=a&&a.hasOwnProperty("default")?a["default"]:a,T=T&&T.hasOwnProperty("default")?T["default"]:T;var n=function _e(e){if(this.getNamespaceURI=function(e,t){switch(e){case"xml":return"http://www.w3.org/XML/1998/namespace";case"xmlns":return"http://www.w3.org/2000/xmlns/";default:var s=this.namespaces[e];return null!=s?s.uri:!t&&this.parent?this.parent.getNamespaceURI(e):null}},this.getNamespaceMapping=function(e){switch(e){case"xml":return{uri:"http://www.w3.org/XML/1998/namespace",prefix:"xml",declared:!0};case"xmlns":return{uri:"http://www.w3.org/2000/xmlns/",prefix:"xmlns",declared:!0};default:var t=this.namespaces[e];return null!=t?t:this.parent?this.parent.getNamespaceMapping(e):null}},this.getPrefix=function(e,t){switch(e){case"http://www.w3.org/XML/1998/namespace":return"xml";case"http://www.w3.org/2000/xmlns/":return"xmlns";default:for(var s in this.namespaces)if(this.namespaces[s].uri===e)return s;return!t&&this.parent?this.parent.getPrefix(e):null}},!(this instanceof _e))return new _e(e);this.parent=e,this.namespaces={}},X=function je(){if(this.addNamespace=function(e,t,s){return this.getNamespaceURI(e,s)!==t&&!!this.currentScope&&(this.currentScope.namespaces[e]={uri:t,prefix:e,declared:!1},!0)},this.pushContext=function(){var e=new n(this.currentScope);return this.scopes.push(e),this.currentScope=e},this.popContext=function(){var e=this.scopes.pop();return this.currentScope=e?e.parent:null,e},this.getNamespaceURI=function(e,t){return this.currentScope&&this.currentScope.getNamespaceURI(e,t)},this.getPrefix=function(e,t){return this.currentScope&&this.currentScope.getPrefix(e,t)},this.registerNamespace=function(e){var t=this.getPrefix(e);if(t)return t;for(;t="ns"+ ++this.prefixCount,this.getNamespaceURI(t););return this.addNamespace(t,e,!0),t},this.declareNamespace=function(e,t){if(this.currentScope){var s=this.currentScope.getNamespaceMapping(e);return!(s&&s.uri===t&&s.declared||(this.currentScope.namespaces[e]={uri:t,prefix:e,declared:!0},0))}return!1},!(this instanceof je))return new je;this.scopes=[],this.pushContext(),this.prefixCount=0},p=function p(e,t,s){var n=new o.Buffer(e||"","base64").toString("binary");return a.stringify(r(n+t+s,""))},h="__tns__",_=function(e,t){for(var s in e)if(s!==h&&e[s]===t)return s},D=h,d=_,y={string:1,"boolean":1,decimal:1,"float":1,"double":1,anyType:1,"byte":1,"int":1,"long":1,"short":1,negativeInteger:1,nonNegativeInteger:1,positiveInteger:1,nonPositiveInteger:1,unsignedByte:1,unsignedInt:1,unsignedLong:1,unsignedShort:1,duration:0,dateTime:0,time:0,date:0,gYearMonth:0,gYear:0,gMonthDay:0,gDay:0,gMonth:0,hexBinary:0,base64Binary:0,anyURI:0,QName:0,NOTATION:0};function q(e){var t="string"==typeof e?e.indexOf(":"):-1;return t<0?{prefix:D,name:e}:{prefix:e.substring(0,t),name:e.substring(t+1)}}function U(e){return"string"!=typeof e||"<![CDATA["===e.substr(0,9)&&"]]>"===e.substr(-3)?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}var f=/^[\s\xA0]+/,m=/[\s\xA0]+$/;function v(e){return e.replace(f,"").replace(m,"")}var g=function(e,t,s){var n=q(e);for(var i in this.nsName=e,this.prefix=n.prefix,this.name=n.name,this.children=[],this.xmlns={},this._initializeOptions(s),t){var o=/^xmlns:?(.*)$/.exec(i);o?this.xmlns[o[1]?o[1]:D]=t[i]:"value"===i?this[this.valueKey]=t[i]:this["$"+i]=t[i]}this.$targetNamespace!==undefined&&(this.xmlns[D]=this.$targetNamespace)};g.prototype._initializeOptions=function(e){e?(this.valueKey=e.valueKey||"$value",this.xmlKey=e.xmlKey||"$xml",this.ignoredNamespaces=e.ignoredNamespaces||[]):(this.valueKey="$value",this.xmlKey="$xml",this.ignoredNamespaces=[])},g.prototype.deleteFixedAttrs=function(){this.children&&0===this.children.length&&delete this.children,this.xmlns&&0===Object.keys(this.xmlns).length&&delete this.xmlns,delete this.nsName,delete this.prefix,delete this.name},g.prototype.allowedChildren=[],g.prototype.startElement=function(e,t,s,n){if(this.allowedChildren){var i=this.allowedChildren[q(t).name];i?e.push(new i(t,s,n)):this.unexpected(t)}},g.prototype.endElement=function(e,t){if(this.nsName===t){if(e.length<2)return;var s=e[e.length-2];this!==e[0]&&(O.defaultsDeep(e[0].xmlns,this.xmlns),s.children.push(this),s.addChild(this)),e.pop()}},g.prototype.addChild=function(e){},g.prototype.unexpected=function(e){throw new Error("Found unexpected element ("+e+") inside "+this.nsName)},g.prototype.description=function(e){return this.$name||this.name},g.prototype.init=function(){},g.createSubClass=function(){var e=this,t=function(){e.apply(this,arguments),this.init()};return t.prototype.__proto__=e.prototype,t};var x=g.createSubClass(),b=g.createSubClass(),w=g.createSubClass(),S=g.createSubClass(),j=g.createSubClass(),A=g.createSubClass(),E=g.createSubClass(),P=g.createSubClass(),L=g.createSubClass(),k=g.createSubClass(),M=g.createSubClass(),H=g.createSubClass(),I=g.createSubClass(),F=g.createSubClass(),B=g.createSubClass(),K=g.createSubClass(),R=g.createSubClass(),z=g.createSubClass(),W=g.createSubClass(),Y=g.createSubClass(),G=g.createSubClass(),J=g.createSubClass(),Q=g.createSubClass(),Z=g.createSubClass(),V={types:[z,"schema documentation"],schema:[R,"element complexType simpleType include import"],element:[x,"annotation complexType"],any:[b,""],simpleType:[j,"restriction"],restriction:[A,"enumeration all choice sequence"],extension:[E,"all sequence choice"],choice:[P,"element sequence choice any"],enumeration:[L,""],complexType:[k,"annotation sequence all complexContent simpleContent choice"],complexContent:[M,"extension"],simpleContent:[H,"extension"],sequence:[I,"element sequence choice any"],all:[F,"element choice"],service:[Q,"port documentation"],port:[J,"address documentation"],binding:[G,"_binding SecuritySpec operation documentation"],portType:[Y,"operation documentation"],message:[B,"part documentation"],operation:[W,"documentation input output fault _operation"],input:[w,"body SecuritySpecRef documentation header"],output:[S,"body SecuritySpecRef documentation header"],fault:[g,"_fault documentation"],definitions:[Z,"types message portType binding service import documentation"],documentation:[K,""]};function ee(e){var t={};return(e=e.split(" ")).forEach(function(e){t[e.replace(/^_/,"")]=(V[e]||[g])[0]}),t}for(var te in V){var se=V[te];se[0].prototype.allowedChildren=ee(se[1])}B.prototype.init=function(){this.element=null,this.parts=null},R.prototype.init=function(){this.complexTypes={},this.types={},this.elements={},this.includes=[]},z.prototype.init=function(){this.schemas={}},W.prototype.init=function(){this.input=null,this.output=null,this.inputSoap=null,this.outputSoap=null,this.style="",this.soapAction=""},Y.prototype.init=function(){this.methods={}},G.prototype.init=function(){this.transport="",this.style="",this.methods={}},J.prototype.init=function(){this.location=null},Q.prototype.init=function(){this.ports={}},Z.prototype.init=function(){"definitions"!==this.name&&this.unexpected(this.nsName),this.messages={},this.portTypes={},this.bindings={},this.services={},this.schemas={}},K.prototype.init=function(){},R.prototype.merge=function(e){return $.ok(e instanceof R),this.$targetNamespace===e.$targetNamespace&&(O.merge(this.complexTypes,e.complexTypes),O.merge(this.types,e.types),O.merge(this.elements,e.elements),O.merge(this.xmlns,e.xmlns)),this},R.prototype.addChild=function(e){if(!(e.$name in y)){if("include"===e.name||"import"===e.name){var t=e.$schemaLocation||e.$location;t&&this.includes.push({namespace:e.$namespace||e.$targetNamespace||this.$targetNamespace,location:t})}else"complexType"===e.name?this.complexTypes[e.$name]=e:"element"===e.name?this.elements[e.$name]=e:e.$name&&(this.types[e.$name]=e);this.children.pop()}},z.prototype.addChild=function(e){$.ok(e instanceof R);var t=e.$targetNamespace;this.schemas.hasOwnProperty(t)?console.error('Target-Namespace "'+t+'" already in use by another Schema!'):this.schemas[t]=e},w.prototype.addChild=function(e){"body"===e.name&&(this.use=e.$use,"encoded"===this.use&&(this.encodingStyle=e.$encodingStyle),this.children.pop())},S.prototype.addChild=function(e){"body"===e.name&&(this.use=e.$use,"encoded"===this.use&&(this.encodingStyle=e.$encodingStyle),this.children.pop())},W.prototype.addChild=function(e){"operation"===e.name&&(this.soapAction=e.$soapAction||"",this.style=e.$style||"",this.children.pop())},G.prototype.addChild=function(e){"binding"===e.name&&(this.transport=e.$transport,this.style=e.$style,this.children.pop())},J.prototype.addChild=function(e){"address"===e.name&&"undefined"!=typeof e.$location&&(this.location=e.$location)},Z.prototype.addChild=function(e){var t=this;e instanceof z?O.merge(t.schemas,e.schemas):e instanceof B?t.messages[e.$name]=e:"import"===e.name?(t.schemas[e.$namespace]=new R(e.$namespace,{}),t.schemas[e.$namespace].addChild(e)):e instanceof Y?t.portTypes[e.$name]=e:e instanceof G?"http://schemas.xmlsoap.org/soap/http"!==e.transport&&"http://www.w3.org/2003/05/soap/bindings/HTTP/"!==e.transport||(t.bindings[e.$name]=e):e instanceof Q&&(t.services[e.$name]=e),this.children.pop()},B.prototype.postProcess=function(e){var t=null,s=undefined,n=this.children||[],i=undefined,o=undefined,r=undefined,a=undefined;for(r in n)if("part"===(s=n[r]).name){t=s;break}if(t){if(t.$element){var p,c=[];delete this.parts,i=(o=q(t.$element)).prefix;var u=e.schemas[e.xmlns[i]];if(this.element=u.elements[o.name],!this.element)return;if(this.element.targetNSAlias=i,this.element.targetNamespace=e.xmlns[i],this.element.$lookupType=t.$element,0<(p=this.element.children).length)for(r=0;r<p.length;r++)c.push(this._getNestedLookupTypeString(p[r]));if(0<c.length){c=c.join("_").split("_").filter(function(e){return"^"!==e});var l=e.schemas[this.element.targetNamespace].xmlns;for(r=0;r<c.length;r++)c[r]=this._createLookupTypeObject(c[r],l)}if(this.element.$lookupTypes=c,this.element.$type){a=q(this.element.$type);var h=u.xmlns&&u.xmlns[a.prefix]||e.xmlns[a.prefix];if(h&&!(a.name in y)){var d=(u=e.schemas[h]).complexTypes[a.name]||u.types[a.name]||u.elements[a.name];d&&(this.parts=d.description(e,u.xmlns))}}else{var f=this.element.description(e,u.xmlns);this.parts=f[o.name]}this.children.splice(0,1)}else for(this.parts={},delete this.element,r=0;t=this.children[r];r++)if("documentation"!==t.name){$.ok("part"===t.name,"Expected part element"),o=q(t.$type),i=e.xmlns[o.prefix],a=o.name;var m=e.schemas[i];this.parts[t.$name]=void 0!==m?e.schemas[i].types[a]||e.schemas[i].complexTypes[a]:t.$type,"object"==typeof this.parts[t.$name]&&(this.parts[t.$name].prefix=o.prefix,this.parts[t.$name].xmlns=i),this.children.splice(r--,1)}this.deleteFixedAttrs()}},B.prototype._createLookupTypeObject=function(e,t){var s=q(e),n=s.prefix,i=s.name.split("#"),o=i[0],r=i[1],a={};return a.$namespace=t[n],a.$type=n+":"+o,a.$name=r,a},B.prototype._getNestedLookupTypeString=function(e){var s="^",t=this.ignoredNamespaces.concat("xs");if(e.hasOwnProperty("$type")&&"string"==typeof e.$type&&-1===t.indexOf(e.$type.split(":")[0])&&(s+="_"+e.$type+"#"+e.$name),0<e.children.length){var n=this;e.children.forEach(function(e){var t=n._getNestedLookupTypeString(e).replace(/\^_/,"");t&&"string"==typeof t&&(s+="_"+t)})}return s},W.prototype.postProcess=function(e,t){for(var s=this.children,n=0,i=void 0;i=s[n];n++)if("input"===i.name||"output"===i.name)if("binding"!==t){var o=q(i.$message).name,r=e.messages[o];r.postProcess(e),r.element?(e.messages[r.element.$name]=r,this[i.name]=r.element):this[i.name]=r,s.splice(n--,1)}else this[i.name]=i,s.splice(n--,1);this.deleteFixedAttrs()},Y.prototype.postProcess=function(e){var t=this.children;if(void 0!==t){for(var s=0,n=void 0;n=t[s];s++)"operation"===n.name&&(n.postProcess(e,"portType"),this.methods[n.$name]=n,t.splice(s--,1));delete this.$name,this.deleteFixedAttrs()}},G.prototype.postProcess=function(e){var t=q(this.$type).name,s=e.portTypes[t],n=this.style,i=this.children;if(s){s.postProcess(e),this.methods=s.methods;for(var o=0,r=void 0;r=i[o];o++)if("operation"===r.name){r.postProcess(e,"binding"),i.splice(o--,1),r.style||(r.style=n);var a=this.methods[r.$name];a&&(a.style=r.style,a.soapAction=r.soapAction,a.inputSoap=r.input||null,a.outputSoap=r.output||null,a.inputSoap&&a.inputSoap.deleteFixedAttrs(),a.outputSoap&&a.outputSoap.deleteFixedAttrs())}}delete this.$name,delete this.$type,this.deleteFixedAttrs()},Q.prototype.postProcess=function(e){var t=this.children,s=e.bindings;if(t&&0<t.length)for(var n=0,i=void 0;i=t[n];n++)if("port"===i.name){var o=s[q(i.$binding).name];o&&(o.postProcess(e),this.ports[i.$name]={location:i.location,binding:o},t.splice(n--,1))}delete this.$name,this.deleteFixedAttrs()},j.prototype.description=function(e){for(var t=this.children,s=0,n=void 0;n=t[s];s++)if(n instanceof A)return this.$name+"|"+n.description();return{}},A.prototype.description=function(e,t){for(var s,n=this.children,i=0,o=void 0;o=n[i];i++)if(o instanceof I||o instanceof P){s=o.description(e,t);break}if(s&&this.$base){var r=q(this.$base),a=r.name,p=t&&t[r.prefix]||e.xmlns[r.prefix],c=e.schemas[p],u=c&&(c.complexTypes[a]||c.types[a]||c.elements[a]);return s.getBase=function(){return u.description(e,c.xmlns)},s}return(this.$base?this.$base+"|":"")+this.children.map(function(e){return e.description()}).join(",")},E.prototype.description=function(e,t){for(var s=this.children,n={},i=0,o=void 0;o=s[i];i++)(o instanceof I||o instanceof P)&&(n=o.description(e,t));if(this.$base){var r=q(this.$base),a=r.name,p=t&&t[r.prefix]||e.xmlns[r.prefix],c=e.schemas[p];if(a in y)return this.$base;var u=c&&(c.complexTypes[a]||c.types[a]||c.elements[a]);if(u){var l=u.description(e,c.xmlns);n=O.defaultsDeep(l,n)}}return n},L.prototype.description=function(){return this[this.valueKey]},k.prototype.description=function(e,t){for(var s=this.children||[],n=0,i=void 0;i=s[n];n++)if(i instanceof P||i instanceof I||i instanceof F||i instanceof H||i instanceof M)return i.description(e,t);return{}},M.prototype.description=function(e,t){for(var s=this.children,n=0,i=void 0;i=s[n];n++)if(i instanceof E)return i.description(e,t);return{}},H.prototype.description=function(e,t){for(var s=this.children,n=0,i=void 0;i=s[n];n++)if(i instanceof E)return i.description(e,t);return{}},x.prototype.description=function(e,t){var s={},n=this.$name,i=!!this.$maxOccurs&&(isNaN(this.$maxOccurs)?"unbounded"===this.$maxOccurs:1<this.$maxOccurs);this.$minOccurs!==this.$maxOccurs&&i&&(n+="[]"),t&&t[D]&&(this.$targetNamespace=t[D]);var o=this.$type||this.$ref;if(o){var r=(o=q(o)).name,a=t&&t[o.prefix]||e.xmlns[o.prefix],p=e.schemas[a],c=p&&(this.$type?p.complexTypes[r]||p.types[r]:p.elements[r]);if(a&&e.schemas[a]&&(t=e.schemas[a].xmlns),!c||r in y)s[n]=this.$type;else if(r in e.descriptions.types)this.$ref?s=e.descriptions.types[r]:s[n]=e.descriptions.types[r];else{var u={};e.descriptions.types[r]=u;var l=c.description(e,t);"string"==typeof l?u=l:Object.keys(l).forEach(function(e){u[e]=l[e]}),this.$ref?s=u:s[n]=u,"object"==typeof u&&(u.targetNSAlias=o.prefix,u.targetNamespace=a),e.descriptions.types[r]=u}}else{var h=this.children;s[n]={};for(var d=0,f=void 0;f=h[d];d++)f instanceof k&&(s[n]=f.description(e,t))}return s},F.prototype.description=I.prototype.description=function(e,t){for(var s=this.children,n={},i=0,o=void 0;o=s[i];i++)if(!(o instanceof b)){var r=o.description(e,t);for(var a in r)n[a]=r[a]}return n},P.prototype.description=function(e,t){for(var s=this.children,n={},i=0,o=void 0;o=s[i];i++){var r=o.description(e,t);for(var a in r)n[a]=r[a]}return n},B.prototype.description=function(e){if(this.element)return this.element&&this.element.description(e);var t={};return t[this.$name]=this.parts,t},Y.prototype.description=function(e){var t={};for(var s in this.methods){var n=this.methods[s];t[s]=n.description(e)}return t},W.prototype.description=function(e){var t=this.input?this.input.description(e):null,s=this.output?this.output.description(e):null;return{input:t&&t[Object.keys(t)[0]],output:s&&s[Object.keys(s)[0]]}},G.prototype.description=function(e){var t={};for(var s in this.methods){var n=this.methods[s];t[s]=n.description(e)}return t},Q.prototype.description=function(e){var t={};for(var s in this.ports){var n=this.ports[s];t[s]=n.binding.description(e)}return t};var ne=function(t,e,s){var n,i,h=this;if(this.uri=e,this.callback=function(){},this._includesWsdl=[],this.WSDL_CACHE=(s||{}).WSDL_CACHE||{},this._initializeOptions(s),"string"==typeof t)t=65279===(i=t).charCodeAt(0)?i.slice(1):i,n=this._fromXML;else{if("object"!=typeof t)throw new Error("WSDL letructor takes either an XML string or service definition");n=this._fromServices}Promise.resolve(!0).then(function(){try{n.call(h,t)}catch(e){return h.callback(e.message)}h.processIncludes().then(function(){h.definitions.deleteFixedAttrs();var e=h.services=h.definitions.services;if(e)for(var t in e)e[t].postProcess(h.definitions);var s=h.definitions.complexTypes;if(s)for(var n in s)s[n].deleteFixedAttrs();var i=h.definitions.bindings;for(var o in i){var r=i[o];if("undefined"==typeof r.style&&(r.style="document"),"document"===r.style){var a=r.methods,p=r.topElements={};for(var c in a)if(a[c].input){var u=a[c].input.$name,l="";a[c].output&&(l=a[c].output.$name),p[u]={methodName:c,outputName:l}}}}h.xmlnsInEnvelope=h._xmlnsMap(),h.callback(null,h)})["catch"](function(e){return h.callback(e)})})};function ie(e){return e&&":"!==e.charAt(e.length-1)?e+":":e}function oe(e){return e&&":"===e.charAt(e.length-1)?e.substring(0,e.length-1):e}function re(i,o){return u(this,void 0,void 0,function(){var s,n;return l(this,function(e){switch(e.label){case 0:return s=o.WSDL_CACHE||{},o.wsdl_headers,o.wsdl_options,[4,o.httpClient.get(i,{responseType:"text"}).toPromise()];case 1:return n=e.sent(),[4,new Promise(function(e){var t=new ne(n,i,o);(s[i]=t).WSDL_CACHE=s,t.onReady(e(t))})];case 2:return[2,e.sent()]}})})}function ae(e,t,s){this._username=e,this._password=t,this.defaults={},O.merge(this.defaults,s)}ne.prototype.ignoredNamespaces=["tns","targetNamespace","typedNamespace"],ne.prototype.ignoreBaseNameSpaces=!1,ne.prototype.valueKey="$value",ne.prototype.xmlKey="$xml",ne.prototype._initializeOptions=function(e){this._originalIgnoredNamespaces=(e||{}).ignoredNamespaces,this.options={};var t=e?e.ignoredNamespaces:null;t&&(Array.isArray(t.namespaces)||"string"==typeof t.namespaces)?t.override?this.options.ignoredNamespaces=t.namespaces:this.options.ignoredNamespaces=this.ignoredNamespaces.concat(t.namespaces):this.options.ignoredNamespaces=this.ignoredNamespaces,this.options.valueKey=e.valueKey||this.valueKey,this.options.xmlKey=e.xmlKey||this.xmlKey,e.escapeXML!==undefined?this.options.escapeXML=e.escapeXML:this.options.escapeXML=!0,e.returnFault!==undefined?this.options.returnFault=e.returnFault:this.options.returnFault=!1,this.options.handleNilAsNull=!!e.handleNilAsNull,e.namespaceArrayElements!==undefined?this.options.namespaceArrayElements=e.namespaceArrayElements:this.options.namespaceArrayElements=!0,this.options.wsdl_headers=e.wsdl_headers,this.options.wsdl_options=e.wsdl_options,e.httpClient&&(this.options.httpClient=e.httpClient),e.request&&(this.options.request=e.request);var s=e?e.ignoreBaseNameSpaces:null;this.options.ignoreBaseNameSpaces=null!=s?s:this.ignoreBaseNameSpaces,this.options.forceSoap12Headers=e.forceSoap12Headers,this.options.customDeserializer=e.customDeserializer,e.overrideRootElement!==undefined&&(this.options.overrideRootElement=e.overrideRootElement),this.options.useEmptyTag=!!e.useEmptyTag},ne.prototype.onReady=function(e){e&&(this.callback=e)},ne.prototype._processNextInclude=function(p){return u(this,void 0,void 0,function(){var t,n,o,r,a;return l(this,function(e){switch(e.label){case 0:return(t=this,n=p.shift())?((/^https?:/.test(t.uri)||/^https?:/.test(n.location))&&(r=c.resolve(t.uri||"",n.location)),(o=O.assign({},this.options)).ignoredNamespaces=this._originalIgnoredNamespaces||this.options.ignoredNamespaces,o.WSDL_CACHE=this.WSDL_CACHE,[4,function i(e,t){var s,n;if(n=t.WSDL_CACHE,s=n[e])return s;return re(e,t)}(r,o)]):[2];case 1:return a=e.sent(),t._includesWsdl.push(a),a.definitions instanceof Z?O.mergeWith(t.definitions,a.definitions,function(e,t){return e instanceof R?e.merge(t):undefined}):t.definitions.schemas[n.namespace||a.definitions.$targetNamespace]=function s(e,t){return O.mergeWith(e||{},t,function(e,t){return O.isArray(e)?e.concat(t):undefined})}(t.definitions.schemas[n.namespace||a.definitions.$targetNamespace],a.definitions),[2,t._processNextInclude(p)]}})})},ne.prototype.processIncludes=function(){return u(this,void 0,void 0,function(){var t,s,n,i;return l(this,function(e){for(n in t=this.definitions.schemas,s=[],t)i=t[n],s=s.concat(i.includes||[]);return[2,this._processNextInclude(s)]})})},ne.prototype.describeServices=function(){var e={};for(var t in this.services){var s=this.services[t];e[t]=s.description(this.definitions)}return e},ne.prototype.toXML=function(){return this.xml||""},ne.prototype.xmlToObject=function(e,s){var $,T=this,C="function"==typeof s?{}:i.parser(!0),N=null,p={},_=[{name:null,object:p,schema:{Envelope:{Header:{Security:{UsernameToken:{Username:"string",Password:"string"}}},Body:{Fault:{faultcode:"string",faultstring:"string",detail:"string"}}}}}],j={},A={};if(C.onopentag=function(e){var t,s,n=e.name,i=e.attributes,o=q(n).name,r=_[_.length-1],a=r.schema,p={},c=!1,u=!1,l={},h=o;if(!N&&"Body"===r.name&&"Fault"!==o){var d=T.definitions.messages[o];if(!d)try{var f=!1;/Response$/.test(o)?o=o.replace(/Response$/,""):/Request$/.test(o)?(f=!0,o=o.replace(/Request$/,"")):/Solicit$/.test(o)&&(f=!0,o=o.replace(/Solicit$/,""));var m=T.definitions.portTypes,y=m[Object.keys(m)[0]];o=f?y.methods[o].input.$name:y.methods[o].output.$name,d=T.definitions.messages[o],T.definitions.messages[h]=T.definitions.messages[o]}catch(S){T.options.returnFault&&C.onerror(S)}a=d.description(T.definitions),N=h}for(t in i.href&&($=i.href.substr(1),A[$]||(A[$]={hrefs:[],obj:null}),A[$].hrefs.push({par:r.object,key:o,obj:l})),($=i.id)&&(A[$]||(A[$]={hrefs:[],obj:null})),i)/^xmlns:|^xmlns$/.test(t)?j[q(t).name]=i[t]:(c=!0,p[t]=i[t]);for(t in p){var v=q(t);if("nil"===v.name&&"http://www.w3.org/2001/XMLSchema-instance"===j[v.prefix]&&p[t]&&("true"===p[t].toLowerCase()||"1"===p[t])){u=!0;break}}c&&(l[T.options.attributesKey]=p);var g=p["xsi:type"];if(g){var x=q(g),b=void 0;b=x.prefix===D?j[x.prefix]||j.xmlns:j[x.prefix];var w=T.findSchemaObject(b,x.name);w&&(s=w.description(T.definitions))}a&&a[o+"[]"]&&(o+="[]"),_.push({name:h,object:l,schema:s||a&&a[o],id:i.id,nil:u})},C.onclosetag=function(e){var t=_.pop(),s=t.object,n=_[_.length-1],i=n.object,o=n.schema,r=q(e).name;if("string"!=typeof t.schema||"string"!==t.schema&&"string"!==t.schema.split(":")[1]||"object"==typeof s&&0===Object.keys(s).length&&(s=t.object=""),!0===t.nil){if(!T.options.handleNilAsNull)return;s=null}O.isPlainObject(s)&&!Object.keys(s).length&&(s=null),o&&o[r+"[]"]?(i[r]||(i[r]=[]),i[r].push(s)):r in i?(Array.isArray(i[r])||(i[r]=[i[r]]),i[r].push(s)):i[r]=s,t.id&&(A[t.id].obj=s)},C.oncdata=function(e){var t=e;if((e=v(e)).length)if(/<\?xml[\s\S]+\?>/.test(e)){var s=_[_.length-1],n=T.xmlToObject(e);s.object[T.options.attributesKey]?s.object[T.options.valueKey]=n:s.object=n}else C.ontext(t)},C.onerror=function(e){throw C.resume(),{Fault:{faultcode:500,faultstring:"Invalid XML",detail:new Error(e).message,statusCode:500}}},C.ontext=function(e){var t=e;if((e=v(e)).length){var s,n=_[_.length-1],i=q(n.schema).name;s=T.options&&T.options.customDeserializer&&T.options.customDeserializer[i]?T.options.customDeserializer[i](e,n):"int"===i||"integer"===i?parseInt(e,10):"bool"===i||"boolean"===i?"true"===e.toLowerCase()||"1"===e:"dateTime"===i||"date"===i?new Date(e):(T.options.preserveWhitespace&&(e=t),"string"!=typeof n.object?e:n.object+e),n.object[T.options.attributesKey]?n.object[T.options.valueKey]=s:n.object=s}},"function"!=typeof s)return C.write(e).close(),n();var t=i.createStream(!0);return t.on("opentag",C.onopentag),t.on("closetag",C.onclosetag),t.on("cdata",C.oncdata),t.on("text",C.ontext),void e.pipe(t).on("error",function(e){s(e)}).on("end",function(){var e;try{e=n()}catch(t){return s(t)}s(null,e)});function n(){for(var e in A)for(var t=A[e],s=0;s<t.hrefs.length;s++)O.assign(t.hrefs[s].obj,t.obj);if(p.Envelope){var n=p.Envelope.Body;if(n&&n.Fault){var i=n.Fault.faultcode&&n.Fault.faultcode.$value,o=n.Fault.faultstring&&n.Fault.faultstring.$value,r=n.Fault.detail&&n.Fault.detail.$value;i=i||n.Fault.faultcode,o=o||n.Fault.faultstring,r=r||n.Fault.detail;var a=new Error(i+": "+o+(r?": "+r:""));throw a.root=p,a}return p.Envelope}return p}},ne.prototype.findSchemaObject=function(e,t){if(!e||!t)return null;var s=null;if(this.definitions.schemas){var n=this.definitions.schemas[e];n&&(-1!==t.indexOf(":")&&(t=t.substring(t.indexOf(":")+1,t.length)),s=n.complexTypes[t]||n.types[t]||n.elements[t])}return s},ne.prototype.objectToDocumentXML=function(e,t,s,n,i){if(t&&t._xml)return t._xml;var o={};o[e]=t;var r=i?this.findSchemaObject(n,i):null;return this.objectToXML(o,null,s,n,!0,null,r)},ne.prototype.objectToRpcXML=function(e,t,s,n,i){var o=[],r=this.definitions;for(var a in s=s||d(r.xmlns,n),n=n||r.xmlns[s],s=s===D?"":s+":",o.push(["<",s,e,">"].join("")),t)if(t.hasOwnProperty(a)&&"_xmlns"!==a){var p=t[a],c=(i?"":s)+a,u=[];if("object"==typeof p&&p.hasOwnProperty(this.options.attributesKey)){var l=p[this.options.attributesKey];for(var h in l)u.push(" "+h+'="'+l[h]+'"')}o.push(["<",c].concat(u).concat(">").join("")),o.push("object"==typeof p?this.objectToXML(p,a,s,n):U(p)),o.push(["</",c,">"].join(""))}return o.push(["</",s,e,">"].join("")),o.join("")},ne.prototype.isIgnoredNameSpace=function(e){return-1<this.options.ignoredNamespaces.indexOf(e)},ne.prototype.filterOutIgnoredNameSpace=function(e){var t=oe(e);return this.isIgnoredNameSpace(t)?"":t},ne.prototype.objectToXML=function(e,t,s,n,i,o,r,a){var p=this.definitions.schemas[n],c=s?s.parent:undefined;void 0!==c&&(s=s.current),c=oe(c),this.isIgnoredNameSpace(c)&&(c="");var u=!p,l=p&&"qualified"===p.$elementFormDefault,h=[],d=(s||l)&&s!==D,f="";n&&i&&(this.options.overrideRootElement&&this.options.overrideRootElement.xmlnsAttributes?this.options.overrideRootElement.xmlnsAttributes.forEach(function(e){f+=" "+e.name+'="'+e.value+'"'}):(d&&!this.isIgnoredNameSpace(s)&&(f+=" xmlns:"+s+'="'+n+'"'),(l||u)&&(f+=' xmlns="'+n+'"'))),a?a.pushContext():(a=new X).declareNamespace(s,n),!o||this.options.overrideRootElement&&this.options.overrideRootElement.xmlnsAttributes||(f=o);var m,y,v="";if(this.options.overrideRootElement&&i?v=this.options.overrideRootElement.namespace:d&&(l||i||u)&&!this.isIgnoredNameSpace(s)&&(v=s),Array.isArray(e)){var g="",x=!1;for((N=/^([^:]+):([^:]+)$/.exec(t))?(g=N[1],t=N[2]):":"===t[0]&&(x=!0,t=t.substr(1)),m=0,y=e.length;m<y;m++){var b=e[m],w=this.processAttributes(b,a),S=g||c||v,$=this.objectToXML(b,t,s,n,!1,null,r,a),T=["<",t,w,f];x||(T=["<",ie(S),t,w,f]),""===$&&this.options.useEmptyTag?(T.push(" />"),h.push(T.join(""))):(T.push(">"),!this.options.namespaceArrayElements&&0!==m||h.push(T.join("")),h.push($),!this.options.namespaceArrayElements&&m!==y-1||(x?h.push(["</",t,">"].join("")):h.push(["</",ie(S),t,">"].join(""))))}}else if("object"==typeof e){for(t in e)if(e.hasOwnProperty(t)&&t!==this.options.attributesKey){if(t===this.options.xmlKey)return a.popContext(),e[t];if(t===this.options.valueKey)return a.popContext(),U(e[t]);var C=e[t];if(void 0!==C){var N,_=this.processAttributes(C,a),j="",A=(g="",!1);if((N=/^([^:]+):([^:]+)$/.exec(t))?(g=N[1]+":",t=N[2]):":"===t[0]&&(A=!0,t=t.substr(1)),i)j=this.objectToXML(C,t,s,n,!1,null,r,a);else if(this.definitions.schemas)if(p){var O=this.findChildSchemaObject(r,t);if(O&&(O.$type&&-1===O.$type.indexOf("xsd:")||O.$ref||O.$name)){var E="",P="",L=void 0,k="",M=O.$ref||O.$name;if(M){P=(M=q(M)).name,M.prefix===D?(L=O.$targetNamespace,E=a.registerNamespace(L),this.isIgnoredNameSpace(E)&&(E=s)):(E=M.prefix,this.isIgnoredNameSpace(E)&&(E=s),L=p.xmlns[E]||this.definitions.xmlns[E]);var H=!1;O.$name&&O.targetNamespace===undefined&&(H="unqualified"===O.$form||"qualified"!==O.$form&&"qualified"!==p.$elementFormDefault),H&&(E=""),L&&E&&a.declareNamespace(E,L)&&(f+=k=" xmlns:"+E+'="'+L+'"')}var I=void 0;if(O.$type){var F=q(O.$type),B=F.prefix,K=p.xmlns[B]||this.definitions.xmlns[B];"http://www.w3.org/2001/XMLSchema"!==(L=K)&&B!==D&&a.addNamespace(B,K),I=this.findSchemaType(F.name,K)||O}else I=this.findSchemaObject(L,P)||O;O.$baseNameSpace&&this.options.ignoreBaseNameSpaces&&(E=s,L=n),this.options.ignoreBaseNameSpaces&&(L=E=""),v=E,Array.isArray(C)?E={current:E,parent:v}:k=null,j=this.objectToXML(C,t,E,L,!1,k,I,a)}else if(e[this.options.attributesKey]&&e[this.options.attributesKey].xsi_type){this.findChildSchemaObject(e[this.options.attributesKey].xsi_type.type,e[this.options.attributesKey].xsi_type.xmlns);g=e[this.options.attributesKey].xsi_type.prefix,a.addNamespace(e[this.options.attributesKey].xsi_type.prefix,e[this.options.attributesKey].xsi_type.xmlns),j=this.objectToXML(C,t,e[this.options.attributesKey].xsi_type.prefix,e[this.options.attributesKey].xsi_type.xmlns,!1,null,null,a)}else Array.isArray(C)&&(t=A?":"+t:g+t),j=this.objectToXML(C,t,g||s,n,!1,null,null,a)}else j=this.objectToXML(C,t,g||s,n,!1,null,null,a);v=oe(v),d&&!l&&i&&!this.options.overrideRootElement?v=s:this.isIgnoredNameSpace(v)&&(v="");var R=!j&&this.options.useEmptyTag;Array.isArray(C)||h.push(["<",A?"":ie(g||v),t,_,f,null===C?' xsi:nil="true"':"",R?" />":">"].join("")),R||(h.push(j),Array.isArray(C)||h.push(["</",A?"":ie(g||v),t,">"].join("")))}}}else e!==undefined&&h.push(this.options.escapeXML?U(e):e);return a.popContext(),h.join("")},ne.prototype.processAttributes=function(e,t){var s="";null===e&&(e=[]);var n=e[this.options.attributesKey];if(n&&n.xsi_type){var i=n.xsi_type,o=i.prefix||i.namespace;o?t.declareNamespace(o,i.xmlns):o=t.registerNamespace(i.xmlns),i.prefix=o}if(n)for(var r in n)if("xsi_type"!==r)s+=" "+r+'="'+U(n[r])+'"';else{var a=n[r];s+=' xsi:type="'+a.prefix+":"+a.type+'"',s+=" xmlns:"+a.prefix+'="'+a.xmlns+'"'}return s},ne.prototype.findSchemaType=function(e,t){if(!this.definitions.schemas||!e||!t)return null;var s=this.definitions.schemas[t];return s&&s.complexTypes?s.complexTypes[e]:null},ne.prototype.findChildSchemaObject=function(e,t,s){if(!e||!t)return null;if(0<=(s=s||[]).indexOf(e))return null;s=s.concat([e]);var n,i=null,o=0;if(Array.isArray(e.$lookupTypes)&&e.$lookupTypes.length){var r=e.$lookupTypes;for(o=0;o<r.length;o++){var a=r[o];if(a.$name===t){i=a;break}}}var p,c=e;if(c.$name===t&&"element"===c.name)return c;if(c.$ref&&q(c.$ref).name===t)return c;if(c.$type&&1===s.length){var u=q(c.$type);p=u.prefix===D?e.$targetNamespace:this.definitions.xmlns[u.prefix];var l=this.findSchemaType(u.name,p);if(l)return this.findChildSchemaObject(l,t,s)}if(c.children)for(o=0;(n=c.children[o])&&!(i=this.findChildSchemaObject(n,t,s));o++)if(n.$base){var h=q(n.$base),d=h.prefix===D?"":h.prefix;p=n.xmlns[h.prefix]||this.definitions.xmlns[h.prefix];var f=this.findSchemaType(h.name,p);if(f&&(i=this.findChildSchemaObject(f,t,s))){i.$baseNameSpace=d,i.$type=d+":"+t;break}}return i||c.$name!==t?i:c},ne.prototype._parse=function(e){var r=this,t=i.parser(!0),a=[],p=null,c=null,u=null,l=r.options;return t.onopentag=function(e){var t,s=e.name,n=e.attributes,i=a[a.length-1];if(i)try{i.startElement(a,s,n,l)}catch(o){if(r.options.strict)throw o;a.push(new g(s,n,l))}else if("definitions"===(t=q(s).name))p=new Z(s,n,l),a.push(p);else{if("schema"!==t)throw new Error("Unexpected root element of WSDL or include");p=new Z("definitions",{},{}),c=new z("types",{},{}),u=new R(s,n,l),c.addChild(u),p.addChild(c),a.push(u)}},t.onclosetag=function(e){var t=a[a.length-1];$.ok(t,"Unmatched close tag: "+e),t.endElement(a,e)},t.write(e).close(),p},ne.prototype._fromXML=function(e){this.definitions=this._parse(e),this.definitions.descriptions={types:{}},this.xml=e},ne.prototype._fromServices=function(e){},ne.prototype._xmlnsMap=function(){var e=this.definitions.xmlns,t="";for(var s in e)if(""!==s&&s!==D){var n=e[s];switch(n){case"http://xml.apache.org/xml-soap":case"http://schemas.xmlsoap.org/wsdl/":case"http://schemas.xmlsoap.org/wsdl/soap/":case"http://schemas.xmlsoap.org/wsdl/soap12/":case"http://schemas.xmlsoap.org/soap/encoding/":case"http://www.w3.org/2001/XMLSchema":continue}~n.indexOf("http://schemas.xmlsoap.org/")||~n.indexOf("http://www.w3.org/")||~n.indexOf("http://xml.apache.org/")||(t+=" xmlns:"+s+'="'+n+'"')}return t},ae.prototype.addHeaders=function(e){e.Authorization="Basic "+new o.Buffer(this._username+":"+this._password||"").toString("base64")},ae.prototype.toXML=function(){return""},ae.prototype.addOptions=function(e){O.merge(e,this.defaults)};var pe=["PasswordDigest","PasswordText"];function ce(e,t,s){s=s||{},this._username=e,this._password=t,"string"==typeof s?(this._passwordType=s||"PasswordText",s={}):this._passwordType=s.passwordType?s.passwordType:"PasswordText",-1===pe.indexOf(this._passwordType)&&(this._passwordType="PasswordText"),this._hasTimeStamp=!s.hasTimeStamp&&"boolean"!=typeof s.hasTimeStamp||!!s.hasTimeStamp,null!=s.hasNonce&&(this._hasNonce=!!s.hasNonce),this._hasTokenCreated=!s.hasTokenCreated&&"boolean"!=typeof s.hasTokenCreated||!!s.hasTokenCreated,null!=s.actor&&(this._actor=s.actor),null!=s.mustUnderstand&&(this._mustUnderstand=!!s.mustUnderstand)}function ue(e,t){this._token=e,this.defaults={},O.merge(this.defaults,t)}function le(e,t,s,n){"object"==typeof e?(this.defaults=e,this.defaults.ntlm=!0):this.defaults={ntlm:!0,username:e,password:t,domain:s,workstation:n}}ce.prototype.toXML=function(){function e(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"Z"}var t,s,n=new Date,i=e(n),o="";this._hasTimeStamp&&(o='<wsu:Timestamp wsu:Id="Timestamp-'+i+'"><wsu:Created>'+i+"</wsu:Created><wsu:Expires>"+e(new Date(n.getTime()+6e5))+"</wsu:Expires></wsu:Timestamp>");return!this._hasNonce&&"PasswordText"===this._passwordType||(s=a.stringify(r(i+Math.random(),""))),"PasswordText"===this._passwordType?(t='<wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">'+this._password+"</wsse:Password>",s&&(t+='<wsse:Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">'+s+"</wsse:Nonce>")):t='<wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest">'+p(s,i,this._password)+'</wsse:Password><wsse:Nonce EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">'+s+"</wsse:Nonce>","<wsse:Security "+(this._actor?'soap:actor="'+this._actor+'" ':"")+(this._mustUnderstand?'soap:mustUnderstand="1" ':"")+'xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">'+o+'<wsse:UsernameToken xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="SecurityToken-'+i+'"><wsse:Username>'+this._username+"</wsse:Username>"+t+(this._hasTokenCreated?"<wsu:Created>"+i+"</wsu:Created>":"")+"</wsse:UsernameToken></wsse:Security>"},ue.prototype.addHeaders=function(e){e.Authorization="Bearer "+this._token},ue.prototype.toXML=function(){return""},ue.prototype.addOptions=function(e){O.merge(e,this.defaults)},le.prototype.addHeaders=function(e){e.Connection="keep-alive"},le.prototype.toXML=function(){return""},le.prototype.addOptions=function(e){O.merge(e,this.defaults)};var he={BasicAuthSecurity:ae,BearerSecurity:ue,WSSecurity:ce,NTLMSecurity:le},de=(fe.prototype.build=function(e,n){var t=[];function i(e){return"number"==typeof e&&(e=e.toString()),t.push(e)}this.preambleCRLF&&i("\r\n"),e.forEach(function(t){var s="--"+n+"\r\n";Object.keys(t).forEach(function(e){"body"!==e&&(s+=e+": "+t[e]+"\r\n")}),i(s+="\r\n"),i(t.body),i("\r\n")}),i("--"+n+"--"),this.postambleCRLF&&i("\r\n");var s=t.map(function(e){return"string"==typeof e?e.length:e.byteLength}).reduce(function(e,t){return e+t},0),o=new Uint8Array(s),r=0;return t.forEach(function(e){if("string"==typeof e)for(var t=0;t<e.length;r++,t++)o[r]=255&e.charCodeAt(t);else for(t=0;t<e.byteLength;r++,t++)o[r]=e[t]}),o.buffer},fe);function fe(){this.preambleCRLF=!0,this.postambleCRLF=!0}var me=(ye.fromFormFiles=function(e){void 0===e&&(e=[]),e instanceof FileList&&(e=Array.from(e));var t=e.map(function(o){return new Promise(function(i){var e=new FileReader;e.readAsArrayBuffer(o),e.onload=function(e){var t=e.target.result,s=new Uint8Array(t),n=new ye(o.type,o.contentId||o.name,o.name,s);i(n)}})});return Promise.all(t)},ye);function ye(e,t,s,n){this.mimetype=e,this.contentId=t,this.name=s,this.body=n}var ve=/[^a-z$_0-9]/i,ge=function(e,t,s){s=s||{},this.wsdl=e,this._initializeOptions(s),this._initializeServices(t),this.httpClient=s.httpClient;s.overridePromiseSuffix&&s.overridePromiseSuffix};ge.prototype.addSoapHeader=function(e,t,s,n){return this.soapHeaders||(this.soapHeaders=[]),"object"==typeof e&&(e=this.wsdl.objectToXML(e,t,s,n,!0)),this.soapHeaders.push(e)-1},ge.prototype.changeSoapHeader=function(e,t,s,n,i){this.soapHeaders||(this.soapHeaders=[]),"object"==typeof t&&(t=this.wsdl.objectToXML(t,s,n,i,!0)),this.soapHeaders[e]=t},ge.prototype.getSoapHeaders=function(){return this.soapHeaders},ge.prototype.clearSoapHeaders=function(){this.soapHeaders=null},ge.prototype.addHttpHeader=function(e,t){this.httpHeaders||(this.httpHeaders={}),this.httpHeaders[e]=t},ge.prototype.getHttpHeaders=function(){return this.httpHeaders},ge.prototype.clearHttpHeaders=function(){this.httpHeaders={}},ge.prototype.addBodyAttribute=function(n,e,t,s){if(this.bodyAttributes||(this.bodyAttributes=[]),"object"==typeof n){var i="";Object.getOwnPropertyNames(n).forEach(function(e,t,s){i+=" "+e+'="'+n[e]+'"'}),n=i}" "!==n.substr(0,1)&&(n=" "+n),this.bodyAttributes.push(n)},ge.prototype.getBodyAttributes=function(){return this.bodyAttributes},ge.prototype.clearBodyAttributes=function(){this.bodyAttributes=null},ge.prototype.setEndpoint=function(e){this.endpoint=e,this._initializeServices(e)},ge.prototype.describe=function(){this.wsdl.definitions.types;return this.wsdl.describeServices()},ge.prototype.setSecurity=function(e){this.security=e},ge.prototype.setSOAPAction=function(e){this.SOAPAction=e},ge.prototype._initializeServices=function(e){var t=this.wsdl.definitions.services;for(var s in t)this[s]=this._defineService(t[s],e)},ge.prototype._initializeOptions=function(e){this.streamAllowed=e.stream,this.normalizeNames=e.normalizeNames,this.wsdl.options.attributesKey=e.attributesKey||"attributes",this.wsdl.options.envelopeKey=e.envelopeKey||"soap",this.wsdl.options.preserveWhitespace=!!e.preserveWhitespace,e.ignoredNamespaces!==undefined&&e.ignoredNamespaces.override!==undefined&&!0===e.ignoredNamespaces.override&&e.ignoredNamespaces.namespaces!==undefined&&(this.wsdl.options.ignoredNamespaces=e.ignoredNamespaces.namespaces),e.overrideRootElement!==undefined&&(this.wsdl.options.overrideRootElement=e.overrideRootElement),this.wsdl.options.forceSoap12Headers=!!e.forceSoap12Headers},ge.prototype._defineService=function(e,t){var s=e.ports,n={};for(var i in s)n[i]=this._definePort(s[i],t||s[i].location);return n},ge.prototype._definePort=function(e,t){var s=t,n=e.binding.methods,i={};for(var o in n){i[o]=this._defineMethod(n[o],s),this[this.normalizeNames?o.replace(ve,"_"):o]=i[o]}return i},ge.prototype._defineMethod=function(n,i){var o=this;return function(e,t,s){return o._invoke(n,e,i,t,s)}},ge.prototype._invoke=function(e,t,s,h,n){var a=this,p=e.$name,i=e.input,c=e.output,o=e.style,r=this.wsdl.definitions,u=this.wsdl.options.envelopeKey,l=r.$targetNamespace,d="",f="",m=null,y=null,v=_(r.xmlns,l),g={"Content-Type":"text/xml; charset=utf-8"},x="xmlns:"+u+'="http://schemas.xmlsoap.org/soap/envelope/"';for(var b in this.wsdl.options.forceSoap12Headers&&(g["Content-Type"]="application/soap+xml; charset=utf-8",x="xmlns:"+u+'="http://www.w3.org/2003/05/soap-envelope"'),y=this.SOAPAction?this.SOAPAction:e.soapAction!==undefined&&null!==e.soapAction?e.soapAction:(l.lastIndexOf("/")!==l.length-1?l+"/":l)+p,this.wsdl.options.forceSoap12Headers||(g.SOAPAction='"'+y+'"'),h=h||{},this.httpHeaders)g[b]=this.httpHeaders[b];for(var w in n)g[w]=n[w];a.security&&a.security.addHeaders&&a.security.addHeaders(g),a.security&&a.security.addOptions&&a.security.addOptions(h),"rpc"!==o||!i.parts&&"element"!==i.name&&null!==t?($.ok(!o||"document"===o,"invalid message definition for rpc style binding"),f=a.wsdl.objectToDocumentXML(i.$name,t,i.targetNSAlias,i.targetNamespace,i.$type||i.$lookupType)):($.ok(!o||"rpc"===o,"invalid message definition for document style binding"),f=a.wsdl.objectToRpcXML(p,t,v,l,"element"!==i.name),"encoded"===e.inputSoap&&(d='soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" ')),m='<?xml version="1.0" encoding="utf-8"?><'+u+":Envelope "+x+' xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+d+this.wsdl.xmlnsInEnvelope+">"+(a.soapHeaders||a.security?"<"+u+":Header>"+(a.soapHeaders?a.soapHeaders.join("\n"):"")+(a.security&&!a.security.postProcess?a.security.toXML():"")+"</"+u+":Header>":"")+"<"+u+":Body"+(a.bodyAttributes?a.bodyAttributes.join(" "):"")+(a.security&&a.security.postProcess?' Id="_0"':"")+">"+f+"</"+u+":Body></"+u+":Envelope>",a.security&&a.security.postProcess&&(m=a.security.postProcess(m,u)),h&&h.postProcess&&(m=h.postProcess(m)),a.lastMessage=f,a.lastRequest=m,a.lastEndpoint=s;var S=function(e){try{return JSON.parse(e)}catch(t){return undefined}};return C.from(me.fromFormFiles(h.attachments)).pipe(N.map(function(e){var t,s;if(!e.length)return m;if(h.forceMTOM||0<e.length){var n=T(),i=T(),o=null;if(-1<g["Content-Type"].indexOf("action"))try{for(var r=function u(e){var t="function"==typeof Symbol&&Symbol.iterator,s=t&&e[t],n=0;if(s)return s.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(g["Content-Type"].split("; ")),a=r.next();!a.done;a=r.next()){var p=a.value;-1<p.indexOf("action")&&(o=p)}}catch(l){t={error:l}}finally{try{a&&!a.done&&(s=r["return"])&&s.call(r)}finally{if(t)throw t.error}}g["Content-Type"]='multipart/related; type="application/xop+xml"; start="<'+n+'>"; start-info="text/xml"; boundary="'+i+'"',o&&(g["Content-Type"]=g["Content-Type"]+"; "+o);var c=[{"Content-Type":'application/xop+xml; charset=UTF-8; type="text/xml"',"Content-ID":"<"+n+">",body:m}];return e.forEach(function(e){c.push({"Content-Type":e.mimetype+";","Content-Transfer-Encoding":"binary","Content-ID":"<"+(e.contentId||e.name)+">","Content-Disposition":'attachment; name="'+e.name+'"; filename="'+e.name+'"',body:e.body})}),(new de).build(c,i)}}),N.flatMap(function(e){return a.httpClient.post(s,e,{headers:g,responseType:"text",observe:"response"}).pipe(N.map(function(e){return a.lastResponse=e.body,a.lastResponseHeaders=e&&e.headers,function r(e,t){var s;try{s=a.wsdl.xmlToObject(e)}catch(i){if(!c||!c.$lookupTypes){var n=O.isObject(e)?e:S(e);if(n)return{err:null,response:t,responseBody:n,header:undefined,xml:m}}throw i.response=t,i.body=e,i}return function o(t,e,s){var n=null;if(!c)return{err:null,response:null,responseBody:e,header:t.Header,xml:m};if(!t.html&&!t.Body)return{err:null,obj:t,responseBody:e,header:t.Header,xml:m};if("object"!=typeof t.Body){var i=new Error("Cannot parse response");return i.response=s,i.body=e,{err:i,obj:t,responseBody:e,header:undefined,xml:m}}(n=t.Body[c.$name])||(n=t.Body[c.$name.replace(/(?:Out(?:put)?|Response)$/,"")]);n||["Response","Out","Output"].forEach(function(e){if(t.Body.hasOwnProperty(p+e))return n=t.Body[p+e]});return{err:null,result:n,responseBody:e,header:t.Header,xml:m}}(s,e,t)}(e.body,e)}))}))},ge.prototype.call=function(e,t,s,n){return this[e]?this[e].call(this,t,s,n):C.throwError("Method "+e+" not found")};var xe=this,be={},we=function(t,s){return u(xe,void 0,void 0,function(){return l(this,function(e){return be[t]?[2,be[t]]:[2,re(t,s).then(function(e){return be[t]=e})]})})};function Se(s,i,o){return u(this,void 0,void 0,function(){var t;return l(this,function(e){switch(e.label){case 0:return void 0===i&&(i={}),o=i.endpoint||o,[4,function n(t,s){return u(this,void 0,void 0,function(){return l(this,function(e){return!0===s.disableCache?[2,re(t,s)]:[2,we(t,s)]})})}(s,i)];case 1:return t=e.sent(),[2,new ge(t,o,i)]}})})}var $e=(Te.prototype.createClient=function(e,t,s){return void 0===t&&(t={}),t.httpClient=this.http,Se(e,t,s)},Te.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],Te.ctorParameters=function(){return[{type:s.HttpClient}]},Te.ngInjectableDef=t.defineInjectable({factory:function(){return new Te(t.inject(s.HttpClient))},token:Te,providedIn:"root"}),Te);function Te(e){this.http=e}var Ce=(Ne.decorators=[{type:t.NgModule,args:[{imports:[s.HttpClientModule],exports:[]}]}],Ne);function Ne(){}e.security=he,e.NgxSoapService=$e,e.NgxSoapModule=Ce,e.ɵa=ae,e.ɵb=ue,e.ɵd=le,e.ɵc=ce,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-soap.umd.min.js.map